import{a as se,b as de,c as ue,d as pe}from"./chunk-FJLOXZSG.js";import{d as M,g as A}from"./chunk-6R7BUVFI.js";import{a as ie,b as ae}from"./chunk-D2RRFRAW.js";import{a as le}from"./chunk-W6ENELZB.js";import{a as ne,b as oe}from"./chunk-OXAP3N3H.js";import"./chunk-HMF6RJK6.js";import{n as re}from"./chunk-CWKDICKV.js";import{i as te}from"./chunk-NYQZODR7.js";import{b as R,c as a,e as $,f as L,g as w,i as l,k as B,l as H,m as K,n as U,o as J,q as C,r as Q,s as W,t as X,u as Y}from"./chunk-7W2NGOAN.js";import"./chunk-A3HZ2PBM.js";import"./chunk-2BOM3PMI.js";import"./chunk-RVXUJXBG.js";import{a as z}from"./chunk-Q2HHWBKA.js";import"./chunk-4Q3JVAKG.js";import{b as V}from"./chunk-MCE4IIOZ.js";import{Ea as Z,Fa as ee}from"./chunk-F2X7M4DW.js";import"./chunk-WCGJ44IN.js";import{B as O,o as G,p as q}from"./chunk-J6775IRK.js";import{$ as c,Gb as n,Hb as r,Ib as g,Mb as _,Rb as f,Sb as y,Ta as u,V as k,ac as d,bc as h,fa as v,ga as x,hb as T,nb as b,v as I,vb as D,wb as p}from"./chunk-VDH5VFWZ.js";import{a as S,b as F}from"./chunk-EQDQRRRY.js";var P=class s{url=`${z.apiUrl}/parametro`;http=c(V);findFirst(){return this.http.get(`${this.url}`)}create(t){return this.http.post(`${this.url}`,t)}update(t,e){return this.http.put(`${this.url}/${t}`,e)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=k({token:s,factory:s.\u0275fac,providedIn:"root"})};function ge(s,t){if(s&1){let e=_();n(0,"div",23)(1,"label",14),d(2," Aporte fondo de pensiones "),r(),n(3,"p-inputgroup")(4,"input",36),f("keydown",function(i){v(e);let m=y(2);return x(m.preventOverflow(i))}),r(),n(5,"p-inputgroup-addon"),d(6,"%"),r()()()}s&2&&(u(4),p("max",100)("min",.01))}function ve(s,t){if(s&1){let e=_();n(0,"div",23)(1,"label",14),d(2," Comisi\xF3n de flujo "),r(),n(3,"p-inputgroup")(4,"input",37),f("keydown",function(i){v(e);let m=y(2);return x(m.preventOverflow(i))}),r(),n(5,"p-inputgroup-addon"),d(6,"%"),r()()()}s&2&&(u(4),p("max",100)("min",.01))}function xe(s,t){if(s&1){let e=_();n(0,"p-fieldset",33)(1,"div",22),b(2,ge,7,2,"div",34),n(3,"div",23)(4,"label",14),d(5," Prima de seguro "),r(),n(6,"p-inputgroup")(7,"input",35),f("keydown",function(i){v(e);let m=y();return x(m.preventOverflow(i))}),r(),n(8,"p-inputgroup-addon"),d(9,"%"),r()()(),b(10,ve,7,2,"div",34),r()()}if(s&2){let e=t.$implicit,o=t.index;p("formGroupName",o)("legend",e==null||e.value==null?null:e.value.nombre),u(2),p("ngIf",!(!(e==null||e.value==null)&&e.value.esFijo)),u(5),p("max",100)("min",.01),u(3),p("ngIf",!(!(e==null||e.value==null)&&e.value.esFijo))}}function be(s,t){if(s&1){let e=_();n(0,"p-fieldset",33)(1,"div",22)(2,"div",23)(3,"p-inputgroup")(4,"input",38),f("keydown",function(i){v(e);let m=y();return x(m.preventOverflow(i))}),r(),n(5,"p-inputgroup-addon"),d(6),r()()()()()}if(s&2){let e=t.$implicit,o=t.index;p("formGroupName",o)("legend",e==null||e.value==null?null:e.value.nombre),u(4),p("max",100)("min",.01),u(2),h(e!=null&&e.value.esFijo?"S/":"%")}}var me=class s{title="Parametros de pago";icon="material-symbols:document-search-outline-rounded";msg=c(le);parametrosService=c(P);seguroSaludService=c(ie);fondoPensionesService=c(ae);porcentaje;formData=new w({parametro:new w({id:new l(void 0,{nonNullable:!0,validators:[a.required]}),ruc:new l(void 0,{nonNullable:!0,validators:[a.required]}),razonSocial:new l(void 0,{nonNullable:!0,validators:[a.required]}),rubro:new l(void 0,{nonNullable:!0,validators:[a.required]}),direccion:new l(void 0,{nonNullable:!0,validators:[a.required]}),porcentaje25:new l(void 0,{nonNullable:!0,validators:[a.required]}),porcentaje35:new l(void 0,{nonNullable:!0,validators:[a.required]})}),fondoPensiones:new C([]),seguroSalud:new C([])});get fondoPensiones(){return this.formData.get("fondoPensiones")}get seguroSalud(){return this.formData.get("seguroSalud")}ngOnInit(){this.precargar()}precargar(){this.cargarFondoPensiones(),this.cargarSeguroSalud(),this.cargarParametro()}cargarParametro(){this.parametrosService.findFirst().subscribe({next:t=>{t&&this.formData.get("parametro")?.patchValue({id:t.id,ruc:t.ruc,razonSocial:t.razonSocial,rubro:t.rubro,direccion:t.direccion,porcentaje25:(t.porcentaje25*100).toFixed(2),porcentaje35:(t.porcentaje35*100).toFixed(2)})}})}cargarFondoPensiones(){this.fondoPensionesService.findAll().subscribe({next:t=>{this.fondoPensiones.clear(),t.forEach(e=>{let o=new w({id:new l(e.id,{nonNullable:!0,validators:[a.required]}),orden:new l(e.orden,{nonNullable:!0,validators:[a.required]}),nombre:new l(e.nombre,{nonNullable:!0,validators:[a.required]}),esFijo:new l(e.esFijo,{nonNullable:!0,validators:[a.required]}),pension:new l(e.esFijo?"0":(e.pension*100).toFixed(2),{nonNullable:!0,validators:e.esFijo?[]:[a.required]}),seguro:new l((e.seguro*100).toFixed(2),{nonNullable:!0,validators:[a.required]}),comision:new l(e.esFijo?"0":(e.comision*100).toFixed(2),{nonNullable:!0,validators:e.esFijo?[]:[a.required]})});this.fondoPensiones.push(o)})}})}cargarSeguroSalud(){this.seguroSaludService.findAll().subscribe({next:t=>{this.seguroSalud.clear(),t.forEach(e=>{let o=new w({id:new l(e.id,{nonNullable:!0,validators:[a.required]}),orden:new l(e.orden,{nonNullable:!0,validators:[a.required]}),nombre:new l(e.nombre,{nonNullable:!0,validators:[a.required]}),esFijo:new l(e.esFijo,{nonNullable:!0,validators:[a.required]}),valor:new l(e.esFijo?e.valor.toFixed(2):(e.valor*100).toFixed(2),{nonNullable:!0,validators:[a.required]})});this.seguroSalud.push(o)})}})}preventOverflow(t){let e=["Backspace","Tab","ArrowLeft","ArrowRight","Delete","Home","End"],o=t.target,i=t.key;if(e.includes(i))return;if(i==="."&&o.value.includes(".")){t.preventDefault();return}if(!/[\d.]/.test(i)){t.preventDefault();return}let m=o.selectionStart??0,fe=o.selectionEnd??0,j=o.value.slice(0,m)+i+o.value.slice(fe),N=parseFloat(j);if(isNaN(N)||N>100||N<.01){t.preventDefault();return}let E=j.split(".");if(E.length===2&&E[1].length>2){t.preventDefault();return}}guardar(){let t=this.formData.get("parametro")?.value,e=this.formData.get("fondoPensiones")?.value??[],o=this.formData.get("seguroSalud")?.value??[];I([this.parametrosService.update(t?.id,F(S({},t),{porcentaje25:parseFloat(t?.porcentaje25)/100,porcentaje35:parseFloat(t?.porcentaje35)/100})),this.fondoPensionesService.updateMany(e.map(i=>F(S({},i),{pension:i.esFijo?0:parseFloat(i.pension)/100,seguro:parseFloat(i.seguro)/100,comision:i.esFijo?0:parseFloat(i.comision)/100}))),this.seguroSaludService.updateMany(o.map(i=>F(S({},i),{valor:i.esFijo?parseFloat(i.valor):parseFloat(i.valor)/100})))]).subscribe({next:i=>{this.msg.success("Los datos se guardaron correctamente en la base de datos."),this.precargar()}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=T({type:s,selectors:[["app-parametros"]],decls:56,vars:12,consts:[[1,"flex","flex-col","h-full"],[1,"flex","flex-col","justify-center","gap-4","px-6","py-4","h-[4.875rem]"],[1,"flex","justify-between","items-center","gap-4"],[1,"flex","items-center","gap-4"],["data-inline","false",1,"iconify","icon","font-bold","text-4xl"],[1,"text-2xl","font-semibold"],["severity","danger","size","small",3,"routerLink"],[1,"flex","justify-center","items-center","font-medium","gap-1"],["data-icon","uil:left-arrow-from-left","data-inline","false",1,"iconify","icon","text-lg"],[1,"flex","flex-col","h-[calc(100%","-","4.875rem)]","px-12","py-4","overflow-y-auto"],[1,"grid","grid-cols-4","gap-x-6","gap-y-2",3,"formGroup"],["legend","Informaci\xF3n de la empresa","formGroupName","parametro",1,"col-span-3"],[1,"grid","grid-cols-6","gap-x-6","gap-y-2"],[1,"col-span-2","flex","flex-col","gap-2"],[1,"text-sm","font-medium"],["pInputText","","formControlName","ruc"],[1,"col-span-4","flex","flex-col","gap-2"],["pInputText","","formControlName","razonSocial"],[1,"col-span-3","flex","flex-col","gap-2"],["pInputText","","formControlName","rubro"],["pInputText","","formControlName","direccion"],["legend","Pago por horas extra","formGroupName","parametro"],[1,"grid","grid-cols-1","gap-2"],[1,"flex","flex-col","gap-2"],["pInputText","","formControlName","porcentaje25",3,"keydown","max","min"],["pInputText","","formControlName","porcentaje35",3,"keydown","max","min"],["legend","Fondo de pensiones",1,"col-span-4"],["formArrayName","fondoPensiones",1,"grid","grid-cols-5","gap-x-6","gap-y-2"],[3,"formGroupName","legend",4,"ngFor","ngForOf"],["legend","Seguro de salud",1,"col-span-4"],["formArrayName","seguroSalud",1,"grid","grid-cols-5","gap-x-6","gap-y-2"],[1,"col-span-4","flex","justify-end","mt-2"],["severity","info","size","small",3,"onClick","label","disabled"],[3,"formGroupName","legend"],["class","flex flex-col gap-2",4,"ngIf"],["pInputText","","formControlName","seguro",3,"keydown","max","min"],["pInputText","","formControlName","pension",3,"keydown","max","min"],["pInputText","","formControlName","comision",3,"keydown","max","min"],["pInputText","","formControlName","valor",3,"keydown","max","min"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),g(4,"i",4),n(5,"h2",5),d(6),r()(),n(7,"p-button",6)(8,"div",7),g(9,"i",8),n(10,"span"),d(11,"Configuraci\xF3n"),r()()()()(),n(12,"div",9)(13,"form",10)(14,"p-fieldset",11)(15,"div",12)(16,"div",13)(17,"label",14),d(18,"RUC"),r(),g(19,"input",15),r(),n(20,"div",16)(21,"label",14),d(22," Raz\xF3n social "),r(),g(23,"input",17),r(),n(24,"div",18)(25,"label",14),d(26," Rubro de la Empresa "),r(),g(27,"input",19),r(),n(28,"div",18)(29,"label",14),d(30," Direcci\xF3n "),r(),g(31,"input",20),r()()(),n(32,"p-fieldset",21)(33,"div",22)(34,"div",23)(35,"label",14),d(36," Porcentaje por 1 - 2 horas extra "),r(),n(37,"p-inputgroup")(38,"input",24),f("keydown",function(m){return o.preventOverflow(m)}),r(),n(39,"p-inputgroup-addon"),d(40,"%"),r()()(),n(41,"div",23)(42,"label",14),d(43," Porcentaje por 3 a m\xE1s horas extra "),r(),n(44,"p-inputgroup")(45,"input",25),f("keydown",function(m){return o.preventOverflow(m)}),r(),n(46,"p-inputgroup-addon"),d(47,"%"),r()()()()(),n(48,"p-fieldset",26)(49,"div",27),b(50,xe,11,6,"p-fieldset",28),r()(),n(51,"p-fieldset",29)(52,"div",30),b(53,be,7,5,"p-fieldset",28),r()(),n(54,"div",31)(55,"p-button",32),f("onClick",function(){return o.guardar()}),r()()()()()),e&2&&(u(4),D("data-icon",o.icon),u(2),h(o.title),u(),p("routerLink","/ajustes/configuracion"),u(6),p("formGroup",o.formData),u(25),p("max",100)("min",.01),u(7),p("max",100)("min",.01),u(5),p("ngForOf",o.fondoPensiones.controls),u(3),p("ngForOf",o.seguroSalud.controls),u(2),p("label","Guardar cambios")("disabled",o.formData.invalid))},dependencies:[O,G,q,A,M,Q,B,R,$,L,W,H,J,K,U,ee,Z,oe,ne,re,Y,X,te,de,se,pe,ue],encapsulation:2})};export{me as ParametrosComponent};
