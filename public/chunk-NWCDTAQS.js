import{b as Qe,d as Xe}from"./chunk-FJLOXZSG.js";import{a as Pe,b as De}from"./chunk-3AAQYD37.js";import{a as be}from"./chunk-L4TL7TWU.js";import{d as Oe,g as pe}from"./chunk-6R7BUVFI.js";import{a as xe,b as he}from"./chunk-3UQBCJYR.js";import{a as Se,b as Ce}from"./chunk-HSUUTGKP.js";import{a as K}from"./chunk-W6ENELZB.js";import"./chunk-HMF6RJK6.js";import{a as ye,b as we}from"./chunk-RVQOAWJC.js";import{a as Je}from"./chunk-TVRGOZ6Z.js";import{a as qe,b as Ke}from"./chunk-KOIAJ6TH.js";import"./chunk-G453X5NG.js";import{l as W,m as Le,n as L}from"./chunk-CWKDICKV.js";import{c as Be,d as ze,h as He,i as We}from"./chunk-NYQZODR7.js";import{c as q,d as E}from"./chunk-BBS5CLCL.js";import{b as de,c as M,e as G,f as j,g as B,i as h,j as Ne,k as ce,l as ue,m as Ve,o as fe,r as U,s as ge,t as z,u as H}from"./chunk-7W2NGOAN.js";import"./chunk-FNTIPBS5.js";import"./chunk-A3HZ2PBM.js";import"./chunk-2BOM3PMI.js";import{b as Ge,d as je,f as ve,g as _e}from"./chunk-RVXUJXBG.js";import{a as w}from"./chunk-Q2HHWBKA.js";import"./chunk-4Q3JVAKG.js";import{b as y}from"./chunk-MCE4IIOZ.js";import{Ea as k,Fa as A}from"./chunk-F2X7M4DW.js";import"./chunk-WCGJ44IN.js";import{B as I,m as le,o as se,p as me}from"./chunk-J6775IRK.js";import{$ as d,$b as X,Cb as ie,Eb as oe,Fb as re,Gb as o,Hb as r,Ib as c,Jb as ne,Kb as ae,Mb as C,Rb as g,Sb as v,Ta as l,V as S,ac as s,bc as _,cc as O,ec as N,fa as u,fc as V,ga as f,gc as P,hb as F,hc as $e,ic as T,jc as D,nb as b,r as Ue,vb as R,wb as p,wc as x}from"./chunk-VDH5VFWZ.js";import{a as Z,b as ee,c as te}from"./chunk-EQDQRRRY.js";var J=class i{url=`${w.apiUrl}/usuarios`;http=d(y);findAll(){return this.http.get(this.url)}findOne(e){return this.http.get(`${this.url}/${e}`)}create(e){return this.http.post(`${this.url}`,e)}update(e,t){return this.http.put(`${this.url}/${e}`,t)}changeStatus(e,t){return this.http.get(`${this.url}/changeStatus/${e}/${t}`)}delete(e){return this.http.delete(`${this.url}/${e}`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})};var Me=class i{url=`${w.apiUrl}/asignacionSedeUsuario`;http=d(y);findAll(){return this.http.get(this.url)}findOne(e){return this.http.get(`${this.url}/${e}`)}findAllByUsuario(e){return this.http.get(`${this.url}/ByUsuario/${e}`)}create(e){return this.http.post(`${this.url}`,e)}multipleCreate(e){return this.http.post(`${this.url}/multiple`,e)}update(e,t){return this.http.put(`${this.url}/${e}`,t)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})};var Y=class i{ref=d(q);dialogService=d(E);rolService=d(be);usuarioService=d(J);asignacionSedeUsuarioService=d(Me);sedeService=d(Je);formData=new B({usuario:new B({nombre:new h(void 0,{nonNullable:!0,validators:[M.required]}),apellido:new h(void 0,{nonNullable:!0,validators:[M.required]}),username:new h(void 0,{nonNullable:!0,validators:[M.required]}),password:new h(void 0,{nonNullable:!0,validators:[]}),idRol:new h(void 0,{nonNullable:!0,validators:[M.required]}),isActive:new h(!0,{nonNullable:!0,validators:[M.required]})}),sedes:new B({idSedes:new h([],{nonNullable:!0,validators:[]})})});id;listaSedes=[];asignacionSedes=[];listaRoles=[];ngOnInit(){let e=this.dialogService.getInstance(this.ref);this.cargarSedes(),this.cargarRoles(),e.data&&(this.id=e.data.id,this.precargar())}cargarRoles(){this.rolService.findAll().subscribe(e=>{this.listaRoles=e})}cargarSedes(){this.sedeService.findAll(!1).subscribe(e=>{this.listaSedes=e})}get isActive(){return this.formData.get("usuario.isActive")?.value??!1}precargar(){this.id&&this.usuarioService.findOne(this.id).subscribe({next:e=>{this.formData.get("usuario.nombre")?.setValue(e.nombre),this.formData.get("usuario.apellido")?.setValue(e.apellido),this.formData.get("usuario.username")?.setValue(e.username),this.formData.get("usuario.idRol")?.setValue(e.idRol),this.formData.get("usuario.isActive")?.setValue(e.isActive),this.formData.get("sedes.idSedes")?.setValue(e.asignacionSedes.map(t=>t.idSede)),this.asignacionSedes=e.asignacionSedes}})}guardar(){let e=this.formData.get("usuario")?.value,t=this.formData.get("sedes.idSedes")?.value??[];this.id?this.usuarioService.update(this.id,ee(Z({},e),{id:this.id})).pipe(Ue(n=>this.asignacionSedeUsuarioService.multipleCreate(t.map(a=>({id:this.asignacionSedes.find(Q=>Q.idSede===a)?.id,idSede:a,idUsuario:this.id}))))).subscribe({next:n=>{this.ref.close(n)}}):this.usuarioService.create(e).pipe(Ue(n=>this.asignacionSedeUsuarioService.multipleCreate(t.map(a=>({id:this.asignacionSedes.find(Q=>Q.idSede===a)?.id,idSede:a,idUsuario:n.id}))))).subscribe({next:n=>{this.ref.close(n)}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=F({type:i,selectors:[["app-form-usuario"]],decls:46,vars:9,consts:[[1,"grid","grid-cols-1","gap-6",3,"formGroup"],[1,"grid","grid-cols-1","gap-2"],["formGroupName","usuario",1,"grid","grid-cols-1","gap-2"],[1,"flex","flex-col","gap-2"],["for","nombreUsuario",1,"text-sm","font-medium"],[1,"text-xs"],["id","nombreCargo","pInputText","","formControlName","nombre"],["for","apellidoUsuario",1,"text-sm","font-medium"],["id","apellidoUsuario","pInputText","","formControlName","apellido"],["for","usernameUsuario",1,"text-sm","font-medium"],["id","usernameUsuario","pInputText","","formControlName","username"],["styleClass","w-full","inputStyleClass","w-full","formControlName","password",1,"w-full",3,"toggleMask","feedback"],["for","idRolUsuario",1,"text-sm","font-medium"],["optionLabel","nombre","optionValue","id","formControlName","idRol","placeholder","Seleccione...","appendTo","body",3,"options"],["formGroupName","sedes"],["optionLabel","nombre","optionValue","id","placeholder","Edificios","pTooltip","Edificios","tooltipPosition","top","tooltipStyleClass","text-sm","formControlName","idSedes","appendTo","body",3,"options","maxSelectedLabels"],["formGroupName","usuario",1,"flex","justify-between","gap-4"],[1,"flex","items-center","gap-2","py-1"],["formControlName","isActive"],["for","nombreCargo",1,"text-sm","font-medium","pb-1.5"],["severity","info","size","small",3,"onClick","label","disabled"]],template:function(t,n){t&1&&(o(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),s(5," Nombre "),o(6,"span",5),s(7,"*"),r()(),c(8,"input",6),r(),o(9,"div",3)(10,"label",7),s(11," Apellidos "),o(12,"span",5),s(13,"*"),r()(),c(14,"input",8),r(),o(15,"div",3)(16,"label",9),s(17," Usuario "),o(18,"span",5),s(19,"*"),r()(),c(20,"input",10),r(),o(21,"div",3)(22,"label",9),s(23," Contrase\xF1a "),o(24,"span",5),s(25,"*"),r()(),c(26,"p-password",11),r(),o(27,"div",3)(28,"label",12),s(29," Rol "),o(30,"span",5),s(31,"*"),r()(),c(32,"p-select",13),r()(),o(33,"div",14)(34,"div",3)(35,"label",9),s(36," Edificios "),o(37,"span",5),s(38,"*"),r()(),c(39,"p-multiselect",15),r()()(),o(40,"div",16)(41,"div",17),c(42,"p-toggleswitch",18),o(43,"label",19),s(44),r()(),o(45,"p-button",20),g("onClick",function(){return n.guardar()}),r()()()),t&2&&(p("formGroup",n.formData),l(26),p("toggleMask",!0)("feedback",!1),l(6),p("options",n.listaRoles),l(7),p("options",n.listaSedes)("maxSelectedLabels",2),l(5),_(n.isActive?"Activo":"Inactivo"),l(),p("label",n.id?"Actualizar":"Guardar")("disabled",n.formData.invalid))},dependencies:[I,ge,ce,de,G,j,ue,fe,Ve,U,H,z,De,Pe,Qe,Xe,A,k,he,xe,We,He,Ke,qe],encapsulation:2})};var Ee=class i{url=`${w.apiUrl}/grupoModulos`;http=d(y);findAll(e=!0){return this.http.get(`${this.url}?filter=${e}`)}findAllPermisos(){return this.http.get(`${this.url}/permisos`)}findOne(e){return this.http.get(`${this.url}/${e}`)}create(e){return this.http.post(`${this.url}`,e)}update(e,t){return this.http.put(`${this.url}/${e}`,t)}changeStatus(e,t){return this.http.get(`${this.url}/changeStatus/${e}/${t}`)}delete(e){return this.http.delete(`${this.url}/${e}`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})};var Fe=class i{url=`${w.apiUrl}/modulos`;http=d(y);findAll(e=!0){return this.http.get(`${this.url}?filter=${e}`)}findAllByRol(e){return this.http.get(`${this.url}/byRol/${e}`)}findOne(e){return this.http.get(`${this.url}/${e}`)}create(e){return this.http.post(`${this.url}`,e)}update(e,t){return this.http.put(`${this.url}/${e}`,t)}changeStatus(e,t){return this.http.get(`${this.url}/changeStatus/${e}/${t}`)}delete(e){return this.http.delete(`${this.url}/${e}`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})};var Re=class i{url=`${w.apiUrl}/permisoRoles`;http=d(y);findAll(){return this.http.get(this.url)}findOne(e){return this.http.get(`${this.url}/${e}`)}create(e){return this.http.post(`${this.url}`,e)}multipleCreate(e){return this.http.post(`${this.url}/multiple`,e)}update(e,t){return this.http.put(`${this.url}/${e}`,t)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})};var rt=()=>({"min-width":"60rem"});function nt(i,e){i&1&&(o(0,"tr")(1,"th")(2,"div",7),s(3,"M\xF3dulo"),r()(),o(4,"th",8)(5,"div",7),s(6,"Todos"),r()(),o(7,"th",8)(8,"div",7),s(9,"Leer"),r()(),o(10,"th",8)(11,"div",7),s(12,"Crear"),r()(),o(13,"th",8)(14,"div",7),s(15,"Editar"),r()(),o(16,"th",8)(17,"div",7),s(18,"Eliminar"),r()()())}function at(i,e){if(i&1&&(o(0,"tr",9)(1,"td",10)(2,"div",11)(3,"span",12),s(4),r()()()()),i&2){let t=e.$implicit;l(4),_(t.grupoModulo.nombre)}}function lt(i,e){if(i&1){let t=C();o(0,"tr")(1,"td")(2,"span",13),s(3),r()(),o(4,"td")(5,"div",14)(6,"p-checkbox",15),P("ngModelChange",function(a){let m=u(t).$implicit;return V(m.permisos.todos,a)||(m.permisos.todos=a),f(a)}),g("ngModelChange",function(){let a=u(t).$implicit,m=v();return f(m.selectAll(a.permisos))}),r()()(),o(7,"td")(8,"div",14)(9,"p-checkbox",15),P("ngModelChange",function(a){let m=u(t).$implicit;return V(m.permisos.leer,a)||(m.permisos.leer=a),f(a)}),r()()(),o(10,"td")(11,"div",14)(12,"p-checkbox",15),P("ngModelChange",function(a){let m=u(t).$implicit;return V(m.permisos.crear,a)||(m.permisos.crear=a),f(a)}),r()()(),o(13,"td")(14,"div",14)(15,"p-checkbox",15),P("ngModelChange",function(a){let m=u(t).$implicit;return V(m.permisos.editar,a)||(m.permisos.editar=a),f(a)}),r()()(),o(16,"td")(17,"div",14)(18,"p-checkbox",15),P("ngModelChange",function(a){let m=u(t).$implicit;return V(m.permisos.eliminar,a)||(m.permisos.eliminar=a),f(a)}),r()()()()}if(i&2){let t=e.$implicit;l(3),_(t.nombre),l(3),N("ngModel",t.permisos.todos),p("binary",!0),l(3),N("ngModel",t.permisos.leer),p("binary",!0),l(3),N("ngModel",t.permisos.crear),p("binary",!0),l(3),N("ngModel",t.permisos.editar),p("binary",!0),l(3),N("ngModel",t.permisos.eliminar),p("binary",!0)}}var Te=class i{ref=d(q);dialogService=d(E);msg=d(K);moduloService=d(Fe);permisoRolService=d(Re);listaModulos=[];id;ngOnInit(){let t=this.dialogService.getInstance(this.ref).data;t&&(this.id=t.id),this.cargarGrupoModulo(this.id)}cargarGrupoModulo(e){this.moduloService.findAllByRol(e).subscribe({next:t=>{this.listaModulos=t.map(n=>(n.permisos.todos=this.evaluarTodos(n.permisos),n)),console.log("listaModulos",this.listaModulos)}})}evaluarTodos(e){return e.crear&&e.editar&&e.leer&&e.eliminar}selectAll(e){e.crear=e.todos,e.editar=e.todos,e.leer=e.todos,e.eliminar=e.todos}guardar(){let e=this.listaModulos.flatMap(t=>{let m=t.permisos,{todos:n}=m;return te(m,["todos"])});this.permisoRolService.multipleCreate(e).subscribe({next:t=>{this.msg.success("\xA1Registrado con \xE9xito!"),this.ref.close(t)}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=F({type:i,selectors:[["app-form-permisos"]],decls:10,vars:5,consts:[["header",""],["groupheader",""],["body",""],[1,"flex","flex-col","gap-6"],["sortField","grupoModulo.nombre","sortMode","single","scrollHeight","400px","rowGroupMode","subheader","groupRowsBy","grupoModulo.nombre",3,"value","scrollable","tableStyle"],["formGroupName","usuario",1,"flex","justify-end","gap-4"],["severity","info","size","small",3,"onClick","label"],[1,"text-center","text-xs","uppercase"],[1,"w-28"],["pRowGroupHeader",""],["colspan","5"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-bold","uppercase"],[1,"text-sm"],[1,"flex","justify-center","items-center","gap-2"],[3,"ngModelChange","ngModel","binary"]],template:function(t,n){if(t&1){let a=C();o(0,"div",3)(1,"p-table",4),b(2,nt,19,0,"ng-template",null,0,x)(4,at,5,1,"ng-template",null,1,x)(6,lt,19,11,"ng-template",null,2,x),r(),o(8,"div",5)(9,"p-button",6),g("onClick",function(){return u(a),f(n.guardar())}),r()()()}t&2&&(l(),p("value",n.listaModulos)("scrollable",!0)("tableStyle",T(4,rt)),l(8),p("label","Guardar"))},dependencies:[I,U,G,j,Ne,L,W,Le,ze,Be,A,k],encapsulation:2})};var ct=()=>["nombre"],ut=i=>[i],ft=i=>["text-xs uppercase",i],gt=()=>[];function vt(i,e){if(i&1){let t=C();o(0,"div",6)(1,"div",7)(2,"p-button",8),g("click",function(){u(t);let a=v();return f(a.cancelar())}),o(3,"div",9),c(4,"i",10),o(5,"span"),s(6,"Volver"),r()()()(),o(7,"form",11)(8,"div",12)(9,"div",13)(10,"label",14),s(11," Nombre "),o(12,"span",15),s(13,"*"),r()(),c(14,"input",16),r(),o(15,"div",17)(16,"label",14),s(17," C\xF3digo "),o(18,"span",15),s(19,"*"),r()(),c(20,"input",18),r()(),o(21,"div",19)(22,"div",20),c(23,"p-toggleswitch",21),o(24,"label",22),s(25),r()(),o(26,"p-button",23),g("onClick",function(){u(t);let a=v();return f(a.guardar())}),r()()()()}if(i&2){let t=v();l(7),p("formGroup",t.formData),l(18),_(t.isActive?"Activo":"Inactivo"),l(),p("label",t.id?"Actualizar":"Guardar")("disabled",t.formData.invalid)}}function _t(i,e){if(i&1&&(o(0,"th",28)(1,"div",28),s(2),r()()),i&2){let t=e.$implicit;p("ngClass",D(3,ut,t.widthClass?t.widthClass:"")),l(),p("ngClass",D(5,ft,t.align?"text-"+t.align:"text-start")),l(),O(" ",t.header," ")}}function bt(i,e){if(i&1&&(o(0,"tr"),b(1,_t,3,7,"th",27),r()),i&2){let t=e.$implicit;l(),p("ngForOf",t)}}function xt(i,e){if(i&1){let t=C();o(0,"tr")(1,"td")(2,"div",29),s(3),r()(),o(4,"td")(5,"div",30),s(6),r()(),o(7,"td")(8,"div",31),s(9),r()(),o(10,"td")(11,"div",32)(12,"p-tag",33),g("click",function(){let a=u(t).$implicit,m=v(2);return f(m.changeStatus(a))}),r()()(),o(13,"td")(14,"div",34)(15,"p-button",35),g("click",function(){let a=u(t).$implicit,m=v(2);return f(m.permisos(a.id))}),c(16,"i",36),r(),o(17,"p-button",37),g("click",function(){let a=u(t).$implicit,m=v(2);return f(m.editar(a))}),c(18,"i",36),r(),o(19,"p-button",38),g("click",function(){let a=u(t).$implicit,m=v(2);return f(m.eliminar(a))}),c(20,"i",36),r()()()()}if(i&2){let t=e.$implicit;l(3),_(t.orden),l(3),_(t.nombre),l(3),_(t.codigo),l(3),p("value",t.isActive?"Activo":"Inactivo")("severity",t.isActive?"success":"warn"),l(4),R("data-icon","material-symbols:grid-view-outline-rounded"),l(2),R("data-icon","solar:pen-new-square-linear"),l(2),R("data-icon","solar:trash-bin-trash-broken")}}function ht(i,e){i&1&&(o(0,"td"),c(1,"p-skeleton"),r())}function St(i,e){if(i&1&&(o(0,"tr",40),b(1,ht,2,0,"td",41),r()),i&2){let t=v(4);l(),p("ngForOf",t.cols)}}function Ct(i,e){i&1&&(ne(0),oe(1,St,2,1,"tr",40,ie),ae()),i&2&&(l(),re(T(0,gt).constructor(4)))}function yt(i,e){i&1&&(o(0,"tr")(1,"td",42)(2,"div",43),s(3," No se encontraron registros. "),r()()())}function wt(i,e){if(i&1&&b(0,Ct,3,1,"ng-container",39)(1,yt,4,0,"ng-template",null,4,x),i&2){let t=X(2),n=v(2);p("ngIf",n.loadingTable)("ngIfElse",t)}}function Mt(i,e){if(i&1){let t=C();o(0,"div",6)(1,"div",24)(2,"p-button",8),g("click",function(){u(t);let a=v();return f(a.addNew())}),o(3,"div",9),c(4,"i",25),o(5,"span"),s(6,"Agregar"),r()()()(),o(7,"p-table",26,0),b(9,bt,2,1,"ng-template",null,1,x)(11,xt,21,8,"ng-template",null,2,x)(13,wt,3,2,"ng-template",null,3,x),r()()}if(i&2){let t=v();l(7),p("value",t.listaRoles)("columns",t.cols)("exportHeader","customExportHeader")("scrollable",!0)("globalFilterFields",T(5,ct))}}var Ie=class i{ref=d(q);dialogService=d(E);msg=d(K);rolService=d(be);grupoModuloService=d(Ee);cols;loadingTable=!1;exportColumns;listaRoles=[];tipo="table";formData=new B({nombre:new h(void 0,{nonNullable:!0,validators:[M.required]}),codigo:new h(void 0,{nonNullable:!0,validators:[M.required]}),isActive:new h(!0,{nonNullable:!0,validators:[M.required]})});get isActive(){return this.formData.controls.isActive.value}id;ngOnInit(){this.cols=[{field:"id",header:"N\xB0",align:"center",widthClass:"!w-16"},{field:"nombre",header:"Nombre"},{field:"codigo",header:"Codigo"},{field:"isActive",header:"Estado",align:"center",widthClass:"!w-28"},{field:"",header:"Acciones",align:"center",widthClass:"!w-36"}],this.cargarRoles()}cargarRoles(){this.rolService.findAll().subscribe(e=>{this.listaRoles=e})}cargarPermisoModulos(){this.grupoModuloService.findAllPermisos().subscribe({next:e=>{console.log("data",e)}})}cancelar(){this.reset()}reset(){this.tipo="table",this.id=void 0,this.formData.patchValue({nombre:void 0,codigo:void 0,isActive:!0})}addNew(){this.tipo="form"}editar(e){this.tipo="form",this.id=e.id,this.formData.patchValue({nombre:e.nombre,codigo:e.codigo,isActive:e.isActive})}permisos(e){this.dialogService.open(Te,{header:"Asignar permisos",styleClass:"modal-6xl",modal:!0,data:{id:e},dismissableMask:!0,closable:!0}).onClose.subscribe(n=>{n&&this.cargarRoles()})}changeStatus(e){this.msg.confirm(`\xBFEst\xE1 seguro de ${e.isActive?"desactivar":"activar"} el usuario ${e.nombre}?`,()=>{this.rolService.changeStatus(e.id,!e.isActive).subscribe({next:t=>{this.cargarRoles()}})})}eliminar(e){this.msg.confirm(`\xBFEst\xE1 seguro de eliminar el edificio ${e.nombre}? Esta acci\xF3n no se puede deshacer.`,()=>{this.rolService.delete(e.id).subscribe({next:t=>{this.cargarRoles()}})})}guardar(){let e=te(this.formData.value,[]);this.id?this.rolService.update(this.id,ee(Z({},e),{id:this.id})).subscribe({next:t=>{this.cargarRoles(),this.reset()}}):this.rolService.create(e).subscribe({next:t=>{this.cargarRoles(),this.reset()}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=F({type:i,selectors:[["app-form-permrolesisos"]],decls:2,vars:2,consts:[["dt",""],["header",""],["body",""],["emptymessage",""],["elseTemplate",""],["class","flex flex-col gap-4",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"flex","justify-start"],["severity","info","size","small",3,"click"],[1,"flex","justify-center","items-center","font-medium","gap-1"],["data-icon","material-symbols:chevron-left-rounded","data-inline","false",1,"iconify","icon","text-lg"],[1,"grid","grid-cols-1","gap-6",3,"formGroup"],[1,"grid","grid-cols-3","gap-4"],[1,"col-span-2","flex","flex-col","gap-2"],["for","nombreCargo",1,"text-sm","font-medium"],[1,"text-xs"],["id","nombreCargo","pInputText","","formControlName","nombre"],[1,"flex","flex-col","gap-2"],["id","nombreCargo","pInputText","","formControlName","codigo"],[1,"flex","justify-between","gap-4"],[1,"flex","items-center","gap-2","py-1"],["formControlName","isActive"],["for","nombreCargo",1,"text-sm","font-medium","pb-1.5"],["severity","info","size","small",3,"onClick","label","disabled"],[1,"flex","justify-end"],["data-icon","uil:plus","data-inline","false",1,"iconify","icon","text-lg"],["dataKey","id","stripedRows","","scrollHeight","720px","styleClass","w-full","exportFilename","cargos",3,"value","columns","exportHeader","scrollable","globalFilterFields"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"text-center","text-sm"],[1,"text-start","text-sm","capitalize"],[1,"text-center","text-sm","lowercase"],[1,"flex","justify-center","items-center","text-sm","capitalize"],["styleClass","uppercase !font-bold !text-xs cursor-pointer","pTooltip","Cambiar estado","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0","rounded","",3,"click","value","severity"],[1,"flex","justify-center","items-center","gap-1"],["text","","severity","info","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Permisos","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],["data-inline","false",1,"iconify","icon","font-bold","text-xl"],["text","","severity","success","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Editar","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],["text","","severity","danger","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Eliminar","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],[4,"ngIf","ngIfElse"],[1,"h-12"],[4,"ngFor","ngForOf"],["colspan","100"],[1,"text-center","text-sm","font-extralight"]],template:function(t,n){t&1&&b(0,vt,27,4,"div",5)(1,Mt,15,6,"div",5),t&2&&(p("ngIf",n.tipo=="form"),l(),p("ngIf",n.tipo=="table"))},dependencies:[I,le,se,me,pe,U,ce,de,G,j,ge,ue,fe,A,k,L,W,H,z,he,xe,we,ye,Ce,Se,_e,ve],encapsulation:2})};var Et=()=>["nombre"],Ft=i=>[i],Rt=i=>["text-xs uppercase",i],Tt=()=>[];function It(i,e){if(i&1&&(o(0,"th",24)(1,"div",24),s(2),r()()),i&2){let t=e.$implicit;p("ngClass",D(3,Ft,t.widthClass?t.widthClass:"")),l(),p("ngClass",D(5,Rt,t.align?"text-"+t.align:"text-start")),l(),O(" ",t.header," ")}}function Ut(i,e){if(i&1&&(o(0,"tr"),b(1,It,3,7,"th",23),r()),i&2){let t=e.$implicit;l(),p("ngForOf",t)}}function kt(i,e){if(i&1&&(o(0,"li"),s(1),r()),i&2){let t=e.$implicit;l(),O(" ",t.sede==null?null:t.sede.nombre," ")}}function At(i,e){if(i&1){let t=C();o(0,"tr")(1,"td")(2,"div",25),s(3),r()(),o(4,"td")(5,"div",26),s(6),r()(),o(7,"td")(8,"div",26),s(9),r()(),o(10,"td")(11,"div",27),s(12),r()(),o(13,"td")(14,"div",28),s(15),r()(),o(16,"td")(17,"div",29)(18,"ul",30),b(19,kt,2,1,"li",31),r()()(),o(20,"td")(21,"div",32)(22,"p-tag",33),g("click",function(){let a=u(t).$implicit,m=v();return f(m.changeStatus(a))}),r()()(),o(23,"td")(24,"div",34)(25,"p-button",35),g("click",function(){let a=u(t).$implicit,m=v();return f(m.editar(a.id))}),c(26,"i",36),r(),o(27,"p-button",37),g("click",function(){let a=u(t).$implicit,m=v();return f(m.eliminar(a))}),c(28,"i",36),r()()()()}if(i&2){let t=e.$implicit;l(3),_(t.orden),l(3),_(t.nombre),l(3),_(t.apellido),l(3),_(t.username),l(3),O(" ",t.rol.nombre," "),l(4),p("ngForOf",t.asignacionSedes),l(3),p("value",t.isActive?"Activo":"Inactivo")("severity",t.isActive?"success":"warn"),l(4),R("data-icon","solar:pen-new-square-linear"),l(2),R("data-icon","solar:trash-bin-trash-broken")}}function $t(i,e){i&1&&(o(0,"td"),c(1,"p-skeleton"),r())}function Ot(i,e){if(i&1&&(o(0,"tr",39),b(1,$t,2,0,"td",31),r()),i&2){let t=v(3);l(),p("ngForOf",t.cols)}}function Nt(i,e){i&1&&(ne(0),oe(1,Ot,2,1,"tr",39,ie),ae()),i&2&&(l(),re(T(0,Tt).constructor(4)))}function Vt(i,e){i&1&&(o(0,"tr")(1,"td",40)(2,"div",41),s(3," No se encontraron registros. "),r()()())}function Pt(i,e){if(i&1&&b(0,Nt,3,1,"ng-container",38)(1,Vt,4,0,"ng-template",null,4,x),i&2){let t=X(2),n=v();p("ngIf",n.loadingTable)("ngIfElse",t)}}var tt=class i{title="Usuarios";icon="ic:round-people-alt";dialogService=d(E);usuarioService=d(J);msg=d(K);cols;loadingTable=!1;exportColumns;dataTable=[];ngOnInit(){this.cols=[{field:"id",header:"ID",customExportHeader:"Cargo ID",align:"center",widthClass:"!w-32"},{field:"nombre",header:"Nombre"},{field:"apellido",header:"Apellido"},{field:"usuario",header:"Usuario",align:"center"},{field:"rol",header:"Rol",align:"center"},{field:"sedes",header:"Edificios",align:"center"},{field:"isActive",header:"Estado",align:"center",widthClass:"!w-28"},{field:"",header:"Acciones",align:"center",widthClass:"!w-36"}],this.exportColumns=this.cols.filter(e=>e.field!="").map(e=>({title:e.header,dataKey:e.field})),this.cargarCargos()}cargarCargos(){this.loadingTable=!0,this.usuarioService.findAll().subscribe({next:e=>{this.dataTable=e,this.loadingTable=!1}})}addNew(){this.dialogService.open(Y,{header:"Nuevo usuario",styleClass:"modal-md",modal:!0,closable:!0}).onClose.subscribe(t=>{t&&this.cargarCargos()})}editar(e){this.dialogService.open(Y,{header:"Editar usuario",styleClass:"modal-md",data:{id:e},modal:!0,dismissableMask:!0,closable:!0}).onClose.subscribe(n=>{n&&this.cargarCargos()})}permisos(){this.dialogService.open(Ie,{header:"Roles de usuario",styleClass:"modal-2xl",modal:!0,dismissableMask:!0,closable:!0}).onClose.subscribe(t=>{t&&this.cargarCargos()})}changeStatus(e){this.msg.confirm(`\xBFEst\xE1 seguro de ${e.isActive?"desactivar":"activar"} el usuario ${e.nombre}?`,()=>{this.usuarioService.changeStatus(e.id,!e.isActive).subscribe({next:t=>{this.cargarCargos()}})})}eliminar(e){this.msg.confirm(`\xBFEst\xE1 seguro de eliminar el edificio ${e.nombre}? Esta acci\xF3n no se puede deshacer.`,()=>{this.usuarioService.delete(e.id).subscribe({next:t=>{this.cargarCargos()}})})}filterGlobal(e,t){e.filterGlobal(t.value,"contains")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=F({type:i,selectors:[["app-usuarios"]],features:[$e([E])],decls:37,vars:9,consts:[["dt",""],["header",""],["body",""],["emptymessage",""],["elseTemplate",""],[1,"flex","flex-col","h-full"],[1,"flex","flex-col","justify-center","gap-4","px-6","py-4","h-[8.5rem]"],[1,"flex","justify-between","items-center","gap-4"],[1,"flex","items-center","gap-4"],["data-inline","false",1,"iconify","icon","font-bold","text-4xl"],[1,"text-2xl","font-semibold"],["severity","danger","size","small",3,"routerLink"],[1,"flex","justify-center","items-center","font-medium","gap-1"],["data-icon","uil:left-arrow-from-left","data-inline","false",1,"iconify","icon","text-lg"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],["styleClass","pi pi-search"],["type","text","pInputText","","placeholder","Buscar",3,"input"],["severity","info","size","small",3,"click"],["data-icon","material-symbols:how-to-reg-outline","data-inline","false",1,"iconify","icon","text-lg"],["data-icon","uil:plus","data-inline","false",1,"iconify","icon","text-lg"],[1,"flex","flex-col","h-[calc(100%","-","8.5rem)]","px-6"],["dataKey","id","stripedRows","","scrollHeight","720px","styleClass","w-full","exportFilename","cargos",3,"value","columns","exportHeader","scrollable","globalFilterFields"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"text-center","text-sm"],[1,"text-start","text-sm","capitalize"],[1,"text-center","text-sm","lowercase"],[1,"text-center","text-sm","capitalize"],[1,"text-start","text-sm"],[1,"list-disc","ps-6"],[4,"ngFor","ngForOf"],[1,"flex","justify-center","items-center","text-sm","capitalize"],["styleClass","uppercase !font-bold !text-xs cursor-pointer","pTooltip","Cambiar estado","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0","rounded","",3,"click","value","severity"],[1,"flex","justify-center","items-center","gap-1"],["text","","severity","success","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Editar","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],["data-inline","false",1,"iconify","icon","font-bold","text-xl"],["text","","severity","danger","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Eliminar","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],[4,"ngIf","ngIfElse"],[1,"h-12"],["colspan","100"],[1,"text-center","text-sm","font-extralight"]],template:function(t,n){if(t&1){let a=C();o(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),c(4,"i",9),o(5,"h2",10),s(6),r()(),o(7,"p-button",11)(8,"div",12),c(9,"i",13),o(10,"span"),s(11,"Configuraci\xF3n"),r()()()(),o(12,"div",14)(13,"div",15)(14,"p-iconfield"),c(15,"p-inputicon",16),o(16,"input",17),g("input",function(Q){u(a);let it=X(30);return f(n.filterGlobal(it,Q.target))}),r()()(),o(17,"div",15)(18,"p-button",18),g("click",function(){return u(a),f(n.permisos())}),o(19,"div",12),c(20,"i",19),o(21,"span"),s(22,"Roles"),r()()(),o(23,"p-button",18),g("click",function(){return u(a),f(n.addNew())}),o(24,"div",12),c(25,"i",20),o(26,"span"),s(27,"Agregar"),r()()()()()(),o(28,"div",21)(29,"p-table",22,0),b(31,Ut,2,1,"ng-template",null,1,x)(33,At,29,10,"ng-template",null,2,x)(35,Pt,3,2,"ng-template",null,3,x),r()()()}t&2&&(l(4),R("data-icon",n.icon),l(2),_(n.title),l(),p("routerLink","/ajustes/configuracion"),l(22),p("value",n.dataTable)("columns",n.cols)("exportHeader","customExportHeader")("scrollable",!0)("globalFilterFields",T(8,Et)))},dependencies:[I,le,se,me,pe,Oe,U,A,k,L,W,je,Ge,H,z,we,ye,Ce,Se,_e,ve],encapsulation:2})};export{tt as UsuariosComponent};
