import{b as je}from"./chunk-TWLOV2EE.js";import{a as Te,b as he}from"./chunk-AKEGUMGJ.js";import{b as ge}from"./chunk-OXAP3N3H.js";import"./chunk-HMF6RJK6.js";import{a as xe}from"./chunk-ZGEBOACG.js";import{b as be}from"./chunk-KOIAJ6TH.js";import"./chunk-G453X5NG.js";import{d as me,e as ce,l as fe,n as ue}from"./chunk-CWKDICKV.js";import{h as pe,i as F}from"./chunk-NYQZODR7.js";import{c as ve,d as g}from"./chunk-BBS5CLCL.js";import{b as Z,c as C,e as ee,f as te,g as ie,i as b,k as ae,l as re,o as oe,r as D,s as ne,t as le,u as _}from"./chunk-7W2NGOAN.js";import"./chunk-FNTIPBS5.js";import"./chunk-A3HZ2PBM.js";import"./chunk-2BOM3PMI.js";import{b as se,d as de}from"./chunk-RVXUJXBG.js";import{a as W}from"./chunk-Q2HHWBKA.js";import"./chunk-4Q3JVAKG.js";import{b as Q}from"./chunk-MCE4IIOZ.js";import{Ea as M,Fa as E}from"./chunk-F2X7M4DW.js";import"./chunk-WCGJ44IN.js";import{B as y,v as K,w as X}from"./chunk-J6775IRK.js";import{$ as d,$b as Y,Gb as i,Hb as a,Ib as m,Mb as A,Rb as p,Sb as U,Ta as l,V as B,ac as o,bc as v,cc as S,fa as T,ga as h,hb as j,hc as q,ic as H,l as $,nb as P,r as G,sc as V,tc as L,uc as J,vb as z,wb as c,wc as I}from"./chunk-VDH5VFWZ.js";import{a as k,b as O,c as R}from"./chunk-EQDQRRRY.js";var f=class n{url=`${W.apiUrl}/inactivacionTrabajadores`;http=d(Q);findAll(){return this.http.get(this.url)}findOne(e){return this.http.get(`${this.url}/${e}`)}create(e){return this.http.post(`${this.url}`,e)}update(e,t){return this.http.put(`${this.url}/${e}`,t)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var x=class n{ref=d(ve);dialogService=d(g);trabajadorService=d(xe);inactivacionService=d(f);formData=new ie({idTrabajador:new b(void 0,{nonNullable:!0,validators:[C.required]}),motivoSuspension:new b(void 0,{nonNullable:!0,validators:[C.required]}),fechaSuspension:new b(void 0,{nonNullable:!0,validators:[C.required]}),nota:new b("",{nonNullable:!0,validators:[]})});id;listaTrabajadores=[];ngOnInit(){let e=this.dialogService.getInstance(this.ref);e.data?(this.id=e.data.id,this.formData.get("idTrabajador")?.disable(),this.formData.get("motivoSuspension")?.disable(),this.formData.get("fechaSuspension")?.disable(),this.precargar(),this.cargarTrabajadoresActivos(!1)):this.cargarTrabajadoresActivos()}precargar(){this.inactivacionService.findOne(this.id).subscribe({next:e=>{this.formData.get("idTrabajador")?.setValue(e.idTrabajador),this.formData.get("motivoSuspension")?.setValue(e.motivoSuspension),this.formData.get("fechaSuspension")?.setValue(new Date(e.fechaSuspension)),this.formData.get("nota")?.setValue(e.nota)}})}cargarTrabajadoresActivos(e=!0){(e?this.trabajadorService.findAllActivos():this.trabajadorService.findAllInactivos()).subscribe({next:t=>{this.listaTrabajadores=t.map(r=>(r.labelName=`${r.identificacion} | ${r.apellido} ${r.nombre}`,r))}})}onUpload(e){console.log(e.files)}guardar(){let e=R(this.formData.value,[]);this.id?this.inactivacionService.update(this.id,O(k({},e),{id:this.id})).subscribe({next:t=>{this.ref.close(t)}}):this.inactivacionService.create(e).pipe(G(t=>{let r=this.listaTrabajadores.find(s=>s.id===e.idTrabajador);if(r&&r?.id){let{id:s,nombre:u,apellido:w,genero:N,idCountry:ye,idTipoDocID:Ce,identificacion:De,idEstadoCivil:_e}=r;return this.trabajadorService.update(s,{id:s,nombre:u,apellido:w,genero:N,idCountry:ye,idTipoDocID:Ce,identificacion:De,idEstadoCivil:_e,isActive:!1})}else return $([])})).subscribe({next:t=>{this.ref.close(t)}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=j({type:n,selectors:[["app-form-inactivar-trabajador"]],decls:20,vars:7,consts:[[1,"flex","flex-col","gap-2"],[1,"flex","flex-col","gap-2",3,"formGroup"],["for","trabajadorId",1,"text-sm","font-medium"],["id","trabajadorId","optionLabel","labelName","optionValue","id","formControlName","idTrabajador","placeholder","Seleccione...",3,"options","readonly","disabled"],["for","motivoSuspension",1,"text-sm","font-medium"],["id","nota","rows","1","cols","30","pTextarea","","formControlName","motivoSuspension"],["for","fechaSuspension",1,"text-sm","font-medium"],["id","fechaSuspension","styleClass","w-full uppercase","dateFormat","dd M yy","placeholder","DD MMM YYYY","formControlName","fechaSuspension","appendTo","body",3,"showIcon"],["for","nota",1,"text-sm","font-medium"],["id","nota","rows","3","cols","30","pTextarea","","formControlName","nota"],[1,"flex","justify-end","gap-2","mt-4"],["severity","info","size","small",3,"onClick","label","disabled"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"form",1)(2,"div",0)(3,"label",2),o(4,"Trabajador"),a(),m(5,"p-select",3),a(),i(6,"div",0)(7,"label",4),o(8,"Motivo de suspensi\xF3n"),a(),m(9,"textarea",5),a(),i(10,"div",0)(11,"label",6),o(12,"Fecha de suspensi\xF3n"),a(),m(13,"p-datepicker",7),a(),i(14,"div",0)(15,"label",8),o(16,"Nota"),a(),m(17,"textarea",9),a()(),i(18,"div",10)(19,"p-button",11),p("onClick",function(){return r.guardar()}),a()()()),t&2&&(l(),c("formGroup",r.formData),l(4),c("options",r.listaTrabajadores)("readonly",!!r.id)("disabled",!!r.id),l(8),c("showIcon",!0),l(6),c("label",r.id?"Actualizar":"Guardar")("disabled",r.formData.invalid))},dependencies:[y,D,ae,Z,ee,te,ne,re,oe,ge,_,E,M,F,pe,ce,me,he,Te,je],encapsulation:2})};var Fe=()=>["nombre","apellido"];function we(n,e){n&1&&(i(0,"tr")(1,"th")(2,"div",21),o(3,"ID"),a()(),i(4,"th")(5,"div",22),o(6,"Nombre"),a()(),i(7,"th")(8,"div",22),o(9,"Apellido"),a()(),i(10,"th")(11,"div",21),o(12," Motivo de suspenci\xF3n "),a()(),i(13,"th")(14,"div",21),o(15,"Nota"),a()(),i(16,"th")(17,"div",21),o(18,"Fecha de suspenci\xF3n"),a()()())}function Ne(n,e){if(n&1){let t=A();i(0,"tr",23),p("click",function(){let s=T(t).$implicit,u=U();return h(u.edit(s.id))}),i(1,"td")(2,"div",24),o(3),a()(),i(4,"td")(5,"div",25),o(6),a()(),i(7,"td")(8,"div",25),o(9),a()(),i(10,"td")(11,"div",24),o(12),a()(),i(13,"td")(14,"div",24),o(15),a()(),i(16,"td")(17,"div",24),o(18),V(19,"date"),V(20,"uppercase"),a()()()}if(n&2){let t=e.$implicit;l(3),v(t.orden),l(3),v(t.trabajador.nombre),l(3),v(t.trabajador.apellido),l(3),S(" ",t.motivoSuspension," "),l(3),S(" ",t.nota," "),l(3),S(" ",L(20,9,J(19,6,t.fechaSuspension,"dd MMM yyyy"))," ")}}function Ae(n,e){n&1&&(i(0,"tr")(1,"td",26)(2,"div",27),o(3," No se encontraron registros. "),a()()())}var Ie=class n{title="Trabajadores inactivos";icon="material-symbols:person-pin-outline-rounded";ref;dialogService=d(g);inactivacionService=d(f);dataTable=[];loadingTable=!1;ngOnInit(){this.cargarTrabajadoresInactivos()}cargarTrabajadoresInactivos(){this.inactivacionService.findAll().subscribe({next:e=>{this.dataTable=e}})}addNew(){this.dialogService.open(x,{header:"Inactivar trabajador",styleClass:"modal-md",position:"top",modal:!0,dismissableMask:!0,closable:!0}).onClose.subscribe(t=>{t&&this.cargarTrabajadoresInactivos()})}edit(e){this.dialogService.open(x,{header:"Inactivar trabajador",styleClass:"modal-md",position:"top",data:{id:e},modal:!0,dismissableMask:!0,closable:!0}).onClose.subscribe(r=>{r&&this.cargarTrabajadoresInactivos()})}filterGlobal(e,t){e.filterGlobal(t.value,"contains")}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=j({type:n,selectors:[["app-trabajadores-inactivos"]],features:[q([g])],decls:32,vars:6,consts:[["dt1",""],["header",""],["body",""],["emptymessage",""],[1,"flex","flex-col","h-full"],[1,"flex","flex-col","justify-center","gap-4","px-6","py-4","h-[8.5rem]"],[1,"flex","justify-between","items-center","gap-4"],[1,"flex","items-center","gap-4"],["data-inline","false",1,"iconify","icon","font-bold","text-4xl"],[1,"text-2xl","font-semibold"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],["styleClass","pi pi-search"],["type","text","pInputText","","placeholder","Buscar",3,"input"],["severity","info","size","small"],[1,"flex","justify-center","items-center","font-medium","gap-1"],["data-icon","material-symbols:download-rounded","data-inline","false",1,"iconify","icon","text-lg"],["severity","info","size","small",3,"click"],["data-icon","material-symbols:add-rounded","data-inline","false",1,"iconify","icon","text-lg"],[1,"flex","flex-col","h-[calc(100%","-","8.5rem)]","px-6"],["dataKey","id","stripedRows","","scrollHeight","720px","styleClass","w-full",3,"value","scrollable","globalFilterFields"],[1,"text-center","text-xs","uppercase"],[1,"text-xs","uppercase"],[1,"hover:!bg-slate-200","cursor-pointer",3,"click"],[1,"text-center","text-sm"],[1,"text-sm"],["colspan","100"],[1,"text-center","text-sm","font-extralight"]],template:function(t,r){if(t&1){let s=A();i(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),m(4,"i",8),i(5,"h2",9),o(6),a()()(),i(7,"div",10)(8,"div",11)(9,"p-iconfield"),m(10,"p-inputicon",12),i(11,"input",13),p("input",function(w){T(s);let N=Y(25);return h(r.filterGlobal(N,w.target))}),a()()(),i(12,"div",11)(13,"p-button",14)(14,"div",15),m(15,"i",16),i(16,"div"),o(17,"XLS"),a()()(),i(18,"p-button",17),p("click",function(){return T(s),h(r.addNew())}),i(19,"div",15),m(20,"i",18),i(21,"div"),o(22,"INACTIVAR TRABAJADOR"),a()()()()()(),i(23,"div",19)(24,"p-table",20,0),P(26,we,19,0,"ng-template",null,1,I)(28,Ne,21,11,"ng-template",null,2,I)(30,Ae,4,0,"ng-template",null,3,I),a()()()}t&2&&(l(4),z("data-icon",r.icon),l(2),v(r.title),l(18),c("value",r.dataTable)("scrollable",!0)("globalFilterFields",H(5,Fe)))},dependencies:[y,K,X,D,be,E,M,ue,fe,de,se,_,le,F],encapsulation:2})};export{Ie as TrabajadoresInactivosComponent};
