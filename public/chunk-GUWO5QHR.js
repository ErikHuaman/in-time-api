import{a as Fh,b as kh,c as Nh,d as Gh}from"./chunk-FJLOXZSG.js";import{d as Vu,g as Wu}from"./chunk-6R7BUVFI.js";import{a as Sh}from"./chunk-J2XGTH7F.js";import{a as Ih,b as bh}from"./chunk-3UQBCJYR.js";import{a as Lh,b as Oh}from"./chunk-HSUUTGKP.js";import{a as Rh}from"./chunk-W6ENELZB.js";import{a as Ah,b as Mh}from"./chunk-AKEGUMGJ.js";import{b as Th}from"./chunk-OXAP3N3H.js";import"./chunk-HMF6RJK6.js";import{a as Dh,b as Ph}from"./chunk-RVQOAWJC.js";import{a as vo}from"./chunk-TVRGOZ6Z.js";import{a as vh}from"./chunk-G453X5NG.js";import{l as Eh,n as Ch}from"./chunk-CWKDICKV.js";import{e as gh,f as _h,h as xh,i as yh}from"./chunk-NYQZODR7.js";import{c as wh,d as _r}from"./chunk-BBS5CLCL.js";import{a as qu,b as Hu,c as Le,e as $u,f as Ju,g as Qu,i as Oe,j as th,k as eh,l as ih,o as nh,r as yo,s as rh,t as vn,u as Eo}from"./chunk-7W2NGOAN.js";import{a as uh}from"./chunk-FNTIPBS5.js";import{b as ch}from"./chunk-A3HZ2PBM.js";import"./chunk-2BOM3PMI.js";import{a as ah,b as dh,d as fh,f as ph,g as mh}from"./chunk-RVXUJXBG.js";import"./chunk-Q2HHWBKA.js";import"./chunk-4Q3JVAKG.js";import{b as zu}from"./chunk-MCE4IIOZ.js";import{Ba as hh,Ea as Co,Fa as wo,Q as Xu,S as wn,T as Hi,U as Js,X as Qs,aa as Uu,ha as Ku,ka as Bu,la as ta,ma as Yu,pa as ju,qa as Zu,r as xo,s as ci,sa as oh,va as sh,ya as lh}from"./chunk-F2X7M4DW.js";import"./chunk-WCGJ44IN.js";import{B as Cn,m as mo,o as go,p as _o,s as Nu,t as Gu}from"./chunk-J6775IRK.js";import{$ as qt,$b as Zi,Ab as mr,Cb as Du,Eb as Pu,Fb as Fu,Fc as gt,Gb as R,Gc as qi,Hb as O,Ib as ft,Ic as $s,Jb as xe,Jc as ku,Kb as ye,Lb as Ye,Mb as ae,Rb as pt,Sb as L,Ta as A,U as Iu,V as lo,Vb as le,W as bu,Wb as li,Xb as vt,Yb as St,Za as qs,ac as Q,bc as $t,cc as gr,ec as co,fa as et,fc as uo,ga as it,gc as ho,hb as En,hc as fo,ia as Ru,ib as Mu,ic as Ii,jc as Ee,kc as po,l as so,lb as Lu,nb as nt,oa as _e,p as Tu,pa as Au,r as ao,ua as pr,vb as bt,wb as M,wc as Me,xb as Ou,zb as Hs}from"./chunk-VDH5VFWZ.js";import{a as Cu,b as wu,c as vu,f as Su}from"./chunk-EQDQRRRY.js";var vm=["item"],Sm=["empty"],Tm=["header"],Im=["footer"],bm=["selecteditem"],Rm=["group"],Am=["loader"],Mm=["removeicon"],Lm=["loadingicon"],Om=["clearicon"],Dm=["dropdownicon"],Pm=["container"],Fm=["focusInput"],km=["multiIn"],Nm=["multiContainer"],Gm=["ddBtn"],zm=["items"],Vm=["scroller"],Wm=["overlay"],Xm=n=>({"p-autocomplete-chip-item":!0,"p-focus":n}),Vh=n=>({$implicit:n}),Um=()=>({class:"p-autocomplete-chip-icon"}),So=n=>({height:n}),Wh=(n,t)=>({$implicit:n,options:t}),Km=n=>({options:n}),Bm=()=>({}),Ym=(n,t)=>({$implicit:n,index:t});function jm(n,t){if(n&1){let e=ae();R(0,"input",19,3),pt("input",function(r){et(e);let o=L();return it(o.onInput(r))})("keydown",function(r){et(e);let o=L();return it(o.onKeyDown(r))})("change",function(r){et(e);let o=L();return it(o.onInputChange(r))})("focus",function(r){et(e);let o=L();return it(o.onInputFocus(r))})("blur",function(r){et(e);let o=L();return it(o.onInputBlur(r))})("paste",function(r){et(e);let o=L();return it(o.onInputPaste(r))})("keyup",function(r){et(e);let o=L();return it(o.onInputKeyUp(r))}),O()}if(n&2){let e,i=L();mr(i.inputStyleClass),M("pAutoFocus",i.autofocus)("ngClass","p-autocomplete-input")("ngStyle",i.inputStyle)("type",i.type)("variant",i.variant)("autocomplete",i.autocomplete)("required",i.required)("name",i.name)("pSize",i.size)("tabindex",i.disabled?-1:i.tabindex)("readonly",i.readonly)("disabled",i.disabled)("fluid",i.hasFluid),bt("value",i.inputValue())("id",i.inputId)("placeholder",i.placeholder)("maxlength",i.maxlength)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledBy)("aria-required",i.required)("aria-expanded",(e=i.overlayVisible)!==null&&e!==void 0?e:!1)("aria-controls",i.overlayVisible?i.id+"_list":null)("aria-activedescendant",i.focused?i.focusedOptionId:void 0)}}function Zm(n,t){if(n&1){let e=ae();R(0,"TimesIcon",22),pt("click",function(){et(e);let r=L(2);return it(r.clear())}),O()}n&2&&(M("styleClass","p-autocomplete-clear-icon"),bt("aria-hidden",!0))}function qm(n,t){}function Hm(n,t){n&1&&nt(0,qm,0,0,"ng-template")}function $m(n,t){if(n&1){let e=ae();R(0,"span",23),pt("click",function(){et(e);let r=L(2);return it(r.clear())}),nt(1,Hm,1,0,null,24),O()}if(n&2){let e=L(2);bt("aria-hidden",!0),A(),M("ngTemplateOutlet",e.clearIconTemplate||e._clearIconTemplate)}}function Jm(n,t){if(n&1&&(xe(0),nt(1,Zm,1,2,"TimesIcon",20)(2,$m,2,2,"span",21),ye()),n&2){let e=L();A(),M("ngIf",!e.clearIconTemplate&&!e._clearIconTemplate),A(),M("ngIf",e.clearIconTemplate||e._clearIconTemplate)}}function Qm(n,t){n&1&&Ye(0)}function tg(n,t){if(n&1){let e=ae();R(0,"span",33),pt("click",function(r){et(e);let o=L(3).index,s=L(2);return it(s.readonly?"":s.removeOption(r,o))}),ft(1,"TimesCircleIcon",34),O()}n&2&&(A(),M("styleClass","p-autocomplete-chip-icon"),bt("aria-hidden",!0))}function eg(n,t){n&1&&(xe(0),nt(1,tg,2,2,"ng-template",null,6,Me),ye())}function ig(n,t){if(n&1&&(R(0,"p-chip",32),nt(1,eg,3,0,"ng-container",15),O()),n&2){let e=L().$implicit,i=L(2);M("label",i.getOptionLabel(e))("removable",!0),A(),M("ngIf",!i.removeIconTemplate&&!i._removeIconTemplate)}}function ng(n,t){}function rg(n,t){n&1&&nt(0,ng,0,0,"ng-template")}function og(n,t){if(n&1&&(R(0,"span"),nt(1,rg,1,0,null,30),O()),n&2){let e=L(3);bt("aria-hidden",!0),A(),M("ngTemplateOutlet",e.removeIconTemplate||e._removeIconTemplate)("ngTemplateOutletContext",Ii(3,Um))}}function sg(n,t){if(n&1&&(R(0,"li",29,5),nt(2,Qm,1,0,"ng-container",30)(3,ig,2,3,"p-chip",31)(4,og,2,4,"span",15),O()),n&2){let e=t.$implicit,i=t.index,r=L(2);M("ngClass",Ee(10,Xm,r.focusedMultipleOptionIndex()===i)),bt("id",r.id+"_multiple_option_"+i)("aria-label",r.getOptionLabel(e))("aria-setsize",r.modelValue().length)("aria-posinset",i+1)("aria-selected",!0),A(2),M("ngTemplateOutlet",r.selectedItemTemplate||r._selectedItemTemplate)("ngTemplateOutletContext",Ee(12,Vh,e)),A(),M("ngIf",!r.selectedItemTemplate&&!r._selectedItemTemplate),A(),M("ngIf",r.removeIconTemplate||r._removeIconTemplate)}}function ag(n,t){if(n&1){let e=ae();R(0,"ul",25,4),pt("focus",function(r){et(e);let o=L();return it(o.onMultipleContainerFocus(r))})("blur",function(r){et(e);let o=L();return it(o.onMultipleContainerBlur(r))})("keydown",function(r){et(e);let o=L();return it(o.onMultipleContainerKeyDown(r))}),nt(2,sg,5,14,"li",26),R(3,"li",27)(4,"input",28,3),pt("input",function(r){et(e);let o=L();return it(o.onInput(r))})("keydown",function(r){et(e);let o=L();return it(o.onKeyDown(r))})("change",function(r){et(e);let o=L();return it(o.onInputChange(r))})("focus",function(r){et(e);let o=L();return it(o.onInputFocus(r))})("blur",function(r){et(e);let o=L();return it(o.onInputBlur(r))})("paste",function(r){et(e);let o=L();return it(o.onInputPaste(r))})("keyup",function(r){et(e);let o=L();return it(o.onInputKeyUp(r))}),O()()()}if(n&2){let e,i=L();M("ngClass",i.inputMultipleClass)("tabindex",-1),bt("aria-orientation","horizontal")("aria-activedescendant",i.focused?i.focusedMultipleOptionId:void 0),A(2),M("ngForOf",i.modelValue()),A(2),mr(i.inputStyleClass),M("pAutoFocus",i.autofocus)("ngClass",i.inputClass)("ngStyle",i.inputStyle)("autocomplete",i.autocomplete)("required",i.required)("tabindex",i.disabled?-1:i.tabindex)("readonly",i.readonly)("disabled",i.disabled),bt("type",i.type)("id",i.inputId)("name",i.name)("placeholder",i.filled?null:i.placeholder)("maxlength",i.maxlength)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledBy)("aria-required",i.required)("aria-expanded",(e=i.overlayVisible)!==null&&e!==void 0?e:!1)("aria-controls",i.overlayVisible?i.id+"_list":null)("aria-activedescendant",i.focused?i.focusedOptionId:void 0)}}function lg(n,t){n&1&&ft(0,"SpinnerIcon",37),n&2&&(M("styleClass","p-autocomplete-loader")("spin",!0),bt("aria-hidden",!0))}function cg(n,t){}function ug(n,t){n&1&&nt(0,cg,0,0,"ng-template")}function hg(n,t){if(n&1&&(R(0,"span",38),nt(1,ug,1,0,null,24),O()),n&2){let e=L(2);bt("aria-hidden",!0),A(),M("ngTemplateOutlet",e.loadingIconTemplate||e._loadingIconTemplate)}}function dg(n,t){if(n&1&&(xe(0),nt(1,lg,1,3,"SpinnerIcon",35)(2,hg,2,2,"span",36),ye()),n&2){let e=L();A(),M("ngIf",!e.loadingIconTemplate&&!e._loadingIconTemplate),A(),M("ngIf",e.loadingIconTemplate||e._loadingIconTemplate)}}function fg(n,t){if(n&1&&ft(0,"span",41),n&2){let e=L(2);M("ngClass",e.dropdownIcon),bt("aria-hidden",!0)}}function pg(n,t){n&1&&ft(0,"ChevronDownIcon")}function mg(n,t){}function gg(n,t){n&1&&nt(0,mg,0,0,"ng-template")}function _g(n,t){if(n&1&&(xe(0),nt(1,pg,1,0,"ChevronDownIcon",15)(2,gg,1,0,null,24),ye()),n&2){let e=L(2);A(),M("ngIf",!e.dropdownIconTemplate&&!e._dropdownIconTemplate),A(),M("ngTemplateOutlet",e.dropdownIconTemplate||e._dropdownIconTemplate)}}function xg(n,t){if(n&1){let e=ae();R(0,"button",39,7),pt("click",function(r){et(e);let o=L();return it(o.handleDropdownClick(r))}),nt(2,fg,1,2,"span",40)(3,_g,3,2,"ng-container",15),O()}if(n&2){let e=L();M("disabled",e.disabled),bt("aria-label",e.dropdownAriaLabel)("tabindex",e.tabindex),A(2),M("ngIf",e.dropdownIcon),A(),M("ngIf",!e.dropdownIcon)}}function yg(n,t){n&1&&Ye(0)}function Eg(n,t){n&1&&Ye(0)}function Cg(n,t){if(n&1&&nt(0,Eg,1,0,"ng-container",30),n&2){let e=t.$implicit,i=t.options;L(2);let r=Zi(6);M("ngTemplateOutlet",r)("ngTemplateOutletContext",po(2,Wh,e,i))}}function wg(n,t){n&1&&Ye(0)}function vg(n,t){if(n&1&&nt(0,wg,1,0,"ng-container",30),n&2){let e=t.options,i=L(4);M("ngTemplateOutlet",i.loaderTemplate||i._loaderTemplate)("ngTemplateOutletContext",Ee(2,Km,e))}}function Sg(n,t){n&1&&(xe(0),nt(1,vg,1,4,"ng-template",null,10,Me),ye())}function Tg(n,t){if(n&1){let e=ae();R(0,"p-scroller",46,9),pt("onLazyLoad",function(r){et(e);let o=L(2);return it(o.onLazyLoad.emit(r))}),nt(2,Cg,1,5,"ng-template",null,2,Me)(4,Sg,3,0,"ng-container",15),O()}if(n&2){let e=L(2);Hs(Ee(8,So,e.scrollHeight)),M("items",e.visibleOptions())("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),A(4),M("ngIf",e.loaderTemplate||e._loaderTemplate)}}function Ig(n,t){n&1&&Ye(0)}function bg(n,t){if(n&1&&(xe(0),nt(1,Ig,1,0,"ng-container",30),ye()),n&2){L();let e=Zi(6),i=L();A(),M("ngTemplateOutlet",e)("ngTemplateOutletContext",po(3,Wh,i.visibleOptions(),Ii(2,Bm)))}}function Rg(n,t){if(n&1&&(R(0,"span"),Q(1),O()),n&2){let e=L(2).$implicit,i=L(3);A(),$t(i.getOptionGroupLabel(e.optionGroup))}}function Ag(n,t){n&1&&Ye(0)}function Mg(n,t){if(n&1&&(xe(0),R(1,"li",50),nt(2,Rg,2,1,"span",15)(3,Ag,1,0,"ng-container",30),O(),ye()),n&2){let e=L(),i=e.$implicit,r=e.index,o=L().options,s=L(2);A(),M("ngStyle",Ee(5,So,o.itemSize+"px")),bt("id",s.id+"_"+s.getOptionIndex(r,o)),A(),M("ngIf",!s.groupTemplate),A(),M("ngTemplateOutlet",s.groupTemplate)("ngTemplateOutletContext",Ee(7,Vh,i.optionGroup))}}function Lg(n,t){if(n&1&&(R(0,"span"),Q(1),O()),n&2){let e=L(2).$implicit,i=L(3);A(),$t(i.getOptionLabel(e))}}function Og(n,t){n&1&&Ye(0)}function Dg(n,t){if(n&1){let e=ae();xe(0),R(1,"li",51),pt("click",function(r){et(e);let o=L().$implicit,s=L(3);return it(s.onOptionSelect(r,o))})("mouseenter",function(r){et(e);let o=L().index,s=L().options,a=L(2);return it(a.onOptionMouseEnter(r,a.getOptionIndex(o,s)))}),nt(2,Lg,2,1,"span",15)(3,Og,1,0,"ng-container",30),O(),ye()}if(n&2){let e=L(),i=e.$implicit,r=e.index,o=L().options,s=L(2);A(),M("ngStyle",Ee(12,So,o.itemSize+"px"))("ngClass",s.optionClass(i,r,o)),bt("id",s.id+"_"+s.getOptionIndex(r,o))("aria-label",s.getOptionLabel(i))("aria-selected",s.isSelected(i))("aria-disabled",s.isOptionDisabled(i))("data-p-focused",s.focusedOptionIndex()===s.getOptionIndex(r,o))("aria-setsize",s.ariaSetSize)("aria-posinset",s.getAriaPosInset(s.getOptionIndex(r,o))),A(),M("ngIf",!s.itemTemplate&&!s._itemTemplate),A(),M("ngTemplateOutlet",s.itemTemplate||s._itemTemplate)("ngTemplateOutletContext",po(14,Ym,i,o.getOptions?o.getOptions(r):r))}}function Pg(n,t){if(n&1&&nt(0,Mg,4,9,"ng-container",15)(1,Dg,4,17,"ng-container",15),n&2){let e=t.$implicit,i=L(3);M("ngIf",i.isOptionGroup(e)),A(),M("ngIf",!i.isOptionGroup(e))}}function Fg(n,t){if(n&1&&(xe(0),Q(1),ye()),n&2){let e=L(4);A(),gr(" ",e.searchResultMessageText," ")}}function kg(n,t){n&1&&Ye(0,null,12)}function Ng(n,t){if(n&1&&(R(0,"li",52),nt(1,Fg,2,1,"ng-container",53)(2,kg,2,0,"ng-container",24),O()),n&2){let e=L().options,i=L(2);M("ngStyle",Ee(4,So,e.itemSize+"px")),A(),M("ngIf",!i.emptyTemplate&&!i._emptyTemplate)("ngIfElse",i.empty),A(),M("ngTemplateOutlet",i.emptyTemplate||i._emptyTemplate)}}function Gg(n,t){if(n&1&&(R(0,"ul",47,11),nt(2,Pg,2,2,"ng-template",48)(3,Ng,3,6,"li",49),O()),n&2){let e=t.$implicit,i=t.options,r=L(2);Hs(i.contentStyle),M("ngClass",i.contentStyleClass),bt("id",r.id+"_list")("aria-label",r.listLabel),A(2),M("ngForOf",e),A(),M("ngIf",!e||e&&e.length===0&&r.showEmptyMessage)}}function zg(n,t){n&1&&Ye(0)}function Vg(n,t){if(n&1&&(R(0,"div",42),nt(1,yg,1,0,"ng-container",24),R(2,"div",43),nt(3,Tg,5,10,"p-scroller",44)(4,bg,2,6,"ng-container",15),O(),nt(5,Gg,4,7,"ng-template",null,8,Me)(7,zg,1,0,"ng-container",24),O(),R(8,"span",45),Q(9),O()),n&2){let e=L();mr(e.panelStyleClass),M("ngClass",e.panelClass)("ngStyle",e.panelStyle),A(),M("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),A(),Ou("max-height",e.virtualScroll?"auto":e.scrollHeight),A(),M("ngIf",e.virtualScroll),A(),M("ngIf",!e.virtualScroll),A(3),M("ngTemplateOutlet",e.footerTemplate||e._footerTemplate),A(2),gr(" ",e.selectedMessageText," ")}}var Wg=({dt:n})=>`
.p-autocomplete {
    display: inline-flex;
}

.p-autocomplete-loader {
    position: absolute;
    top: 50%;
    margin-top: -0.5rem;
    inset-inline-end: ${n("autocomplete.padding.x")};
}

.p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-loader {
    inset-inline-end: calc(${n("autocomplete.dropdown.width")} + ${n("autocomplete.padding.x")});
}

.p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-input {
    flex: 1 1 auto;
    width: 1%;
}

.p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-input,
.p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-input-multiple {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
}

.p-autocomplete-dropdown {
    cursor: pointer;
    display: inline-flex;
    user-select: none;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    width: ${n("autocomplete.dropdown.width")};
    border-start-end-radius: ${n("autocomplete.dropdown.border.radius")};
    border-end-end-radius: ${n("autocomplete.dropdown.border.radius")};
    background: ${n("autocomplete.dropdown.background")};
    border: 1px solid ${n("autocomplete.dropdown.border.color")};
    border-inline-start: 0 none;
    color: ${n("autocomplete.dropdown.color")};
    transition: background ${n("autocomplete.transition.duration")}, color ${n("autocomplete.transition.duration")}, border-color ${n("autocomplete.transition.duration")}, outline-color ${n("autocomplete.transition.duration")}, box-shadow ${n("autocomplete.transition.duration")};
    outline-color: transparent;
}

.p-autocomplete-dropdown:not(:disabled):hover {
    background: ${n("autocomplete.dropdown.hover.background")};
    border-color: ${n("autocomplete.dropdown.hover.border.color")};
    color: ${n("autocomplete.dropdown.hover.color")};
}

.p-autocomplete-dropdown:not(:disabled):active {
    background: ${n("autocomplete.dropdown.active.background")};
    border-color: ${n("autocomplete.dropdown.active.border.color")};
    color: ${n("autocomplete.dropdown.active.color")};
}

.p-autocomplete-dropdown:focus-visible {
    box-shadow: ${n("autocomplete.dropdown.focus.ring.shadow")};
    outline: ${n("autocomplete.dropdown.focus.ring.width")} ${n("autocomplete.dropdown.focus.ring.style")} ${n("autocomplete.dropdown.focus.ring.color")};
    outline-offset: ${n("autocomplete.dropdown.focus.ring.offset")};
}

.p-autocomplete .p-autocomplete-overlay {
    min-width: 100%;
}

.p-autocomplete-overlay {
    background: ${n("autocomplete.overlay.background")};
    color: ${n("autocomplete.overlay.color")};
    border: 1px solid ${n("autocomplete.overlay.border.color")};
    border-radius: ${n("autocomplete.overlay.border.radius")};
    box-shadow: ${n("autocomplete.overlay.shadow")};
}

.p-autocomplete-list-container {
    overflow: auto;
}

.p-autocomplete-list {
    margin: 0;
    list-style-type: none;
    display: flex;
    flex-direction: column;
    gap: ${n("autocomplete.list.gap")};
    padding: ${n("autocomplete.list.padding")};
}

.p-autocomplete-option {
    cursor: pointer;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    padding: ${n("autocomplete.option.padding")};
    border: 0 none;
    color: ${n("autocomplete.option.color")};
    background: transparent;
    transition: background ${n("autocomplete.transition.duration")}, color ${n("autocomplete.transition.duration")}, border-color ${n("autocomplete.transition.duration")};
    border-radius: ${n("autocomplete.option.border.radius")};
}

.p-autocomplete-option:not(.p-autocomplete-option-selected):not(.p-disabled).p-focus {
    background: ${n("autocomplete.option.focus.background")};
    color: ${n("autocomplete.option.focus.color")};
}

.p-autocomplete-option-selected {
    background: ${n("autocomplete.option.selected.background")};
    color: ${n("autocomplete.option.selected.color")};
}

.p-autocomplete-option-selected.p-focus {
    background: ${n("autocomplete.option.selected.focus.background")};
    color: ${n("autocomplete.option.selected.focus.color")};
}

.p-autocomplete-option-group {
    margin: 0;
    padding: ${n("autocomplete.option.group.padding")};
    color: ${n("autocomplete.option.group.color")};
    background: ${n("autocomplete.option.group.background")};
    font-weight: ${n("autocomplete.option.group.font.weight")};
}

.p-autocomplete-input-multiple {
    margin: 0;
    list-style-type: none;
    cursor: text;
    overflow: hidden;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    padding: calc(${n("autocomplete.padding.y")} / 2) ${n("autocomplete.padding.x")};
    gap: calc(${n("autocomplete.padding.y")} / 2);
    color: ${n("autocomplete.color")};
    background: ${n("autocomplete.background")};
    border: 1px solid ${n("autocomplete.border.color")};
    border-radius: ${n("autocomplete.border.radius")};
    width: 100%;
    transition: background ${n("autocomplete.transition.duration")}, color ${n("autocomplete.transition.duration")}, border-color ${n("autocomplete.transition.duration")}, outline-color ${n("autocomplete.transition.duration")}, box-shadow ${n("autocomplete.transition.duration")};
    outline-color: transparent;
    box-shadow: ${n("autocomplete.shadow")};
}

.p-autocomplete:not(.p-disabled):hover .p-autocomplete-input-multiple {
    border-color: ${n("autocomplete.hover.border.color")};
}

.p-autocomplete:not(.p-disabled).p-focus .p-autocomplete-input-multiple {
    border-color: ${n("autocomplete.focus.border.color")};
    box-shadow: ${n("autocomplete.focus.ring.shadow")};
    outline: ${n("autocomplete.focus.ring.width")} ${n("autocomplete.focus.ring.style")} ${n("autocomplete.focus.ring.color")};
    outline-offset: ${n("autocomplete.focus.ring.offset")};
}

.p-autocomplete.p-invalid .p-autocomplete-input-multiple {
    border-color: ${n("autocomplete.invalid.border.color")};
}

.p-variant-filled.p-autocomplete-input-multiple {
    background: ${n("autocomplete.filled.background")};
}

.p-autocomplete:not(.p-disabled):hover .p-variant-filled.p-autocomplete-input-multiple {
    background: ${n("autocomplete.filled.hover.background")};
}

.p-autocomplete:not(.p-disabled).p-focus .p-variant-filled.p-autocomplete-input-multiple  {
    background: ${n("autocomplete.filled.focus.background")};
}

.p-autocomplete.p-disabled {
    opacity: 1;
}

.p-autocomplete.p-disabled .p-autocomplete-input-multiple {
    opacity: 1;
    background: ${n("autocomplete.disabled.background")};
    color: ${n("autocomplete.disabled.color")};
}

.p-autocomplete-chip.p-chip {
    padding-block-start: calc(${n("autocomplete.padding.y")} / 2);
    padding-block-end: calc(${n("autocomplete.padding.y")} / 2);
    border-radius: ${n("autocomplete.chip.border.radius")};
}

.p-autocomplete-input-multiple:has(.p-autocomplete-chip) {
    padding-inline-start: calc(${n("autocomplete.padding.y")} / 2);
    padding-inline-end: calc(${n("autocomplete.padding.y")} / 2);
}

.p-autocomplete-chip-item.p-focus .p-autocomplete-chip {
    background: ${n("autocomplete.chip.focus.background")};
    color: ${n("autocomplete.chip.focus.color")};
}

.p-autocomplete-input-chip {
    flex: 1 1 auto;
    display: inline-flex;
    padding-block-start: calc(${n("autocomplete.padding.y")} / 2);
    padding-block-end: calc(${n("autocomplete.padding.y")} / 2);
}

.p-autocomplete-input-chip input {
    border: 0 none;
    outline: 0 none;
    background: transparent;
    margin: 0;
    padding: 0;
    box-shadow: none;
    border-radius: 0;
    width: 100%;
    font-family: inherit;
    font-feature-settings: inherit;
    font-size: 1rem;
    color: inherit;
}

.p-autocomplete-input-chip input::placeholder {
    color: ${n("autocomplete.placeholder.color")};
}

.p-autocomplete-empty-message {
    padding: ${n("autocomplete.empty.message.padding")};
}

.p-autocomplete-fluid {
    display: flex;
}

.p-autocomplete-fluid:has(.p-autocomplete-dropdown) .p-autocomplete-input {
    width: 1%;
}

.p-autocomplete:has(.p-inputtext-sm) .p-autocomplete-dropdown {
    width: ${n("autocomplete.dropdown.sm.width")};
}

.p-autocomplete:has(.p-inputtext-sm) .p-autocomplete-dropdown .p-icon {
    font-size: ${n("form.field.sm.font.size")};
    width: ${n("form.field.sm.font.size")};
    height: ${n("form.field.sm.font.size")};
}

.p-autocomplete:has(.p-inputtext-lg) .p-autocomplete-dropdown {
    width: ${n("autocomplete.dropdown.lg.width")};
}

.p-autocomplete:has(.p-inputtext-lg) .p-autocomplete-dropdown .p-icon {
    font-size: ${n("form.field.lg.font.size")};
    width: ${n("form.field.lg.font.size")};
    height: ${n("form.field.lg.font.size")};
}

.p-autocomplete-clear-icon {
    position: absolute;
    top: 50%;
    margin-top: -0.5rem;
    cursor: pointer;
    right: ${n("autocomplete.padding.x")};
    color: ${n("autocomplete.dropdown.color")};
}

.p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-clear-icon {
    right: calc(${n("autocomplete.padding.x")} + ${n("autocomplete.dropdown.width")});
}
p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input,
p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input-multiple,
p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input,
p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input-multiple
p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input,
p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input-multiple {
    border-color: ${n("autocomplete.invalid.border.color")};
}
p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input:enabled:focus,
p-autoComplete.ng-invalid.ng-dirty:not(.p-disabled).p-focus .p-autocomplete-input-multiple,
p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input:enabled:focus,
p-auto-complete.ng-invalid.ng-dirty:not(.p-disabled).p-focus .p-autocomplete-input-multiple,
p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input:enabled:focus,
p-autocomplete.ng-invalid.ng-dirty:not(.p-disabled).p-focus .p-autocomplete-input-multiple {
    border-color: ${n("autocomplete.focus.border.color")};
}
p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input-chip input::placeholder,
p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input-chip input::placeholder,
p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input-chip input::placeholder {
    color: ${n("autocomplete.invalid.placeholder.color")};
}

p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input::placeholder,
p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input::placeholder,
p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input::placeholder {
    color: ${n("autocomplete.invalid.placeholder.color")};
}`,Xg={root:{position:"relative"}},Ug={root:({instance:n})=>({"p-autocomplete p-component p-inputwrapper":!0,"p-disabled":n.disabled,"p-focus":n.focused,"p-inputwrapper-filled":n.filled,"p-inputwrapper-focus":n.focused&&!n.disabled||n.autofocus||n.overlayVisible,"p-autocomplete-open":n.overlayVisible,"p-autocomplete-clearable":n.showClear&&!n.disabled,"p-autocomplete-fluid":n.hasFluid}),pcInput:"p-autocomplete-input",inputMultiple:({instance:n})=>({"p-autocomplete-input-multiple":!0,"p-variant-filled":(n.variant??(n.config.inputStyle()||n.config.inputVariant()))==="filled"}),chipItem:({instance:n,i:t})=>["p-autocomplete-chip-item",{"p-focus":n.focusedMultipleOptionIndex===t}],pcChip:"p-autocomplete-chip",chipIcon:"p-autocomplete-chip-icon",inputChip:"p-autocomplete-input-chip",loader:"p-autocomplete-loader",dropdown:"p-autocomplete-dropdown",overlay:"p-autocomplete-overlay p-component",list:"p-autocomplete-list",optionGroup:"p-autocomplete-option-group",option:({instance:n,option:t,i:e,getItemOptions:i})=>({"p-autocomplete-option":!0,"p-autocomplete-option-selected":n.isSelected(t),"p-focus":n.focusedOptionIndex===n.getOptionIndex(e,i),"p-disabled":n.isOptionDisabled(t)}),emptyMessage:"p-autocomplete-empty-message"},zh=(()=>{class n extends ju{name="autocomplete";theme=Wg;classes=Ug;inlineStyles=Xg;static \u0275fac=(()=>{let e;return function(r){return(e||(e=Ru(n)))(r||n)}})();static \u0275prov=lo({token:n,factory:n.\u0275fac})}return n})();var Kg={provide:qu,useExisting:Iu(()=>To),multi:!0},To=(()=>{class n extends oh{overlayService;zone;minLength=1;delay=300;style;panelStyle;styleClass;panelStyleClass;inputStyle;inputId;inputStyleClass;placeholder;readonly;disabled;scrollHeight="200px";lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;maxlength;name;required;size;appendTo;autoHighlight;forceSelection;type="text";autoZIndex=!0;baseZIndex=0;ariaLabel;dropdownAriaLabel;ariaLabelledBy;dropdownIcon;unique=!0;group;completeOnFocus=!1;showClear=!1;field;dropdown;showEmptyMessage=!0;dropdownMode="blank";multiple;tabindex;dataKey;emptyMessage;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";autofocus;autocomplete="off";optionGroupChildren="items";optionGroupLabel="label";overlayOptions;get suggestions(){return this._suggestions()}set suggestions(e){this._suggestions.set(e),this.handleSuggestionsChange()}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.log("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}optionLabel;optionValue;id;searchMessage;emptySelectionMessage;selectionMessage;autoOptionFocus=!1;selectOnFocus;searchLocale;optionDisabled;focusOnHover=!0;typeahead=!0;variant;fluid=!1;completeMethod=new _e;onSelect=new _e;onUnselect=new _e;onFocus=new _e;onBlur=new _e;onDropdownClick=new _e;onClear=new _e;onKeyUp=new _e;onShow=new _e;onHide=new _e;onLazyLoad=new _e;containerEL;inputEL;multiInputEl;multiContainerEL;dropdownButton;itemsViewChild;scroller;overlayViewChild;_itemSize;itemsWrapper;itemTemplate;emptyTemplate;headerTemplate;footerTemplate;selectedItemTemplate;groupTemplate;loaderTemplate;removeIconTemplate;loadingIconTemplate;clearIconTemplate;dropdownIconTemplate;primeng=qt(Zu);value;_suggestions=pr(null);onModelChange=()=>{};onModelTouched=()=>{};timeout;overlayVisible;suggestionsUpdated;highlightOption;highlightOptionChanged;focused=!1;_filled;get filled(){return this._filled}set filled(e){this._filled=e}loading;scrollHandler;listId;searchTimeout;dirty=!1;_itemTemplate;_groupTemplate;_selectedItemTemplate;_headerTemplate;_emptyTemplate;_footerTemplate;_loaderTemplate;_removeIconTemplate;_loadingIconTemplate;_clearIconTemplate;_dropdownIconTemplate;modelValue=pr(null);focusedMultipleOptionIndex=pr(-1);focusedOptionIndex=pr(-1);_componentStyle=qt(zh);visibleOptions=$s(()=>this.group?this.flatOptions(this._suggestions()):this._suggestions()||[]);inputValue=$s(()=>{let e=this.modelValue(),i=this.optionValueSelected?(this.suggestions||[]).find(r=>Hi(r,this.optionValue)===e):e;if(wn(e))if(typeof e=="object"||this.optionValueSelected){let r=this.getOptionLabel(i);return r??e}else return e;else return""});get focusedMultipleOptionId(){return this.focusedMultipleOptionIndex()!==-1?`${this.id}_multiple_option_${this.focusedMultipleOptionIndex()}`:null}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}get rootClass(){return this._componentStyle.classes.root({instance:this})}get inputMultipleClass(){return this._componentStyle.classes.inputMultiple({instance:this})}get panelClass(){return{"p-autocomplete-overlay p-component":!0,"p-input-filled":this.config.inputStyle()==="filled"||this.config.inputVariant()==="filled","p-ripple-disabled":this.config.ripple()===!1}}get inputClass(){return{"p-autocomplete-input":!this.multiple,"p-autocomplete-dd-input":this.dropdown}}get searchResultMessageText(){return wn(this.visibleOptions())&&this.overlayVisible?this.searchMessageText.replaceAll("{0}",this.visibleOptions().length):this.emptySearchMessageText}get searchMessageText(){return this.searchMessage||this.config.translation.searchMessage||""}get emptySearchMessageText(){return this.emptyMessage||this.config.translation.emptySearchMessage||""}get selectionMessageText(){return this.selectionMessage||this.config.translation.selectionMessage||""}get emptySelectionMessageText(){return this.emptySelectionMessage||this.config.translation.emptySelectionMessage||""}get selectedMessageText(){return this.hasSelectedOption()?this.selectionMessageText.replaceAll("{0}",this.multiple?this.modelValue().length:"1"):this.emptySelectionMessageText}get ariaSetSize(){return this.visibleOptions().filter(e=>!this.isOptionGroup(e)).length}get listLabel(){return this.config.getTranslation(Yu.ARIA).listLabel}get virtualScrollerDisabled(){return!this.virtualScroll}get optionValueSelected(){return typeof this.modelValue()=="string"&&this.optionValue}chipItemClass(e){return this._componentStyle.classes.chipItem({instance:this,i:e})}optionClass(e,i,r){return{"p-autocomplete-option":!0,"p-autocomplete-option-selected":this.isSelected(e),"p-focus":this.focusedOptionIndex()===this.getOptionIndex(i,r),"p-disabled":this.isOptionDisabled(e)}}constructor(e,i){super(),this.overlayService=e,this.zone=i,ku(()=>{this.filled=wn(this.modelValue())})}ngOnInit(){super.ngOnInit(),this.id=this.id||Uu("pn_id_"),this.cd.detectChanges()}templates;ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this._itemTemplate=e.template;break;case"group":this._groupTemplate=e.template;break;case"selecteditem":this._selectedItemTemplate=e.template;break;case"selectedItem":this._selectedItemTemplate=e.template;break;case"header":this._headerTemplate=e.template;break;case"empty":this._emptyTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"loader":this._loaderTemplate=e.template;break;case"removetokenicon":this._removeIconTemplate=e.template;break;case"loadingicon":this._loadingIconTemplate=e.template;break;case"clearicon":this._clearIconTemplate=e.template;break;case"dropdownicon":this._dropdownIconTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}ngAfterViewChecked(){this.suggestionsUpdated&&this.overlayViewChild&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1),this.suggestionsUpdated=!1})}handleSuggestionsChange(){if(this.loading){this._suggestions()?.length>0||this.showEmptyMessage||this.emptyTemplate?this.show():this.hide();let e=this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(e),this.suggestionsUpdated=!0,this.loading=!1,this.cd.markForCheck()}}flatOptions(e){return(e||[]).reduce((i,r,o)=>{i.push({optionGroup:r,group:!0,index:o});let s=this.getOptionGroupChildren(r);return s&&s.forEach(a=>i.push(a)),i},[])}isOptionGroup(e){return this.optionGroupLabel&&e.optionGroup&&e.group}findFirstOptionIndex(){return this.visibleOptions().findIndex(e=>this.isValidOption(e))}findLastOptionIndex(){return Qs(this.visibleOptions(),e=>this.isValidOption(e))}findFirstFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e}findLastFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e}findSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}findNextOptionIndex(e){let i=e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(r=>this.isValidOption(r)):-1;return i>-1?i+e+1:e}findPrevOptionIndex(e){let i=e>0?Qs(this.visibleOptions().slice(0,e),r=>this.isValidOption(r)):-1;return i>-1?i:e}isValidSelectedOption(e){return this.isValidOption(e)&&this.isSelected(e)}isValidOption(e){return e&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))}isOptionDisabled(e){return this.optionDisabled?Hi(e,this.optionDisabled):!1}isSelected(e){return this.multiple?this.unique?this.modelValue()?.find(i=>Js(i,this.getOptionValue(e),this.equalityKey())):!1:Js(this.modelValue(),this.getOptionValue(e),this.equalityKey())}isOptionMatched(e,i){return this.isValidOption(e)&&this.getOptionLabel(e).toLocaleLowerCase(this.searchLocale)===i.toLocaleLowerCase(this.searchLocale)}isInputClicked(e){return e.target===this.inputEL.nativeElement}isDropdownClicked(e){return this.dropdownButton?.nativeElement?e.target===this.dropdownButton.nativeElement||this.dropdownButton.nativeElement.contains(e.target):!1}equalityKey(){return this.dataKey}onContainerClick(e){this.disabled||this.loading||this.isInputClicked(e)||this.isDropdownClicked(e)||(!this.overlayViewChild||!this.overlayViewChild.overlayViewChild?.nativeElement.contains(e.target))&&ci(this.inputEL.nativeElement)}handleDropdownClick(e){let i;this.overlayVisible?this.hide(!0):(ci(this.inputEL.nativeElement),i=this.inputEL.nativeElement.value,this.dropdownMode==="blank"?this.search(e,"","dropdown"):this.dropdownMode==="current"&&this.search(e,i,"dropdown")),this.onDropdownClick.emit({originalEvent:e,query:i})}onInput(e){if(this.typeahead){this.searchTimeout&&clearTimeout(this.searchTimeout);let i=e.target.value;this.maxlength!==null&&(i=i.split("").slice(0,this.maxlength).join("")),!this.multiple&&!this.forceSelection&&this.updateModel(i),i.length===0&&!this.multiple?(this.onClear.emit(),setTimeout(()=>{this.hide()},this.delay/2)):i.length>=this.minLength?(this.focusedOptionIndex.set(-1),this.searchTimeout=setTimeout(()=>{this.search(e,i,"input")},this.delay)):this.hide()}}onInputChange(e){if(this.forceSelection){let i=!1;if(this.visibleOptions()){let r=this.visibleOptions().find(o=>this.isOptionMatched(o,this.inputEL.nativeElement.value||""));r!==void 0&&(i=!0,!this.isSelected(r)&&this.onOptionSelect(e,r))}i||(this.inputEL.nativeElement.value="",!this.multiple&&this.updateModel(null))}}onInputFocus(e){if(this.disabled)return;!this.dirty&&this.completeOnFocus&&this.search(e,e.target.value,"focus"),this.dirty=!0,this.focused=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(i),this.overlayVisible&&this.scrollInView(this.focusedOptionIndex()),this.onFocus.emit(e)}onMultipleContainerFocus(e){this.disabled||(this.focused=!0)}onMultipleContainerBlur(e){this.focusedMultipleOptionIndex.set(-1),this.focused=!1}onMultipleContainerKeyDown(e){if(this.disabled){e.preventDefault();return}switch(e.code){case"ArrowLeft":this.onArrowLeftKeyOnMultiple(e);break;case"ArrowRight":this.onArrowRightKeyOnMultiple(e);break;case"Backspace":this.onBackspaceKeyOnMultiple(e);break;default:break}}onInputBlur(e){this.dirty=!1,this.focused=!1,this.focusedOptionIndex.set(-1),this.onModelTouched(),this.onBlur.emit(e)}onInputPaste(e){this.onKeyDown(e)}onInputKeyUp(e){this.onKeyUp.emit(e)}onKeyDown(e){if(this.disabled){e.preventDefault();return}switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e);break;case"ShiftLeft":case"ShiftRight":break;default:break}}onArrowDownKey(e){if(!this.overlayVisible)return;let i=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,i),e.preventDefault(),e.stopPropagation()}onArrowUpKey(e){if(this.overlayVisible)if(e.altKey)this.focusedOptionIndex()!==-1&&this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]),this.overlayVisible&&this.hide(),e.preventDefault();else{let i=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,i),e.preventDefault(),e.stopPropagation()}}get hasFluid(){let i=this.el.nativeElement.closest("p-fluid");return this.fluid||!!i}onArrowLeftKey(e){let i=e.currentTarget;this.focusedOptionIndex.set(-1),this.multiple&&(Xu(i.value)&&this.hasSelectedOption()?(ci(this.multiContainerEL.nativeElement),this.focusedMultipleOptionIndex.set(this.modelValue().length)):e.stopPropagation())}onArrowRightKey(e){this.focusedOptionIndex.set(-1),this.multiple&&e.stopPropagation()}onHomeKey(e){let{currentTarget:i}=e,r=i.value.length;i.setSelectionRange(0,e.shiftKey?r:0),this.focusedOptionIndex.set(-1),e.preventDefault()}onEndKey(e){let{currentTarget:i}=e,r=i.value.length;i.setSelectionRange(e.shiftKey?0:r,r),this.focusedOptionIndex.set(-1),e.preventDefault()}onPageDownKey(e){this.scrollInView(this.visibleOptions().length-1),e.preventDefault()}onPageUpKey(e){this.scrollInView(0),e.preventDefault()}onEnterKey(e){this.typeahead||this.multiple&&(this.updateModel([...this.modelValue()||[],e.target.value]),this.inputEL.nativeElement.value=""),this.overlayVisible?(this.focusedOptionIndex()!==-1&&this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]),this.hide()):this.onArrowDownKey(e),e.preventDefault()}onEscapeKey(e){this.overlayVisible&&this.hide(!0),e.preventDefault()}onTabKey(e){this.focusedOptionIndex()!==-1&&this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]),this.overlayVisible&&this.hide()}onBackspaceKey(e){if(this.multiple){if(wn(this.modelValue())&&!this.inputEL.nativeElement.value){let i=this.modelValue()[this.modelValue().length-1],r=this.modelValue().slice(0,-1);this.updateModel(r),this.onUnselect.emit({originalEvent:e,value:i})}e.stopPropagation()}!this.multiple&&this.showClear&&this.findSelectedOptionIndex()!=-1&&this.clear()}onArrowLeftKeyOnMultiple(e){let i=this.focusedMultipleOptionIndex()<1?0:this.focusedMultipleOptionIndex()-1;this.focusedMultipleOptionIndex.set(i)}onArrowRightKeyOnMultiple(e){let i=this.focusedMultipleOptionIndex();i++,this.focusedMultipleOptionIndex.set(i),i>this.modelValue().length-1&&(this.focusedMultipleOptionIndex.set(-1),ci(this.inputEL.nativeElement))}onBackspaceKeyOnMultiple(e){this.focusedMultipleOptionIndex()!==-1&&this.removeOption(e,this.focusedMultipleOptionIndex())}onOptionSelect(e,i,r=!0){let o=this.getOptionValue(i);this.multiple?(this.inputEL.nativeElement.value="",this.isSelected(i)||this.updateModel([...this.modelValue()||[],o])):this.updateModel(o),this.onSelect.emit({originalEvent:e,value:i}),r&&this.hide(!0)}onOptionMouseEnter(e,i){this.focusOnHover&&this.changeFocusedOptionIndex(e,i)}search(e,i,r){i!=null&&(r==="input"&&i.trim().length===0||(this.loading=!0,this.completeMethod.emit({originalEvent:e,query:i})))}removeOption(e,i){e.stopPropagation();let r=this.modelValue()[i],o=this.modelValue().filter((s,a)=>a!==i).map(s=>this.getOptionValue(s));this.updateModel(o),this.onUnselect.emit({originalEvent:e,value:r}),ci(this.inputEL.nativeElement)}updateModel(e){this.value=e,this.modelValue.set(e),this.onModelChange(e),this.updateInputValue(),this.cd.markForCheck()}updateInputValue(){this.inputEL&&this.inputEL.nativeElement&&(this.multiple?this.inputEL.nativeElement.value="":this.inputEL.nativeElement.value=this.inputValue())}autoUpdateModel(){if((this.selectOnFocus||this.autoHighlight)&&this.autoOptionFocus&&!this.hasSelectedOption()){let e=this.findFirstFocusedOptionIndex();this.focusedOptionIndex.set(e),this.onOptionSelect(null,this.visibleOptions()[this.focusedOptionIndex()],!1)}}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedOptionId;if(this.itemsViewChild&&this.itemsViewChild.nativeElement){let r=xo(this.itemsViewChild.nativeElement,`li[id="${i}"]`);r?r.scrollIntoView&&r.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||setTimeout(()=>{this.virtualScroll&&this.scroller?.scrollToIndex(e!==-1?e:this.focusedOptionIndex())},0)}}changeFocusedOptionIndex(e,i){this.focusedOptionIndex()!==i&&(this.focusedOptionIndex.set(i),this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(e,this.visibleOptions()[i],!1))}show(e=!1){this.dirty=!0,this.overlayVisible=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(i),e&&ci(this.inputEL.nativeElement),e&&ci(this.inputEL.nativeElement),this.onShow.emit(),this.cd.markForCheck()}hide(e=!1){let i=()=>{this.dirty=e,this.overlayVisible=!1,this.focusedOptionIndex.set(-1),e&&ci(this.inputEL.nativeElement),this.onHide.emit(),this.cd.markForCheck()};setTimeout(()=>{i()},0)}clear(){this.updateModel(null),this.inputEL.nativeElement.value="",this.onClear.emit()}writeValue(e){this.value=e,this.modelValue.set(e),this.updateInputValue(),this.cd.markForCheck()}hasSelectedOption(){return wn(this.modelValue())}getAriaPosInset(e){return(this.optionGroupLabel?e-this.visibleOptions().slice(0,e).filter(i=>this.isOptionGroup(i)).length:e)+1}getOptionLabel(e){return this.field||this.optionLabel?Hi(e,this.field||this.optionLabel):e&&e.label!=null?e.label:e}getOptionValue(e){return this.optionValue?Hi(e,this.optionValue):e&&e.value!=null?e.value:e}getOptionIndex(e,i){return this.virtualScrollerDisabled?e:i&&i.getItemOptions(e).index}getOptionGroupLabel(e){return this.optionGroupLabel?Hi(e,this.optionGroupLabel):e&&e.label!=null?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?Hi(e,this.optionGroupChildren):e.items}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onOverlayAnimationStart(e){if(e.toState==="visible"&&(this.itemsWrapper=xo(this.overlayViewChild.overlayViewChild?.nativeElement,this.virtualScroll?".p-scroller":".p-autocomplete-panel"),this.virtualScroll&&(this.scroller?.setContentEl(this.itemsViewChild?.nativeElement),this.scroller.viewInit()),this.visibleOptions()&&this.visibleOptions().length))if(this.virtualScroll){let i=this.modelValue()?this.focusedOptionIndex():-1;i!==-1&&this.scroller?.scrollToIndex(i)}else{let i=xo(this.itemsWrapper,".p-autocomplete-item.p-highlight");i&&i.scrollIntoView({block:"nearest",inline:"center"})}}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),super.ngOnDestroy()}static \u0275fac=function(i){return new(i||n)(qs(Ku),qs(Au))};static \u0275cmp=En({type:n,selectors:[["p-autoComplete"],["p-autocomplete"],["p-auto-complete"]],contentQueries:function(i,r,o){if(i&1&&(le(o,vm,5),le(o,Sm,5),le(o,Tm,5),le(o,Im,5),le(o,bm,5),le(o,Rm,5),le(o,Am,5),le(o,Mm,5),le(o,Lm,5),le(o,Om,5),le(o,Dm,5),le(o,Bu,4)),i&2){let s;vt(s=St())&&(r.itemTemplate=s.first),vt(s=St())&&(r.emptyTemplate=s.first),vt(s=St())&&(r.headerTemplate=s.first),vt(s=St())&&(r.footerTemplate=s.first),vt(s=St())&&(r.selectedItemTemplate=s.first),vt(s=St())&&(r.groupTemplate=s.first),vt(s=St())&&(r.loaderTemplate=s.first),vt(s=St())&&(r.removeIconTemplate=s.first),vt(s=St())&&(r.loadingIconTemplate=s.first),vt(s=St())&&(r.clearIconTemplate=s.first),vt(s=St())&&(r.dropdownIconTemplate=s.first),vt(s=St())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(li(Pm,5),li(Fm,5),li(km,5),li(Nm,5),li(Gm,5),li(zm,5),li(Vm,5),li(Wm,5)),i&2){let o;vt(o=St())&&(r.containerEL=o.first),vt(o=St())&&(r.inputEL=o.first),vt(o=St())&&(r.multiInputEl=o.first),vt(o=St())&&(r.multiContainerEL=o.first),vt(o=St())&&(r.dropdownButton=o.first),vt(o=St())&&(r.itemsViewChild=o.first),vt(o=St())&&(r.scroller=o.first),vt(o=St())&&(r.overlayViewChild=o.first)}},inputs:{minLength:[2,"minLength","minLength",qi],delay:[2,"delay","delay",qi],style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",inputStyle:"inputStyle",inputId:"inputId",inputStyleClass:"inputStyleClass",placeholder:"placeholder",readonly:[2,"readonly","readonly",gt],disabled:[2,"disabled","disabled",gt],scrollHeight:"scrollHeight",lazy:[2,"lazy","lazy",gt],virtualScroll:[2,"virtualScroll","virtualScroll",gt],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",qi],virtualScrollOptions:"virtualScrollOptions",maxlength:[2,"maxlength","maxlength",e=>qi(e,null)],name:"name",required:[2,"required","required",gt],size:"size",appendTo:"appendTo",autoHighlight:[2,"autoHighlight","autoHighlight",gt],forceSelection:[2,"forceSelection","forceSelection",gt],type:"type",autoZIndex:[2,"autoZIndex","autoZIndex",gt],baseZIndex:[2,"baseZIndex","baseZIndex",qi],ariaLabel:"ariaLabel",dropdownAriaLabel:"dropdownAriaLabel",ariaLabelledBy:"ariaLabelledBy",dropdownIcon:"dropdownIcon",unique:[2,"unique","unique",gt],group:[2,"group","group",gt],completeOnFocus:[2,"completeOnFocus","completeOnFocus",gt],showClear:[2,"showClear","showClear",gt],field:"field",dropdown:[2,"dropdown","dropdown",gt],showEmptyMessage:[2,"showEmptyMessage","showEmptyMessage",gt],dropdownMode:"dropdownMode",multiple:[2,"multiple","multiple",gt],tabindex:[2,"tabindex","tabindex",qi],dataKey:"dataKey",emptyMessage:"emptyMessage",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autofocus:[2,"autofocus","autofocus",gt],autocomplete:"autocomplete",optionGroupChildren:"optionGroupChildren",optionGroupLabel:"optionGroupLabel",overlayOptions:"overlayOptions",suggestions:"suggestions",itemSize:"itemSize",optionLabel:"optionLabel",optionValue:"optionValue",id:"id",searchMessage:"searchMessage",emptySelectionMessage:"emptySelectionMessage",selectionMessage:"selectionMessage",autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",gt],selectOnFocus:[2,"selectOnFocus","selectOnFocus",gt],searchLocale:[2,"searchLocale","searchLocale",gt],optionDisabled:"optionDisabled",focusOnHover:[2,"focusOnHover","focusOnHover",gt],typeahead:[2,"typeahead","typeahead",gt],variant:"variant",fluid:[2,"fluid","fluid",gt]},outputs:{completeMethod:"completeMethod",onSelect:"onSelect",onUnselect:"onUnselect",onFocus:"onFocus",onBlur:"onBlur",onDropdownClick:"onDropdownClick",onClear:"onClear",onKeyUp:"onKeyUp",onShow:"onShow",onHide:"onHide",onLazyLoad:"onLazyLoad"},features:[fo([Kg,zh]),Lu],decls:11,vars:15,consts:[["container",""],["overlay",""],["content",""],["focusInput",""],["multiContainer",""],["token",""],["removeicon",""],["ddBtn",""],["buildInItems",""],["scroller",""],["loader",""],["items",""],["empty",""],[2,"position","relative",3,"click","ngClass","ngStyle"],["pInputText","","aria-autocomplete","list","role","combobox",3,"pAutoFocus","ngClass","ngStyle","class","type","variant","autocomplete","required","name","pSize","tabindex","readonly","disabled","fluid","input","keydown","change","focus","blur","paste","keyup",4,"ngIf"],[4,"ngIf"],["role","listbox",3,"ngClass","tabindex","focus","blur","keydown",4,"ngIf"],["type","button","class","p-autocomplete-dropdown","pRipple","",3,"disabled","click",4,"ngIf"],[3,"visibleChange","onAnimationStart","onHide","visible","options","target","appendTo","showTransitionOptions","hideTransitionOptions"],["pInputText","","aria-autocomplete","list","role","combobox",3,"input","keydown","change","focus","blur","paste","keyup","pAutoFocus","ngClass","ngStyle","type","variant","autocomplete","required","name","pSize","tabindex","readonly","disabled","fluid"],[3,"styleClass","click",4,"ngIf"],["class","p-autocomplete-clear-icon",3,"click",4,"ngIf"],[3,"click","styleClass"],[1,"p-autocomplete-clear-icon",3,"click"],[4,"ngTemplateOutlet"],["role","listbox",3,"focus","blur","keydown","ngClass","tabindex"],["role","option",3,"ngClass",4,"ngFor","ngForOf"],["role","option",1,"p-autocomplete-input-chip"],["role","combobox","aria-autocomplete","list",3,"input","keydown","change","focus","blur","paste","keyup","pAutoFocus","ngClass","ngStyle","autocomplete","required","tabindex","readonly","disabled"],["role","option",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["styleClass","p-autocomplete-chip",3,"label","removable",4,"ngIf"],["styleClass","p-autocomplete-chip",3,"label","removable"],[1,"p-autocomplete-chip-icon",3,"click"],[3,"styleClass"],[3,"styleClass","spin",4,"ngIf"],["class","p-autocomplete-loader pi-spin ",4,"ngIf"],[3,"styleClass","spin"],[1,"p-autocomplete-loader","pi-spin"],["type","button","pRipple","",1,"p-autocomplete-dropdown",3,"click","disabled"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","ngStyle"],[1,"p-autocomplete-list-container"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],["role","status","aria-live","polite",1,"p-hidden-accessible"],[3,"onLazyLoad","items","itemSize","autoSize","lazy","options"],["role","listbox",1,"p-autocomplete-list",3,"ngClass"],["ngFor","",3,"ngForOf"],["class","p-autocomplete-empty-message","role","option",3,"ngStyle",4,"ngIf"],["role","option",1,"p-autocomplete-option-group",3,"ngStyle"],["pRipple","","role","option",3,"click","mouseenter","ngStyle","ngClass"],["role","option",1,"p-autocomplete-empty-message",3,"ngStyle"],[4,"ngIf","ngIfElse"]],template:function(i,r){if(i&1){let o=ae();R(0,"div",13,0),pt("click",function(a){return et(o),it(r.onContainerClick(a))}),nt(2,jm,2,25,"input",14)(3,Jm,3,2,"ng-container",15)(4,ag,6,26,"ul",16)(5,dg,3,2,"ng-container",15)(6,xg,4,5,"button",17),R(7,"p-overlay",18,1),ho("visibleChange",function(a){return et(o),uo(r.overlayVisible,a)||(r.overlayVisible=a),it(a)}),pt("onAnimationStart",function(a){return et(o),it(r.onOverlayAnimationStart(a))})("onHide",function(){return et(o),it(r.hide())}),nt(9,Vg,10,11,"ng-template",null,2,Me),O()()}i&2&&(mr(r.styleClass),M("ngClass",r.rootClass)("ngStyle",r.style),A(2),M("ngIf",!r.multiple),A(),M("ngIf",r.filled&&!r.disabled&&r.showClear&&!r.loading),A(),M("ngIf",r.multiple),A(),M("ngIf",r.loading),A(),M("ngIf",r.dropdown),A(),co("visible",r.overlayVisible),M("options",r.overlayOptions)("target","@parent")("appendTo",r.appendTo)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions))},dependencies:[Cn,mo,go,_o,Gu,Nu,gh,vn,hh,_h,sh,uh,lh,ch,ah,vh,ta],encapsulation:2,changeDetection:0})}return n})(),Xh=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Mu({type:n});static \u0275inj=bu({imports:[To,ta]})}return n})();var Ft={ADD:"add",REMOVE:"remove"};var De={PROPERTYCHANGE:"propertychange"};var P={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};var ia=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},bi=ia;function Uh(n,t,e){let i,r;e=e||Jt;let o=0,s=n.length,a=!1;for(;o<s;)i=o+(s-o>>1),r=+e(n[i],t),r<0?o=i+1:(s=i,a=!r);return a?o:~o}function Jt(n,t){return n>t?1:n<t?-1:0}function Kh(n,t){return n<t?1:n>t?-1:0}function Sn(n,t,e){if(n[0]<=t)return 0;let i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let r=1;r<i;++r){let o=n[r];if(o===t)return r;if(o<t)return e(t,n[r-1],o)>0?r-1:r}return i-1}if(e>0){for(let r=1;r<i;++r)if(n[r]<t)return r-1;return i-1}if(e<0){for(let r=1;r<i;++r)if(n[r]<=t)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return i-1}function Bh(n,t,e){for(;t<e;){let i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function Tn(n,t){let e=Array.isArray(t)?t:[t],i=e.length;for(let r=0;r<i;r++)n[n.length]=e[r]}function Ut(n,t){let e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function Yh(n,t,e){let i=t||Jt;return n.every(function(r,o){if(o===0)return!0;let s=i(n[o-1],r);return!(s>0||e&&s===0)})}function Ce(){return!0}function ui(){return!1}function hi(){}function Io(n){let t,e,i;return function(){let r=Array.prototype.slice.call(arguments);return(!e||this!==i||!Ut(r,e))&&(i=this,e=r,t=n.apply(this,arguments)),t}}function jh(n){function t(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function je(n){for(let t in n)delete n[t]}function Pe(n){let t;for(t in n)return!1;return!t}var na=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var Rt=na;var ra=class extends bi{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;let i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){let e=typeof t=="string",i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;let o=e?new Rt(t):t;o.target||(o.target=this.eventTarget_||this);let s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in s||(s[i]=0,a[i]=0),++s[i];let l;for(let c=0,u=r.length;c<u;++c)if("handleEvent"in r[c]?l=r[c].handleEvent(o):l=r[c].call(this,o),l===!1||o.propagationStopped){l=!1;break}if(--s[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,hi);delete s[i]}return l}disposeInternal(){this.listeners_&&je(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;let i=this.listeners_[t];if(!i)return;let r=i.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=hi,++this.pendingRemovals_[t]):(i.splice(r,1),i.length===0&&delete this.listeners_[t]))}},Ri=ra;function Z(n,t,e,i,r){if(r){let s=e;e=function(a){return n.removeEventListener(t,e),s.call(i??this,a)}}else i&&i!==n&&(e=e.bind(i));let o={target:n,type:t,listener:e};return n.addEventListener(t,e),o}function In(n,t,e,i){return Z(n,t,e,i,!0)}function st(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),je(n))}var bn=class extends Ri{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(P.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){let i=t.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=Z(this,t[o],e);return r}return Z(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){let r=t.length;i=new Array(r);for(let o=0;o<r;++o)i[o]=In(this,t[o],e)}else i=In(this,t,e);return e.ol_key=i,i}unInternal(t,e){let i=e.ol_key;if(i)Yg(i);else if(Array.isArray(t))for(let r=0,o=t.length;r<o;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}};bn.prototype.on;bn.prototype.once;bn.prototype.un;function Yg(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)st(n[t]);else st(n)}var bo=bn;function J(){throw new Error("Unimplemented abstract method.")}var jg=0;function B(n){return n.ol_uid||(n.ol_uid=String(++jg))}var Ro=class extends Rt{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}},oa=class extends bo{constructor(t){super(),this.on,this.once,this.un,B(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Ro(i,t,e)),i=De.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Ro(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){let r=this.values_||(this.values_={});if(i)r[t]=e;else{let o=r[t];r[t]=e,o!==e&&this.notify(t,o)}}setProperties(t,e){for(let i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){let i=this.values_[t];delete this.values_[t],Pe(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},At=oa;var Zh={LENGTH:"length"},Rn=class extends Rt{constructor(t,e,i){super(t),this.element=e,this.index=i}},sa=class extends At{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){let e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Zh.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Rn(Ft.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);let e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){let e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;let e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Rn(Ft.REMOVE,e,t)),e}setAt(t,e){let i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);let r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Rn(Ft.REMOVE,r,t)),this.dispatchEvent(new Rn(Ft.ADD,e,t))}updateLength_(){this.set(Zh.LENGTH,this.array_.length)}assertUnique_(t,e){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},Tt=sa;var aa=class extends Rt{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}},Ai=aa;var la=class extends Ai{constructor(t,e,i,r,o,s){super(t,e,o),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Ze=la;var dt={SINGLECLICK:"singleclick",CLICK:P.CLICK,DBLCLICK:P.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var $i=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Zg=$i.includes("safari")&&!$i.includes("chrom"),Xy=Zg&&($i.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test($i)),qh=$i.includes("webkit")&&!$i.includes("edge"),ca=$i.includes("macintosh"),Hh=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ao=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,ua=typeof Image<"u"&&Image.prototype.decode;var Mo=function(){let n=!1;try{let t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n}();var xr={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var ha=class extends Ri{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;let i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=Z(i,xr.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Z(i,xr.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(P.TOUCHMOVE,this.boundHandleTouchMove_,Mo?{passive:!1}:!1)}emulateClick_(t){let e=new Ze(dt.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Ze(dt.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let i=new Ze(dt.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){let e=t,i=e.pointerId;if(e.type==dt.POINTERUP||e.type==dt.POINTERCANCEL){delete this.trackedTouches_[i];for(let r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==dt.POINTERDOWN||e.type==dt.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);let e=new Ze(dt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(st),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);let e=new Ze(dt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){let i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Z(i,dt.POINTERMOVE,this.handlePointerMove_,this),Z(i,dt.POINTERUP,this.handlePointerUp_,this),Z(this.element_,dt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(Z(this.element_.getRootNode(),dt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;let e=new Ze(dt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;let e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new Ze(dt.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){let e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(st(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(P.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(st(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(st),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},$h=ha;var qe={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"};var Gt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var k={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function j(n,t){if(!n)throw new Error(t)}var yr=1/0,da=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,je(this.queuedElements_)}dequeue(){let t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));let r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){j(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let e=this.priorityFunction_(t);return e!=yr?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){let e=this.elements_,i=this.priorities_,r=e.length,o=e[t],s=i[t],a=t;for(;t<r>>1;){let l=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),u=c<r&&i[c]<i[l]?c:l;e[t]=e[u],i[t]=i[u],t=u}e[t]=o,i[t]=s,this.siftDown_(a,t)}siftDown_(t,e){let i=this.elements_,r=this.priorities_,o=i[e],s=r[e];for(;e>t;){let a=this.getParentIndex_(e);if(r[a]>s)i[e]=i[a],r[e]=r[a],e=a;else break}i[e]=o,r[e]=s}reprioritize(){let t=this.priorityFunction_,e=this.elements_,i=this.priorities_,r=0,o=e.length,s,a,l;for(a=0;a<o;++a)s=e[a],l=t(s),l==yr?delete this.queuedElements_[this.keyFunction_(s)]:(i[r]=l,e[r++]=s);e.length=r,i.length=r,this.heapify_()}},Jh=da;var fa=class extends Jh{constructor(t,e){super(i=>t.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){let e=super.enqueue(t);return e&&t[0].addEventListener(P.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){let e=t.target,i=e.getState();if(i===k.LOADED||i===k.ERROR||i===k.EMPTY){i!==k.ERROR&&e.removeEventListener(P.CHANGE,this.boundHandleTileChange_);let r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){let r=this.dequeue()[0],o=r.getKey();r.getState()===k.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++i,r.load())}}},Qh=fa;function td(n,t,e,i,r){if(!n||!(e in n.wantedTiles))return yr;if(!n.wantedTiles[e][t.getKey()])return yr;let o=n.viewState.center,s=i[0]-o[0],a=i[1]-o[1];return 65536*Math.log(r)+Math.sqrt(s*s+a*a)/r}var Ot={ANIMATING:0,INTERACTING:1};var we={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function at(n,t,e){return Math.min(Math.max(n,t),e)}function ed(n,t,e,i,r,o){let s=r-e,a=o-i;if(s!==0||a!==0){let l=((n-e)*s+(t-i)*a)/(s*s+a*a);l>1?(e=r,i=o):l>0&&(e+=s*l,i+=a*l)}return di(n,t,e,i)}function di(n,t,e,i){let r=e-n,o=i-t;return r*r+o*o}function id(n){let t=n.length;for(let i=0;i<t;i++){let r=i,o=Math.abs(n[i][i]);for(let a=i+1;a<t;a++){let l=Math.abs(n[a][i]);l>o&&(o=l,r=a)}if(o===0)return null;let s=n[r];n[r]=n[i],n[i]=s;for(let a=i+1;a<t;a++){let l=-n[a][i]/n[i][i];for(let c=i;c<t+1;c++)i==c?n[a][c]=0:n[a][c]+=l*n[i][c]}}let e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=n[i][t]/n[i][i];for(let r=i-1;r>=0;r--)n[r][t]-=n[r][i]*e[i]}return e}function Lo(n){return n*180/Math.PI}function Fe(n){return n*Math.PI/180}function ke(n,t){let e=n%t;return e*t<0?e+t:e}function Kt(n,t,e){return n+e*(t-n)}function An(n,t){let e=Math.pow(10,t);return Math.round(n*e)/e}function Er(n,t){return Math.floor(An(n,t))}function Cr(n,t){return Math.ceil(An(n,t))}function Oo(n,t,e){if(n>=t&&n<e)return n;let i=e-t;return((n-t)%i+i)%i+t}function pa(n,t,e){return function(i,r,o,s,a){if(!i)return;if(!r&&!t)return i;let l=t?0:o[0]*r,c=t?0:o[1]*r,u=a?a[0]:0,h=a?a[1]:0,d=n[0]+l/2+u,f=n[2]-l/2+u,p=n[1]+c/2+h,g=n[3]-c/2+h;d>f&&(d=(f+d)/2,f=d),p>g&&(p=(g+p)/2,g=p);let m=at(i[0],d,f),_=at(i[1],p,g);if(s&&e&&r){let x=30*r;m+=-x*Math.log(1+Math.max(0,d-i[0])/x)+x*Math.log(1+Math.max(0,i[0]-f)/x),_+=-x*Math.log(1+Math.max(0,p-i[1])/x)+x*Math.log(1+Math.max(0,i[1]-g)/x)}return[m,_]}}function nd(n){return n}var Mt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ma(n){let t=It();for(let e=0,i=n.length;e<i;++e)tn(t,n[e]);return t}function qg(n,t,e){let i=Math.min.apply(null,n),r=Math.min.apply(null,t),o=Math.max.apply(null,n),s=Math.max.apply(null,t);return ce(i,r,o,s,e)}function Mn(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function Po(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function Fo(n,t,e){let i,r;return t<n[0]?i=n[0]-t:n[2]<t?i=t-n[2]:i=0,e<n[1]?r=n[1]-e:n[3]<e?r=e-n[3]:r=0,i*i+r*r}function Ne(n,t){return ga(n,t[0],t[1])}function Ji(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function ga(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Do(n,t){let e=n[0],i=n[1],r=n[2],o=n[3],s=t[0],a=t[1],l=Mt.UNKNOWN;return s<e?l=l|Mt.LEFT:s>r&&(l=l|Mt.RIGHT),a<i?l=l|Mt.BELOW:a>o&&(l=l|Mt.ABOVE),l===Mt.UNKNOWN&&(l=Mt.INTERSECTING),l}function It(){return[1/0,1/0,-1/0,-1/0]}function ce(n,t,e,i,r){return r?(r[0]=n,r[1]=t,r[2]=e,r[3]=i,r):[n,t,e,i]}function Qi(n){return ce(1/0,1/0,-1/0,-1/0,n)}function ko(n,t){let e=n[0],i=n[1];return ce(e,i,e,i,t)}function Ln(n,t,e,i,r){let o=Qi(r);return _a(o,n,t,e,i)}function fi(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function rd(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function tn(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function _a(n,t,e,i,r){for(;e<i;e+=r)Hg(n,t[e],t[e+1]);return n}function Hg(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function No(n,t){let e;return e=t(On(n)),e||(e=t(Dn(n)),e)||(e=t(Pn(n)),e)||(e=t(Se(n)),e)?e:!1}function wr(n){let t=0;return Mi(n)||(t=H(n)*mt(n)),t}function On(n){return[n[0],n[1]]}function Dn(n){return[n[2],n[1]]}function ve(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function od(n,t){let e;if(t==="bottom-left")e=On(n);else if(t==="bottom-right")e=Dn(n);else if(t==="top-left")e=Se(n);else if(t==="top-right")e=Pn(n);else throw new Error("Invalid corner");return e}function vr(n,t,e,i,r){let[o,s,a,l,c,u,h,d]=xa(n,t,e,i);return ce(Math.min(o,a,c,h),Math.min(s,l,u,d),Math.max(o,a,c,h),Math.max(s,l,u,d),r)}function xa(n,t,e,i){let r=t*i[0]/2,o=t*i[1]/2,s=Math.cos(e),a=Math.sin(e),l=r*s,c=r*a,u=o*s,h=o*a,d=n[0],f=n[1];return[d-l+h,f-c-u,d-l-h,f-c+u,d+l-h,f+c+u,d+l+h,f+c-u,d-l+h,f-c-u]}function mt(n){return n[3]-n[1]}function He(n,t,e){let i=e||It();return _t(n,t)?(n[0]>t[0]?i[0]=n[0]:i[0]=t[0],n[1]>t[1]?i[1]=n[1]:i[1]=t[1],n[2]<t[2]?i[2]=n[2]:i[2]=t[2],n[3]<t[3]?i[3]=n[3]:i[3]=t[3]):Qi(i),i}function Se(n){return[n[0],n[3]]}function Pn(n){return[n[2],n[3]]}function H(n){return n[2]-n[0]}function _t(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function Mi(n){return n[2]<n[0]||n[3]<n[1]}function sd(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function ad(n,t,e){let i=!1,r=Do(n,t),o=Do(n,e);if(r===Mt.INTERSECTING||o===Mt.INTERSECTING)i=!0;else{let s=n[0],a=n[1],l=n[2],c=n[3],u=t[0],h=t[1],d=e[0],f=e[1],p=(f-h)/(d-u),g,m;o&Mt.ABOVE&&!(r&Mt.ABOVE)&&(g=d-(f-c)/p,i=g>=s&&g<=l),!i&&o&Mt.RIGHT&&!(r&Mt.RIGHT)&&(m=f-(d-l)*p,i=m>=a&&m<=c),!i&&o&Mt.BELOW&&!(r&Mt.BELOW)&&(g=d-(f-a)/p,i=g>=s&&g<=l),!i&&o&Mt.LEFT&&!(r&Mt.LEFT)&&(m=f-(d-s)*p,i=m>=a&&m<=c)}return i}function ld(n,t,e,i){if(Mi(n))return Qi(e);let r=[];if(i>1){let a=n[2]-n[0],l=n[3]-n[1];for(let c=0;c<i;++c)r.push(n[0]+a*c/i,n[1],n[2],n[1]+l*c/i,n[2]-a*c/i,n[3],n[0],n[3]-l*c/i)}else r=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];t(r,r,2);let o=[],s=[];for(let a=0,l=r.length;a<l;a+=2)o.push(r[a]),s.push(r[a+1]);return qg(o,s,e)}function ya(n,t){let e=t.getExtent(),i=ve(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){let r=H(e),s=Math.floor((i[0]-e[0])/r)*r;n[0]-=s,n[2]-=s}return n}function Go(n,t,e){if(t.canWrapX()){let i=t.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];ya(n,t);let r=H(i);if(H(n)>r&&!e)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function cd(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function en(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function Fn(n,t){let e=Math.cos(t),i=Math.sin(t),r=n[0]*e-n[1]*i,o=n[1]*e+n[0]*i;return n[0]=r,n[1]=o,n}function ud(n,t){return n[0]*=t,n[1]*=t,n}function zo(n,t){if(t.canWrapX()){let e=H(t.getExtent()),i=hd(n,t,e);i&&(n[0]-=i*e)}return n}function hd(n,t,e){let i=t.getExtent(),r=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||H(i),r=Math.floor((n[0]-i[0])/e)),r}function Ea(n){return Math.pow(n,3)}function Te(n){return 1-Ea(1-n)}function dd(n){return 3*n*n-2*n*n*n}function fd(n){return n}var $g=63710088e-1;function Ca(n,t,e){e=e||$g;let i=Fe(n[1]),r=Fe(t[1]),o=(r-i)/2,s=Fe(t[0]-n[0])/2,a=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}var pd={info:1,warn:2,error:3,none:4},Jg=pd.info;function Vo(...n){Jg>pd.warn||console.warn(...n)}var pi={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var wa=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||pi[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},kn=wa;var Sr=6378137,Nn=Math.PI*Sr,Qg=[-Nn,-Nn,Nn,Nn],t_=[-180,-85,180,85],Wo=Sr*Math.log(Math.tan(Math.PI/2)),Li=class extends kn{constructor(t){super({code:t,units:"m",extent:Qg,global:!0,worldExtent:t_,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Sr)}})}},va=[new Li("EPSG:3857"),new Li("EPSG:102100"),new Li("EPSG:102113"),new Li("EPSG:900913"),new Li("http://www.opengis.net/def/crs/EPSG/0/3857"),new Li("http://www.opengis.net/gml/srs/epsg.xml#3857")];function md(n,t,e,i){let r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let o=0;o<r;o+=i){t[o]=Nn*n[o]/180;let s=Sr*Math.log(Math.tan(Math.PI*(+n[o+1]+90)/360));s>Wo?s=Wo:s<-Wo&&(s=-Wo),t[o+1]=s}return t}function gd(n,t,e,i){let r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let o=0;o<r;o+=i)t[o]=180*n[o]/Nn,t[o+1]=360*Math.atan(Math.exp(n[o+1]/Sr))/Math.PI-90;return t}var e_=6378137,_d=[-180,-90,180,90],i_=Math.PI*e_/180,mi=class extends kn{constructor(t,e){super({code:t,units:"degrees",extent:_d,axisOrientation:e,global:!0,metersPerUnit:i_,worldExtent:_d})}},Sa=[new mi("CRS:84"),new mi("EPSG:4326","neu"),new mi("urn:ogc:def:crs:OGC:1.3:CRS84"),new mi("urn:ogc:def:crs:OGC:2:84"),new mi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new mi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new mi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var Ta={};function xd(n){return Ta[n]||Ta[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function yd(n,t){Ta[n]=t}var Gn={};function zn(n,t,e){let i=n.getCode(),r=t.getCode();i in Gn||(Gn[i]={}),Gn[i][r]=e}function Xo(n,t){return n in Gn&&t in Gn[n]?Gn[n][t]:null}var Uo=.9996,Ie=.00669438,Bo=Ie*Ie,Yo=Bo*Ie,nn=Ie/(1-Ie),Ed=Math.sqrt(1-Ie),Vn=(1-Ed)/(1+Ed),Sd=Vn*Vn,Ia=Sd*Vn,ba=Ia*Vn,Td=ba*Vn,Id=1-Ie/4-3*Bo/64-5*Yo/256,n_=3*Ie/8+3*Bo/32+45*Yo/1024,r_=15*Bo/256+45*Yo/1024,o_=35*Yo/3072,s_=3/2*Vn-27/32*Ia+269/512*Td,a_=21/16*Sd-55/32*ba,l_=151/96*Ia-417/128*Td,c_=1097/512*ba,Ko=6378137;function u_(n,t,e){let i=n-5e5,s=(e.north?t:t-1e7)/Uo/(Ko*Id),a=s+s_*Math.sin(2*s)+a_*Math.sin(4*s)+l_*Math.sin(6*s)+c_*Math.sin(8*s),l=Math.sin(a),c=l*l,u=Math.cos(a),h=l/u,d=h*h,f=d*d,p=1-Ie*c,g=Math.sqrt(1-Ie*c),m=Ko/g,_=(1-Ie)/p,x=nn*u**2,C=x*x,y=i/(m*Uo),E=y*y,v=E*y,T=v*y,S=T*y,I=S*y,D=a-h/_*(E/2-T/24*(5+3*d+10*x-4*C-9*nn))+I/720*(61+90*d+298*x+45*f-252*nn-3*C),K=(y-v/6*(1+2*d+x)+S/120*(5-2*x+28*d-3*C+8*nn+24*f))/u;return K=Oo(K+Fe(bd(e.number)),-Math.PI,Math.PI),[Lo(K),Lo(D)]}var Cd=-80,wd=84,h_=-180,d_=180;function f_(n,t,e){n=Oo(n,h_,d_),t<Cd?t=Cd:t>wd&&(t=wd);let i=Fe(t),r=Math.sin(i),o=Math.cos(i),s=r/o,a=s*s,l=a*a,c=Fe(n),u=bd(e.number),h=Fe(u),d=Ko/Math.sqrt(1-Ie*r**2),f=nn*o**2,p=o*Oo(c-h,-Math.PI,Math.PI),g=p*p,m=g*p,_=m*p,x=_*p,C=x*p,y=Ko*(Id*i-n_*Math.sin(2*i)+r_*Math.sin(4*i)-o_*Math.sin(6*i)),E=Uo*d*(p+m/6*(1-a+f)+x/120*(5-18*a+l+72*f-58*nn))+5e5,v=Uo*(y+d*s*(g/2+_/24*(5-a+9*f+4*f**2)+C/720*(61-58*a+l+600*f-330*nn)));return e.north||(v+=1e7),[E,v]}function bd(n){return(n-1)*6-180+3}var p_=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Rd(n){let t=0;for(let r of p_){let o=n.match(r);if(o){t=parseInt(o[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function vd(n,t){return function(e,i,r,o){let s=e.length;r=r>1?r:2,o=o??r,i||(r>2?i=e.slice():i=new Array(s));for(let a=0;a<s;a+=o){let l=e[a],c=e[a+1],u=n(l,c,t);i[a]=u[0],i[a+1]=u[1]}return i}}function Ad(n){return Rd(n)?new kn({code:n,units:"m"}):null}function Md(n){let t=Rd(n.getCode());return t?{forward:vd(f_,t),inverse:vd(u_,t)}:null}var m_=[Md],g_=[Ad];var Aa=!0;function La(n){Aa=!(n===void 0?!0:n)}function Oa(n,t){if(t!==void 0){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];t=t}else t=n.slice();return t}function Ma(n){yd(n.getCode(),n),zn(n,n,Oa)}function __(n){n.forEach(Ma)}function Lt(n){if(typeof n!="string")return n;let t=xd(n);if(t)return t;for(let e of g_){let i=e(n);if(i)return i}return null}function Da(n,t,e,i){n=Lt(n);let r,o=n.getPointResolutionFunc();if(o){if(r=o(t,e),i&&i!==n.getUnits()){let s=n.getMetersPerUnit();s&&(r=r*s/pi[i])}}else{let s=n.getUnits();if(s=="degrees"&&!i||i=="degrees")r=t;else{let a=rn(n,Lt("EPSG:4326"));if(!a&&s!=="degrees")r=t*n.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);let u=Ca(c.slice(0,2),c.slice(2,4)),h=Ca(c.slice(4,6),c.slice(6,8));r=(u+h)/2}let l=i?pi[i]:n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function Ld(n){__(n),n.forEach(function(t){n.forEach(function(e){t!==e&&zn(t,e,Oa)})})}function x_(n,t,e,i){n.forEach(function(r){t.forEach(function(o){zn(r,o,e),zn(o,r,i)})})}function jo(n,t){return n?typeof n=="string"?Lt(n):n:Lt(t)}function Od(n){return function(t,e,i,r){let o=t.length;i=i!==void 0?i:2,r=r??i,e=e!==void 0?e:new Array(o);for(let s=0;s<o;s+=r){let a=n(t.slice(s,s+i)),l=a.length;for(let c=0,u=r;c<u;++c)e[s+c]=c>=l?t[s+c]:a[c]}return e}}function Zo(n,t){return La(),Oi(n,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function Dd(n,t){let e=Oi(n,t!==void 0?t:"EPSG:3857","EPSG:4326"),i=e[0];return(i<-180||i>180)&&(e[0]=ke(i+180,360)-180),e}function qo(n,t){if(n===t)return!0;let e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||rn(n,t)===Oa)&&e}function rn(n,t){let e=n.getCode(),i=t.getCode(),r=Xo(e,i);if(r)return r;let o=null,s=null;for(let l of m_)o||(o=l(n)),s||(s=l(t));if(!o&&!s)return null;let a="EPSG:4326";if(s)if(o)r=Ra(o.inverse,s.forward);else{let l=Xo(e,a);l&&(r=Ra(l,s.forward))}else{let l=Xo(a,i);l&&(r=Ra(o.inverse,l))}return r&&(Ma(n),Ma(t),zn(n,t,r)),r}function Ra(n,t){return function(e,i,r,o){return i=n(e,i,r,o),t(i,i,r,o)}}function on(n,t){let e=Lt(n),i=Lt(t);return rn(e,i)}function Oi(n,t,e){let i=on(t,e);if(!i){let r=Lt(t).getCode(),o=Lt(e).getCode();throw new Error(`No transform available between ${r} and ${o}`)}return i(n,void 0,n.length)}function Pd(n,t,e,i){let r=on(t,e);return ld(n,r,void 0,i)}var Ge=null;function gi(){return Ge}function Tr(n,t){return Ge?Oi(n,t,Ge):n}function Qt(n,t){return Ge?Oi(n,Ge,t):(Aa&&!en(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Aa=!1,Vo("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n)}function Di(n,t){return Ge?Pd(n,t,Ge):n}function be(n,t){return Ge?Pd(n,Ge,t):n}function Fd(n,t){if(!Ge)return n;let e=Lt(t).getMetersPerUnit(),i=Ge.getMetersPerUnit();return e&&i?n*e/i:n}function y_(){Ld(va),Ld(Sa),x_(Sa,va,md,gd)}y_();var $E=new Array(6);function kt(){return[1,0,0,1,0,0]}function Nd(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function xt(n,t){let e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function zt(n,t,e,i,r,o,s,a){let l=Math.sin(o),c=Math.cos(o);return n[0]=i*c,n[1]=r*l,n[2]=-i*l,n[3]=r*c,n[4]=s*i*c-a*i*l+t,n[5]=s*r*l+a*r*c+e,n}function Ho(n,t){let e=E_(t);j(e!==0,"Transformation matrix cannot be inverted");let i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5];return n[0]=s/e,n[1]=-r/e,n[2]=-o/e,n[3]=i/e,n[4]=(o*l-s*a)/e,n[5]=-(i*l-r*a)/e,n}function E_(n){return n[0]*n[3]-n[1]*n[2]}var C_=[1e5,1e5,1e5,1e5,2,2];function Gd(n){return"matrix("+n.join(", ")+")"}function kd(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function zd(n,t){let e=kd(n),i=kd(t);for(let r=0;r<6;++r)if(Math.round((e[r]-i[r])*C_[r])!==0)return!1;return!0}function te(n,t,e,i,r,o,s){o=o||[],s=s||2;let a=0;for(let l=t;l<e;l+=i){let c=n[l],u=n[l+1];o[a++]=r[0]*c+r[2]*u+r[4],o[a++]=r[1]*c+r[3]*u+r[5];for(let h=2;h<s;h++)o[a++]=n[l+h]}return o&&o.length!=a&&(o.length=a),o}function $o(n,t,e,i,r,o,s){s=s||[];let a=Math.cos(r),l=Math.sin(r),c=o[0],u=o[1],h=0;for(let d=t;d<e;d+=i){let f=n[d]-c,p=n[d+1]-u;s[h++]=c+f*a-p*l,s[h++]=u+f*l+p*a;for(let g=d+2;g<d+i;++g)s[h++]=n[g]}return s&&s.length!=h&&(s.length=h),s}function Vd(n,t,e,i,r,o,s,a){a=a||[];let l=s[0],c=s[1],u=0;for(let h=t;h<e;h+=i){let d=n[h]-l,f=n[h+1]-c;a[u++]=l+r*d,a[u++]=c+o*f;for(let p=h+2;p<h+i;++p)a[u++]=n[p]}return a&&a.length!=u&&(a.length=u),a}function Wd(n,t,e,i,r,o,s){s=s||[];let a=0;for(let l=t;l<e;l+=i){s[a++]=n[l]+r,s[a++]=n[l+1]+o;for(let c=l+2;c<l+i;++c)s[a++]=n[c]}return s&&s.length!=a&&(s.length=a),s}var Xd=kt(),w_=[NaN,NaN],Pa=class extends At{constructor(){super(),this.extent_=It(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Io((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);let r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return J()}closestPointXY(t,e,i,r){return J()}containsXY(t,e){return this.closestPointXY(t,e,w_,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return J()}getExtent(t){if(this.extentRevision_!=this.getRevision()){let e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Qi(e),this.extentRevision_=this.getRevision()}return sd(this.extent_,t)}rotate(t,e){J()}scale(t,e,i){J()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return J()}getType(){return J()}applyTransform(t){J()}intersectsExtent(t){return J()}translate(t,e){J()}transform(t,e){let i=Lt(t),r=i.getUnits()=="tile-pixels"?function(o,s,a){let l=i.getExtent(),c=i.getWorldExtent(),u=mt(c)/mt(l);zt(Xd,c[0],c[3],u,-u,0,0,0);let h=te(o,0,o.length,a,Xd,s),d=on(i,e);return d?d(h,h,a):h}:on(i,e);return this.applyTransform(r),this}},Ud=Pa;var Fa=class extends Ud{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return J()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;let e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Kd(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){J()}setLayout(t,e,i){let r;if(t)r=Kd(t);else{for(let o=0;o<i;++o){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=v_(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){let i=this.getFlatCoordinates();if(i){let r=this.getStride();$o(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=ve(this.getExtent()));let r=this.getFlatCoordinates();if(r){let o=this.getStride();Vd(r,0,r.length,o,t,e,i,r),this.changed()}}translate(t,e){let i=this.getFlatCoordinates();if(i){let r=this.getStride();Wd(i,0,i.length,r,t,e,i),this.changed()}}};function v_(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function Kd(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}function Bd(n,t,e){let i=n.getFlatCoordinates();if(!i)return null;let r=n.getStride();return te(i,0,i.length,r,t,e)}var Wn=Fa;function ka(n,t,e,i){let r=0,o=n[e-i],s=n[e-i+1],a=0,l=0;for(;t<e;t+=i){let c=n[t]-o,u=n[t+1]-s;r+=l*c-a*u,a=c,l=u}return r/2}function Yd(n,t,e,i){let r=0;for(let o=0,s=e.length;o<s;++o){let a=e[o];r+=ka(n,t,a,i),t=a}return r}function jd(n,t,e,i,r,o,s){let a=n[t],l=n[t+1],c=n[e]-a,u=n[e+1]-l,h;if(c===0&&u===0)h=t;else{let d=((r-a)*c+(o-l)*u)/(c*c+u*u);if(d>1)h=e;else if(d>0){for(let f=0;f<i;++f)s[f]=Kt(n[t+f],n[e+f],d);s.length=i;return}else h=t}for(let d=0;d<i;++d)s[d]=n[h+d];s.length=i}function Na(n,t,e,i,r){let o=n[t],s=n[t+1];for(t+=i;t<e;t+=i){let a=n[t],l=n[t+1],c=di(o,s,a,l);c>r&&(r=c),o=a,s=l}return r}function Zd(n,t,e,i,r){for(let o=0,s=e.length;o<s;++o){let a=e[o];r=Na(n,t,a,i,r),t=a}return r}function Ga(n,t,e,i,r,o,s,a,l,c,u){if(t==e)return c;let h,d;if(r===0){if(d=di(s,a,n[t],n[t+1]),d<c){for(h=0;h<i;++h)l[h]=n[t+h];return l.length=i,d}return c}u=u||[NaN,NaN];let f=t+i;for(;f<e;)if(jd(n,f-i,f,i,s,a,u),d=di(s,a,u[0],u[1]),d<c){for(c=d,h=0;h<i;++h)l[h]=u[h];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(c))/r|0,1);if(o&&(jd(n,e-i,t,i,s,a,u),d=di(s,a,u[0],u[1]),d<c)){for(c=d,h=0;h<i;++h)l[h]=u[h];l.length=i}return c}function qd(n,t,e,i,r,o,s,a,l,c,u){u=u||[NaN,NaN];for(let h=0,d=e.length;h<d;++h){let f=e[h];c=Ga(n,t,f,i,r,o,s,a,l,c,u),t=f}return c}function Hd(n,t,e,i){for(let r=0,o=e.length;r<o;++r)n[t++]=e[r];return t}function za(n,t,e,i){for(let r=0,o=e.length;r<o;++r){let s=e[r];for(let a=0;a<i;++a)n[t++]=s[a]}return t}function $d(n,t,e,i,r){r=r||[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=za(n,t,e[s],i);r[o++]=l,t=l}return r.length=o,r}function Pi(n,t,e,i,r){r=r!==void 0?r:[];let o=0;for(let s=t;s<e;s+=i)r[o++]=n.slice(s,s+i);return r.length=o,r}function Xn(n,t,e,i,r){r=r!==void 0?r:[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=e[s];r[o++]=Pi(n,t,l,i,r[o]),t=l}return r.length=o,r}function Va(n,t,e,i,r){r=r!==void 0?r:[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=e[s];r[o++]=l.length===1&&l[0]===t?[]:Xn(n,t,l,i,r[o]),t=l[l.length-1]}return r.length=o,r}function Ir(n,t,e,i,r,o,s){let a=(e-t)/i;if(a<3){for(;t<e;t+=i)o[s++]=n[t],o[s++]=n[t+1];return s}let l=new Array(a);l[0]=1,l[a-1]=1;let c=[t,e-i],u=0;for(;c.length>0;){let h=c.pop(),d=c.pop(),f=0,p=n[d],g=n[d+1],m=n[h],_=n[h+1];for(let x=d+i;x<h;x+=i){let C=n[x],y=n[x+1],E=ed(C,y,p,g,m,_);E>f&&(u=x,f=E)}f>r&&(l[(u-t)/i]=1,d+i<u&&c.push(d,u),u+i<h&&c.push(u,h))}for(let h=0;h<a;++h)l[h]&&(o[s++]=n[t+h*i],o[s++]=n[t+h*i+1]);return s}function Jd(n,t,e,i,r,o,s,a){for(let l=0,c=e.length;l<c;++l){let u=e[l];s=Ir(n,t,u,i,r,o,s),a.push(s),t=u}return s}function Fi(n,t){return t*Math.round(n/t)}function S_(n,t,e,i,r,o,s){if(t==e)return s;let a=Fi(n[t],r),l=Fi(n[t+1],r);t+=i,o[s++]=a,o[s++]=l;let c,u;do if(c=Fi(n[t],r),u=Fi(n[t+1],r),t+=i,t==e)return o[s++]=c,o[s++]=u,s;while(c==a&&u==l);for(;t<e;){let h=Fi(n[t],r),d=Fi(n[t+1],r);if(t+=i,h==c&&d==u)continue;let f=c-a,p=u-l,g=h-a,m=d-l;if(f*m==p*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(p<0&&m<p||p==m||p>0&&m>p)){c=h,u=d;continue}o[s++]=c,o[s++]=u,a=c,l=u,c=h,u=d}return o[s++]=c,o[s++]=u,s}function Jo(n,t,e,i,r,o,s,a){for(let l=0,c=e.length;l<c;++l){let u=e[l];s=S_(n,t,u,i,r,o,s),a.push(s),t=u}return s}var Wa=class n extends Wn{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new n(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<Fo(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Na(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ga(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return ka(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Pi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){let e=[];return e.length=Ir(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new n(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=za(this.flatCoordinates,0,t,this.stride),this.changed()}},Xa=Wa;var Ua=class n extends Wn{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){let t=new n(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){let o=this.flatCoordinates,s=di(t,e,o[0],o[1]);if(s<r){let a=this.stride;for(let l=0;l<a;++l)i[l]=o[l];return i.length=a,s}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return ko(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return ga(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hd(this.flatCoordinates,0,t,this.stride),this.changed()}},br=Ua;function Qd(n,t,e,i,r){return!No(r,function(s){return!ki(n,t,e,i,s[0],s[1])})}function ki(n,t,e,i,r,o){let s=0,a=n[e-i],l=n[e-i+1];for(;t<e;t+=i){let c=n[t],u=n[t+1];l<=o?u>o&&(c-a)*(o-l)-(r-a)*(u-l)>0&&s++:u<=o&&(c-a)*(o-l)-(r-a)*(u-l)<0&&s--,a=c,l=u}return s!==0}function Qo(n,t,e,i,r,o){if(e.length===0||!ki(n,t,e[0],i,r,o))return!1;for(let s=1,a=e.length;s<a;++s)if(ki(n,e[s-1],e[s],i,r,o))return!1;return!0}function Rr(n,t,e,i,r,o,s){let a,l,c,u,h,d,f,p=r[o+1],g=[];for(let x=0,C=e.length;x<C;++x){let y=e[x];for(u=n[y-i],d=n[y-i+1],a=t;a<y;a+=i)h=n[a],f=n[a+1],(p<=d&&f<=p||d<=p&&p<=f)&&(c=(p-d)/(f-d)*(h-u)+u,g.push(c)),u=h,d=f}let m=NaN,_=-1/0;for(g.sort(Jt),u=g[0],a=1,l=g.length;a<l;++a){h=g[a];let x=Math.abs(h-u);x>_&&(c=(u+h)/2,Qo(n,t,e,i,c,p)&&(m=c,_=x)),u=h}return isNaN(m)&&(m=r[o]),s?(s.push(m,p,_),s):[m,p,_]}function tf(n,t,e,i,r){let o=[];for(let s=0,a=e.length;s<a;++s){let l=e[s];o=Rr(n,t,l,i,r,2*s,o),t=l[l.length-1]}return o}function ef(n,t,e,i,r){let o;for(t+=i;t<e;t+=i)if(o=r(n.slice(t-i,t),n.slice(t,t+i)),o)return o;return!1}function nf(n,t,e,i,r,o){return o=o??_a(It(),n,t,e,i),_t(r,o)?o[0]>=r[0]&&o[2]<=r[2]||o[1]>=r[1]&&o[3]<=r[3]?!0:ef(n,t,e,i,function(s,a){return ad(r,s,a)}):!1}function Ka(n,t,e,i,r){return!!(nf(n,t,e,i,r)||ki(n,t,e,i,r[0],r[1])||ki(n,t,e,i,r[0],r[3])||ki(n,t,e,i,r[2],r[1])||ki(n,t,e,i,r[2],r[3]))}function rf(n,t,e,i,r){if(!Ka(n,t,e[0],i,r))return!1;if(e.length===1)return!0;for(let o=1,s=e.length;o<s;++o)if(Qd(n,e[o-1],e[o],i,r)&&!nf(n,e[o-1],e[o],i,r))return!1;return!0}function of(n,t,e,i){for(;t<e-i;){for(let r=0;r<i;++r){let o=n[t+r];n[t+r]=n[e-i+r],n[e-i+r]=o}t+=i,e-=i}}function Ba(n,t,e,i){let r=0,o=n[e-i],s=n[e-i+1];for(;t<e;t+=i){let a=n[t],l=n[t+1];r+=(a-o)*(l+s),o=a,s=l}return r===0?void 0:r>0}function sf(n,t,e,i,r){r=r!==void 0?r:!1;for(let o=0,s=e.length;o<s;++o){let a=e[o],l=Ba(n,t,a,i);if(o===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function Ya(n,t,e,i,r){r=r!==void 0?r:!1;for(let o=0,s=e.length;o<s;++o){let a=e[o],l=Ba(n,t,a,i);(o===0?r&&l||!r&&!l:r&&!l||!r&&l)&&of(n,t,a,i),t=a}return t}function af(n,t){let e=[],i=0,r=0,o;for(let s=0,a=t.length;s<a;++s){let l=t[s],c=Ba(n,i,l,2);if(o===void 0&&(o=c),c===o)e.push(t.slice(r,s+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=s+1,i=l}return e}var ts=class n extends Wn{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Tn(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let t=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Fo(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zd(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return Qo(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Yd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ya(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Xn(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){let t=ve(this.getExtent());this.flatInteriorPoint_=Rr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new br(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Xa(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){let t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[],o=0;for(let s=0,a=i.length;s<a;++s){let l=i[s],c=new Xa(e.slice(o,l),t);r.push(c),o=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let t=this.flatCoordinates;sf(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ya(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){let e=[],i=[];return e.length=Jo(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new n(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return rf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);let i=$d(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}},lf=ts;function ja(n){if(Mi(n))throw new Error("Cannot create polygon from empty extent");let t=n[0],e=n[1],i=n[2],r=n[3],o=[t,e,t,r,i,r,i,e,t,e];return new ts(o,"XY",[o.length])}function Za(n,t,e,i){let r=H(t)/e[0],o=mt(t)/e[1];return i?Math.min(n,Math.max(r,o)):Math.min(n,Math.min(r,o))}function qa(n,t,e){let i=Math.min(n,t),r=50;return i*=Math.log(1+r*Math.max(0,n/t-1))/r+1,e&&(i=Math.max(i,e),i/=Math.log(1+r*Math.max(0,e/n-1))/r+1),at(i,e/2,t*2)}function cf(n,t,e,i){return t=t!==void 0?t:!0,function(r,o,s,a){if(r!==void 0){let l=n[0],c=n[n.length-1],u=e?Za(l,e,s,i):l;if(a)return t?qa(r,u,c):at(r,c,u);let h=Math.min(u,r),d=Math.floor(Sn(n,h,o));return n[d]>u&&d<n.length-1?n[d+1]:n[d]}}}function uf(n,t,e,i,r,o){return i=i!==void 0?i:!0,e=e!==void 0?e:0,function(s,a,l,c){if(s!==void 0){let u=r?Za(t,r,l,o):t;if(c)return i?qa(s,u,e):at(s,e,u);let h=1e-9,d=Math.ceil(Math.log(t/u)/Math.log(n)-h),f=-a*(.5-h)+.5,p=Math.min(u,s),g=Math.floor(Math.log(t/p)/Math.log(n)+f),m=Math.max(d,g),_=t/Math.pow(n,m);return at(_,e,u)}}}function Ha(n,t,e,i,r){return e=e!==void 0?e:!0,function(o,s,a,l){if(o!==void 0){let c=i?Za(n,i,a,r):n;return!e||!l?at(o,t,c):qa(o,c,t)}}}function Un(n){if(n!==void 0)return 0}function $a(n){if(n!==void 0)return n}function hf(n){let t=2*Math.PI/n;return function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function df(n){let t=n===void 0?Fe(5):n;return function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e}}var Ja=0,tl=class extends At{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=jo(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&La(),t.center&&(t.center=Qt(t.center,this.projection_)),t.extent&&(t.extent=be(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){let e=Object.assign({},t);for(let a in we)delete e[a];this.setProperties(e,!0);let i=I_(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;let r=T_(t),o=i.constraint,s=b_(t);this.constraints_={center:r,resolution:o,rotation:s},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;let i=this.getCenterInternal();if(i){let r=t||[0,0,0,0];e=e||[0,0,0,0];let o=this.getResolution(),s=o/2*(r[3]-e[3]+e[1]-r[1]),a=o/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([i[0]+s,i[1]-a])}}getUpdatedOptions_(t){let e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);let e=new Array(arguments.length);for(let i=0;i<e.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Qt(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Qt(r.anchor,this.getProjection())),e[i]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){let u=arguments[r];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(r===e){i&&es(i,!0);return}let o=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_,c=[];for(;r<e;++r){let u=arguments[r],h={start:o,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||dd,callback:i};if(u.center&&(h.sourceCenter=s,h.targetCenter=u.center.slice(),s=h.targetCenter),u.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(u.zoom),a=h.targetResolution):u.resolution&&(h.sourceResolution=a,h.targetResolution=u.resolution,a=h.targetResolution),u.rotation!==void 0){h.sourceRotation=l;let d=ke(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+d,l=h.targetRotation}R_(h)?h.complete=!0:o+=h.duration,c.push(h)}this.animations_.push(c),this.setHint(Ot.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ot.ANIMATING]>0}getInteracting(){return this.hints_[Ot.INTERACTING]>0}cancelAnimations(){this.setHint(Ot.ANIMATING,-this.hints_[Ot.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){let r=this.animations_[e];if(r[0].callback&&es(r[0].callback,!1),!t)for(let o=0,s=r.length;o<s;++o){let a=r[o];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;let t=Date.now(),e=!1;for(let i=this.animations_.length-1;i>=0;--i){let r=this.animations_[i],o=!0;for(let s=0,a=r.length;s<a;++s){let l=r[s];if(l.complete)continue;let c=t-l.start,u=l.duration>0?c/l.duration:1;u>=1?(l.complete=!0,u=1):o=!1;let h=l.easing(u);if(l.sourceCenter){let d=l.sourceCenter[0],f=l.sourceCenter[1],p=l.targetCenter[0],g=l.targetCenter[1];this.nextCenter_=l.targetCenter;let m=d+h*(p-d),_=f+h*(g-f);this.targetCenter_=[m,_]}if(l.sourceResolution&&l.targetResolution){let d=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){let f=this.getViewportSize_(this.getRotation()),p=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(p,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){let d=h===1?ke(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){let f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(o){this.animations_[i]=null,this.setHint(Ot.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;let s=r[0].callback;s&&es(s,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i,r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-e[0],r[1]-e[1]],Fn(i,t-this.getRotation()),cd(i,e)),i}calculateCenterZoom(t,e){let i,r=this.getCenterInternal(),o=this.getResolution();if(r!==void 0&&o!==void 0){let s=e[0]-t*(e[0]-r[0])/o,a=e[1]-t*(e[1]-r[1])/o;i=[s,a]}return i}getViewportSize_(t){let e=this.viewportSize_;if(t){let i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){let t=this.getCenterInternal();return t&&Tr(t,this.getProjection())}getCenterInternal(){return this.get(we.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){let e=this.calculateExtentInternal(t);return Di(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();let e=this.getCenterInternal();j(e,"The view center is not defined");let i=this.getResolution();j(i!==void 0,"The view resolution is not defined");let r=this.getRotation();return j(r!==void 0,"The view rotation is not defined"),vr(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(we.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(be(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();let i=H(t)/e[0],r=mt(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;let e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(e/i)/Math.log(t);return function(o){return e/Math.pow(t,o*r)}}getRotation(){return this.get(we.ROTATION)}getValueForResolutionFunction(t){let e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,o=Math.log(i/r)/e;return function(s){return Math.log(i/s)/e/o}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t),i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){let t=this.getProjection(),e=this.getResolution(),i=this.getRotation(),r=this.getCenterInternal(),o=this.padding_;if(o){let s=this.getViewportSizeMinusPadding_();r=Qa(r,this.getViewportSize_(),[s[0]/2+o[3],s[1]/2+o[0]],e,i)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t,e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,r;if(this.resolutions_){let o=Sn(this.resolutions_,t,1);e=o,i=this.resolutions_[o],o==this.resolutions_.length-1?r=2:r=i/this.resolutions_[o+1]}else i=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(i/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];let e=at(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,at(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(j(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){j(!Mi(t),"Cannot fit empty extent provided as `geometry`");let r=be(t,this.getProjection());i=ja(r)}else if(t.getType()==="Circle"){let r=be(t.getExtent(),this.getProjection());i=ja(r),i.rotate(this.getRotation(),ve(r))}else{let r=gi();r?i=t.clone().transform(r,this.getProjection()):i=t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){let e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),o=t.getFlatCoordinates(),s=t.getStride(),a=1/0,l=1/0,c=-1/0,u=-1/0;for(let h=0,d=o.length;h<d;h+=s){let f=o[h]*i-o[h+1]*r,p=o[h]*r+o[h+1]*i;a=Math.min(a,f),l=Math.min(l,p),c=Math.max(c,f),u=Math.max(u,p)}return[a,l,c,u]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());let r=e.padding!==void 0?e.padding:[0,0,0,0],o=e.nearest!==void 0?e.nearest:!1,s;e.minResolution!==void 0?s=e.minResolution:e.maxZoom!==void 0?s=this.getResolutionForZoom(e.maxZoom):s=0;let a=this.rotatedExtentForGeometry(t),l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?s:Math.max(l,s),l=this.getConstrainedResolution(l,o?0:1);let c=this.getRotation(),u=Math.sin(c),h=Math.cos(c),d=ve(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;let f=d[0]*h-d[1]*u,p=d[1]*h+d[0]*u,g=this.getConstrainedCenter([f,p],l),m=e.callback?e.callback:hi;e.duration!==void 0?this.animateInternal({resolution:l,center:g,duration:e.duration,easing:e.easing},m):(this.targetResolution_=l,this.targetCenter_=g,this.applyTargetState_(!1,!0),es(m,!0))}centerOn(t,e,i){this.centerOnInternal(Qt(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Qa(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let o,s=this.padding_;if(s&&t){let a=this.getViewportSizeMinusPadding_(-i),l=Qa(t,r,[a[0]/2+s[3],a[1]/2+s[0]],e,i);o=[t[0]-l[0],t[1]-l[1]]}return o}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){let e=Tr(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){let e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Qt(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){let i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Qt(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){let i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Qt(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){let i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),o=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,0,o,i),a=this.constraints_.center(this.targetCenter_,s,o,i,this.calculateCenterShift(this.targetCenter_,s,r,o));this.get(we.ROTATION)!==r&&this.set(we.ROTATION,r),this.get(we.RESOLUTION)!==s&&(this.set(we.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(we.CENTER)||!en(this.get(we.CENTER),a))&&this.set(we.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;let r=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,r,s),l=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,o,s));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==o||!this.getCenterInternal()||!en(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:a,duration:t,easing:Te,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ot.INTERACTING,1)}endInteraction(t,e,i){i=i&&Qt(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(Ot.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){let i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){let i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;let i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function es(n,t){setTimeout(function(){n(t)},0)}function T_(n){if(n.extent!==void 0){let e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return pa(n.extent,n.constrainOnlyCenter,e)}let t=jo(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){let e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,pa(e,!1,!1)}return nd}function I_(n){let t,e,i,s=n.minZoom!==void 0?n.minZoom:Ja,a=n.maxZoom!==void 0?n.maxZoom:28,l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,u=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,h=n.showFullExtent!==void 0?n.showFullExtent:!1,d=jo(n.projection,"EPSG:3857"),f=d.getExtent(),p=n.constrainOnlyCenter,g=n.extent;if(!c&&!g&&d.isGlobal()&&(p=!1,g=f),n.resolutions!==void 0){let m=n.resolutions;e=m[s],i=m[a]!==void 0?m[a]:m[m.length-1],n.constrainResolution?t=cf(m,u,!p&&g,h):t=Ha(e,i,u,!p&&g,h)}else{let _=(f?Math.max(H(f),mt(f)):360*pi.degrees/d.getMetersPerUnit())/256/Math.pow(2,Ja),x=_/Math.pow(2,28-Ja);e=n.maxResolution,e!==void 0?s=0:e=_/Math.pow(l,s),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=e/Math.pow(l,a):i=_/Math.pow(l,a):i=x),a=s+Math.floor(Math.log(e/i)/Math.log(l)),i=e/Math.pow(l,a-s),n.constrainResolution?t=uf(l,e,i,u,!p&&g,h):t=Ha(e,i,u,!p&&g,h)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:s,zoomFactor:l}}function b_(n){if(n.enableRotation!==void 0?n.enableRotation:!0){let e=n.constrainRotation;return e===void 0||e===!0?df():e===!1?$a:typeof e=="number"?hf(e):$a}return Un}function R_(n){return!(n.sourceCenter&&n.targetCenter&&!en(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function Qa(n,t,e,i,r){let o=Math.cos(-r),s=Math.sin(-r),a=n[0]*o-n[1]*s,l=n[1]*o+n[0]*s;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,s=-s;let c=a*o-l*s,u=l*o+a*s;return[c,u]}var ue=tl;var Ar="ol-hidden";var Ni="ol-unselectable";var Kn="ol-control",el="ol-collapsed",A_=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),pf=["style","variant","weight","size","lineHeight","family"],il=function(n){let t=n.match(A_);if(!t)return null;let e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,r=pf.length;i<r;++i){let o=t[i+1];o!==void 0&&(e[pf[i]]=o)}return e.families=e.family.split(/,\s?/),e};function ut(n,t,e,i){let r;return e&&e.length?r=e.shift():Ao?r=new OffscreenCanvas(n||300,t||300):r=document.createElement("canvas"),n&&(r.width=n),t&&(r.height=t),r.getContext("2d",i)}var nl;function Bn(){return nl||(nl=ut(1,1)),nl}function sn(n){let t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function rl(n,t){let e=t.parentNode;e&&e.replaceChild(n,t)}function mf(n){for(;n.lastChild;)n.lastChild.remove()}function gf(n,t){let e=n.childNodes;for(let i=0;;++i){let r=e[i],o=t[i];if(!r&&!o)break;if(r!==o){if(!r){n.appendChild(o);continue}if(!o){n.removeChild(r),--i;continue}n.insertBefore(o,r)}}}var ol=class extends At{constructor(t){super();let e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let e=0,i=this.listenerKeys.length;e<i;++e)st(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){let e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==hi&&this.listenerKeys.push(Z(t,qe.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}},Yn=ol;var sl=class extends Yn{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;let e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",o=t.collapseLabel!==void 0?t.collapseLabel:"\u203A",s=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof o=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o,this.collapseLabel_.className=s):this.collapseLabel_=o;let a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;let l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(P.CLICK,this.handleClick_.bind(this),!1);let c=e+" "+Ni+" "+Kn+(this.collapsed_&&this.collapsible_?" "+el:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){let e=this.getMap().getAllLayers(),i=new Set(e.flatMap(r=>r.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){let r=!e.some(o=>o.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}updateElement_(t){return Su(this,null,function*(){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}let e=yield Promise.all(this.collectSourceAttributions_(t).map(r=>jh(()=>r))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Ut(e,this.renderedAttributions_)){mf(this.ulElement_);for(let r=0,o=e.length;r<o;++r){let s=document.createElement("li");s.innerHTML=e[r],this.ulElement_.appendChild(s)}this.renderedAttributions_=e}})}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(el),this.collapsed_?rl(this.collapseLabel_,this.label_):rl(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},_f=sl;var al=class extends Yn{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});let e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"\u21E7",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));let o=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),s.addEventListener(P.CLICK,this.handleClick_.bind(this),!1);let a=e+" "+Ni+" "+Kn,l=this.element;l.className=a,l.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ar)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){let e=this.getMap().getView();if(!e)return;let i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Te}):e.setRotation(0))}render(t){let e=t.frameState;if(!e)return;let i=e.viewState.rotation;if(i!=this.rotation_){let r="rotate("+i+"rad)";if(this.autoHide_){let o=this.element.classList.contains(Ar);!o&&i===0?this.element.classList.add(Ar):o&&i!==0&&this.element.classList.remove(Ar)}this.label_.style.transform=r}this.rotation_=i}},xf=al;var ll=class extends Yn{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});let e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",o=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",s=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"\u2013",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof s=="string"?document.createTextNode(s):s),u.addEventListener(P.CLICK,this.handleClick_.bind(this,i),!1);let h=document.createElement("button");h.className=o,h.setAttribute("type","button"),h.title=c,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(P.CLICK,this.handleClick_.bind(this,-i),!1);let d=e+" "+Ni+" "+Kn,f=this.element;f.className=d,f.appendChild(u),f.appendChild(h),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){let i=this.getMap().getView();if(!i)return;let r=i.getZoom();if(r!==void 0){let o=i.getConstrainedZoom(r+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:o,duration:this.duration_,easing:Te})):i.setZoom(o)}}},yf=ll;function Ef(n){n=n||{};let t=new Tt;return(n.zoom!==void 0?n.zoom:!0)&&t.push(new yf(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&t.push(new xf(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&t.push(new _f(n.attributionOptions)),t}var cl=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;let t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;let r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;let o=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,o),this.initialVelocity_=Math.sqrt(o*o+s*s)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Cf=cl;var Mr={ACTIVE:"active"};var ul=class extends At{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Mr.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Mr.ACTIVE,t)}setMap(t){this.map_=t}};function wf(n,t,e){let i=n.getCenterInternal();if(i){let r=[i[0]+t[0],i[1]+t[1]];n.animateInternal({duration:e!==void 0?e:250,easing:fd,center:n.getConstrainedCenter(r)})}}function jn(n,t,e,i){let r=n.getZoom();if(r===void 0)return;let o=n.getConstrainedZoom(r+t),s=n.getResolutionForZoom(o);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:s,anchor:e,duration:i!==void 0?i:250,easing:Te})}var $e=ul;var hl=class extends $e{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==dt.DBLCLICK){let i=t.originalEvent,r=t.map,o=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_,a=r.getView();jn(a,s,o,this.duration_),i.preventDefault(),e=!0}return!e}},vf=hl;function Lr(n){let t=arguments;return function(e){let i=!0;for(let r=0,o=t.length;r<o&&(i=i&&t[r](e),!!i);++r);return i}}var Sf=function(n){let t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},M_=function(n){let t=n.map.getTargetElement(),e=t.getRootNode(),i=n.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},is=function(n){let t=n.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?M_(n):!0},ns=Ce;var rs=function(n){let t=n.originalEvent;return t instanceof PointerEvent&&t.button==0&&!(qh&&ca&&t.ctrlKey)};var os=function(n){let t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var Tf=function(n){let t=n.originalEvent;return ca?t.metaKey:t.ctrlKey},If=function(n){let t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},ss=function(n){let t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},as=function(n){let t=n.originalEvent;return t instanceof PointerEvent&&t.pointerType=="mouse"};var bf=function(n){let t=n.originalEvent;return t instanceof PointerEvent&&t.isPrimary&&t.button===0};var dl=class extends $e{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==dt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==dt.POINTERUP){let i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==dt.POINTERDOWN){let i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==dt.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Zn(n){let t=n.length,e=0,i=0;for(let r=0;r<t;r++)e+=n[r].clientX,i+=n[r].clientY;return{clientX:e/t,clientY:i/t}}var Re=dl;var fl=class extends Re{constructor(t){super({stopDown:ui}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;let e=t.condition?t.condition:Lr(os,bf);this.condition_=t.onFocusOnly?Lr(is,e):e,this.noKinetic_=!1}handleDragEvent(t){let e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());let i=this.targetPointers,r=e.getEventPixel(Zn(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){let o=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();ud(o,a.getResolution()),Fn(o,a.getRotation()),a.adjustCenterInternal(o)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){let e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let r=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),s=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(s),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(o),a[1]-r*Math.sin(o)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Te})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){let i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Rf=fl;var pl=class extends Re{constructor(t){t=t||{},super({stopDown:ui}),this.condition_=t.condition?t.condition:Sf,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!as(t))return;let e=t.map,i=e.getView();if(i.getConstraints().rotation===Un)return;let r=e.getSize(),o=t.pixel,s=Math.atan2(r[1]/2-o[1],o[0]-r[0]/2);if(this.lastAngle_!==void 0){let a=s-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=s}handleUpEvent(t){return as(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return as(t)&&rs(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}},Af=pl;var ml=class extends bi{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){let t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;let t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new lf([r])}getGeometry(){return this.geometry_}},Mf=ml;var qn={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},an=class extends Rt{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}},gl=class extends Re{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new Mf(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??rs,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){let r=i[0]-e[0],o=i[1]-e[1];return r*r+o*o>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new an(qn.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;let e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new an(e?qn.BOXEND:qn.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new an(qn.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new an(qn.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new an(qn.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}},Lf=gl;var _l=class extends Lf{constructor(t){t=t||{};let e=t.condition?t.condition:If;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){let i=this.getMap().getView(),r=this.getGeometry();if(this.out_){let o=i.rotatedExtentForGeometry(r),s=i.getResolutionForExtentInternal(o),a=i.getResolution()/s;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Te})}},Of=_l;var Gi={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};var xl=class extends $e{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return os(e)&&ss(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==P.KEYDOWN){let i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==Gi.DOWN||r==Gi.LEFT||r==Gi.RIGHT||r==Gi.UP)){let s=t.map.getView(),a=s.getResolution()*this.pixelDelta_,l=0,c=0;r==Gi.DOWN?c=-a:r==Gi.LEFT?l=-a:r==Gi.RIGHT?l=a:c=a;let u=[l,c];Fn(u,s.getRotation()),wf(s,u,this.duration_),i.preventDefault(),e=!0}}return!e}},Df=xl;var yl=class extends $e{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!Tf(e)&&ss(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==P.KEYDOWN||t.type==P.KEYPRESS){let i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==="+"||r==="-")){let o=t.map,s=r==="+"?this.delta_:-this.delta_,a=o.getView();jn(a,s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},Pf=yl;var El=class extends $e{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;let e=t.condition?t.condition:ns;this.condition_=t.onFocusOnly?Lr(is,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;let t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==P.WHEEL)return!0;let i=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let o;if(t.type==P.WHEEL&&(o=r.deltaY,r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(o*=40)),o===0)return!1;this.lastDelta_=o;let s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(o)<4?"trackpad":"wheel");let a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-o/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=s,!1;this.totalDelta_+=o;let l=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(t){let e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-at(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),jn(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},Ff=El;var Cl=class extends Re{constructor(t){t=t||{};let e=t;e.stopDown||(e.stopDown=ui),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0,i=this.targetPointers[0],r=this.targetPointers[1],o=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){let l=o-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=o;let s=t.map,a=s.getView();a.getConstraints().rotation!==Un&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Zn(this.targetPointers))),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){let e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},kf=Cl;var wl=class extends Re{constructor(t){t=t||{};let e=t;e.stopDown||(e.stopDown=ui),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1,i=this.targetPointers[0],r=this.targetPointers[1],o=i.clientX-r.clientX,s=i.clientY-r.clientY,a=Math.sqrt(o*o+s*s);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;let l=t.map,c=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Zn(this.targetPointers))),l.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){let i=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){let e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Nf=wl;function Gf(n){n=n||{};let t=new Tt,e=new Cf(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&t.push(new Af),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&t.push(new vf({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&t.push(new Rf({onFocusOnly:n.onFocusOnly,kinetic:e})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&t.push(new kf),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&t.push(new Nf({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(t.push(new Df),t.push(new Pf({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&t.push(new Ff({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&t.push(new Of({duration:n.zoomDuration})),t}var lt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var vl=class extends At{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;let e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[lt.OPACITY]=t.opacity!==void 0?t.opacity:1,j(typeof e[lt.OPACITY]=="number","Layer opacity must be a number"),e[lt.VISIBLE]=t.visible!==void 0?t.visible:!0,e[lt.Z_INDEX]=t.zIndex,e[lt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[lt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[lt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[lt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){let e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=at(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return J()}getLayerStatesArray(t){return J()}getExtent(){return this.get(lt.EXTENT)}getMaxResolution(){return this.get(lt.MAX_RESOLUTION)}getMinResolution(){return this.get(lt.MIN_RESOLUTION)}getMinZoom(){return this.get(lt.MIN_ZOOM)}getMaxZoom(){return this.get(lt.MAX_ZOOM)}getOpacity(){return this.get(lt.OPACITY)}getSourceState(){return J()}getVisible(){return this.get(lt.VISIBLE)}getZIndex(){return this.get(lt.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(lt.EXTENT,t)}setMaxResolution(t){this.set(lt.MAX_RESOLUTION,t)}setMinResolution(t){this.set(lt.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(lt.MAX_ZOOM,t)}setMinZoom(t){this.set(lt.MIN_ZOOM,t)}setOpacity(t){j(typeof t=="number","Layer opacity must be a number"),this.set(lt.OPACITY,t)}setVisible(t){this.set(lt.VISIBLE,t)}setZIndex(t){this.set(lt.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},ls=vl;var ze=class extends Rt{constructor(t,e){super(t),this.layer=e}},Sl={LAYERS:"layers"},Tl=class n extends ls{constructor(t){t=t||{};let e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Sl.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Tt(i.slice(),{unique:!0}):j(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Tt(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(st),this.layersListenerKeys_.length=0;let t=this.getLayers();this.layersListenerKeys_.push(Z(t,Ft.ADD,this.handleLayersAdd_,this),Z(t,Ft.REMOVE,this.handleLayersRemove_,this));for(let i in this.listenerKeys_)this.listenerKeys_[i].forEach(st);je(this.listenerKeys_);let e=t.getArray();for(let i=0,r=e.length;i<r;i++){let o=e[i];this.registerLayerListeners_(o),this.dispatchEvent(new ze("addlayer",o))}this.changed()}registerLayerListeners_(t){let e=[Z(t,De.PROPERTYCHANGE,this.handleLayerChange_,this),Z(t,P.CHANGE,this.handleLayerChange_,this)];t instanceof n&&e.push(Z(t,"addlayer",this.handleLayerGroupAdd_,this),Z(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[B(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new ze("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new ze("removelayer",t.layer))}handleLayersAdd_(t){let e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new ze("addlayer",e)),this.changed()}handleLayersRemove_(t){let e=t.element,i=B(e);this.listenerKeys_[i].forEach(st),delete this.listenerKeys_[i],this.dispatchEvent(new ze("removelayer",e)),this.changed()}getLayers(){return this.get(Sl.LAYERS)}setLayers(t){let e=this.getLayers();if(e){let i=e.getArray();for(let r=0,o=i.length;r<o;++r)this.dispatchEvent(new ze("removelayer",i[r]))}this.set(Sl.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){let e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(s){s.getLayerStatesArray(e)});let r=this.getLayerState(),o=r.zIndex;!t&&r.zIndex===void 0&&(o=0);for(let s=i,a=e.length;s<a;s++){let l=e[s];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=He(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=o)}return e}getSourceState(){return"ready"}},Or=Tl;var Vt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var Il=class extends ls{constructor(t){let e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(lt.SOURCE,this.handleSourcePropertyChange_);let i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(lt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){let t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(st(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;let t=this.getSource();t&&(this.sourceChangeKey_=Z(t,P.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0)),this.clearRenderer()),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e,i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof ue?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(e.layerStatesArray){if(r=e.layerStatesArray.find(s=>s.layer===this),!r)return!1}else r=this.getLayerState();let o=this.getExtent();return Dr(r,e.viewState)&&(!o||_t(o,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e=this.getSource()?.getAttributions();if(!e)return[];let i=t instanceof ue?t.getViewStateAndExtent():t,r=e(i);return Array.isArray(r)||(r=[r]),r}render(t,e){let i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){let e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(lt.MAP,t)}getMapInternal(){return this.get(lt.MAP)}setMap(t){this.mapPrecomposeKey_&&(st(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(st(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Z(t,Vt.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Z(this,P.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){let e=t.frameState.layerStatesArray,i=this.getLayerState(!1);j(!e.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(lt.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function Dr(n,t){if(!n.visible)return!1;let e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;let i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}var ln=Il;function cs(n,t,e=0,i=n.length-1,r=L_){for(;i>e;){if(i-e>600){let l=i-e+1,c=t-e+1,u=Math.log(l),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),f=Math.max(e,Math.floor(t-c*h/l+d)),p=Math.min(i,Math.floor(t+(l-c)*h/l+d));cs(n,t,f,p,r)}let o=n[t],s=e,a=i;for(Pr(n,e,t),r(n[i],o)>0&&Pr(n,e,i);s<a;){for(Pr(n,s,a),s++,a--;r(n[s],o)<0;)s++;for(;r(n[a],o)>0;)a--}r(n[e],o)===0?Pr(n,e,a):(a++,Pr(n,a,i)),a<=t&&(e=a+1),t<=a&&(i=a-1)}}function Pr(n,t,e){let i=n[t];n[t]=n[e],n[e]=i}function L_(n,t){return n<t?-1:n>t?1:0}var Jn=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data,i=[];if(!hs(t,e))return i;let r=this.toBBox,o=[];for(;e;){for(let s=0;s<e.children.length;s++){let a=e.children[s],l=e.leaf?r(a):a;hs(t,l)&&(e.leaf?i.push(a):Rl(t,l)?this._all(a,i):o.push(a))}e=o.pop()}return i}collides(t){let e=this.data;if(!hs(t,e))return!1;let i=[];for(;e;){for(let r=0;r<e.children.length;r++){let o=e.children[r],s=e.leaf?this.toBBox(o):o;if(hs(t,s)){if(e.leaf||Rl(t,s))return!0;i.push(o)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){let i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=$n([]),this}remove(t,e){if(!t)return this;let i=this.data,r=this.toBBox(t),o=[],s=[],a,l,c;for(;i||o.length;){if(i||(i=o.pop(),l=o[o.length-1],a=s.pop(),c=!0),i.leaf){let u=O_(t,i.children,e);if(u!==-1)return i.children.splice(u,1),o.push(i),this._condense(o),this}!c&&!i.leaf&&Rl(i,r)?(o.push(i),s.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],c=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){let i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,r){let o=i-e+1,s=this._maxEntries,a;if(o<=s)return a=$n(t.slice(e,i+1)),Hn(a,this.toBBox),a;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),a=$n([]),a.leaf=!1,a.height=r;let l=Math.ceil(o/s),c=l*Math.ceil(Math.sqrt(s));zf(t,e,i,c,this.compareMinX);for(let u=e;u<=i;u+=c){let h=Math.min(u+c-1,i);zf(t,u,h,l,this.compareMinY);for(let d=u;d<=h;d+=l){let f=Math.min(d+l-1,h);a.children.push(this._build(t,d,f,r-1))}}return Hn(a,this.toBBox),a}_chooseSubtree(t,e,i,r){for(;r.push(e),!(e.leaf||r.length-1===i);){let o=1/0,s=1/0,a;for(let l=0;l<e.children.length;l++){let c=e.children[l],u=bl(c),h=F_(t,c)-u;h<s?(s=h,o=u<o?u:o,a=c):h===s&&u<o&&(o=u,a=c)}e=a||e.children[0]}return e}_insert(t,e,i){let r=i?t:this.toBBox(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),kr(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)}_split(t,e){let i=t[e],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);let s=this._chooseSplitIndex(i,o,r),a=$n(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,Hn(i,this.toBBox),Hn(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=$n([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Hn(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let r,o=1/0,s=1/0;for(let a=e;a<=i-e;a++){let l=Fr(t,0,a,this.toBBox),c=Fr(t,a,i,this.toBBox),u=k_(l,c),h=bl(l)+bl(c);u<o?(o=u,r=a,s=h<s?h:s):u===o&&h<s&&(s=h,r=a)}return r||i-e}_chooseSplitAxis(t,e,i){let r=t.leaf?this.compareMinX:D_,o=t.leaf?this.compareMinY:P_,s=this._allDistMargin(t,e,i,r),a=this._allDistMargin(t,e,i,o);s<a&&t.children.sort(r)}_allDistMargin(t,e,i,r){t.children.sort(r);let o=this.toBBox,s=Fr(t,0,e,o),a=Fr(t,i-e,i,o),l=us(s)+us(a);for(let c=e;c<i-e;c++){let u=t.children[c];kr(s,t.leaf?o(u):u),l+=us(s)}for(let c=i-e-1;c>=e;c--){let u=t.children[c];kr(a,t.leaf?o(u):u),l+=us(a)}return l}_adjustParentBBoxes(t,e,i){for(let r=i;r>=0;r--)kr(e[r],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():Hn(t[e],this.toBBox)}};function O_(n,t,e){if(!e)return t.indexOf(n);for(let i=0;i<t.length;i++)if(e(n,t[i]))return i;return-1}function Hn(n,t){Fr(n,0,n.children.length,t,n)}function Fr(n,t,e,i,r){r||(r=$n(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let o=t;o<e;o++){let s=n.children[o];kr(r,n.leaf?i(s):s)}return r}function kr(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function D_(n,t){return n.minX-t.minX}function P_(n,t){return n.minY-t.minY}function bl(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function us(n){return n.maxX-n.minX+(n.maxY-n.minY)}function F_(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function k_(n,t){let e=Math.max(n.minX,t.minX),i=Math.max(n.minY,t.minY),r=Math.min(n.maxX,t.maxX),o=Math.min(n.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,o-i)}function Rl(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function hs(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function $n(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function zf(n,t,e,i,r){let o=[t,e];for(;o.length;){if(e=o.pop(),t=o.pop(),e-t<=i)continue;let s=t+Math.ceil((e-t)/i/2)*i;cs(n,s,t,e,r),o.push(t,s,s,e)}}var fs=[NaN,NaN,NaN,0],Al;function N_(){return Al||(Al=ut(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Al}var G_=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,z_=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,V_=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,W_=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ds(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function Gr(n){throw new Error('failed to parse "'+n+'" as color')}function Vf(n){if(n.toLowerCase().startsWith("rgb")){let o=n.match(z_)||n.match(G_)||n.match(V_);if(o){let s=o[4],a=100/255;return[at(ds(o[1],a)+.5|0,0,255),at(ds(o[2],a)+.5|0,0,255),at(ds(o[3],a)+.5|0,0,255),s!==void 0?at(ds(s,100),0,1):1]}Gr(n)}if(n.startsWith("#")){if(W_.test(n)){let o=n.substring(1),s=o.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=o.length;l<c;l+=s){let u=parseInt(o.substring(l,l+s),16);s===1&&(u+=u<<4),a[l/s]=u}return a[3]=a[3]/255,a}Gr(n)}let t=N_();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&Gr(n));let i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Vf(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);let r=Array.from(t.getImageData(0,0,1,1).data);return r[3]=An(r[3]/255,3),r}function Wf(n){return typeof n=="string"?n:Vr(n)}var X_=1024,Nr={},Ml=0;function Xf(n){if(n.length===4)return n;let t=n.slice();return t[3]=1,t}function Ll(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function Ol(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function Dl(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function Pl(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function Fl(n){let t=Dl(n[0]),e=Dl(n[1]),i=Dl(n[2]),r=Pl(t*.222488403+e*.716873169+i*.06060791),o=500*(Pl(t*.452247074+e*.399439023+i*.148375274)-r),s=200*(r-Pl(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(s,o)*(180/Math.PI);return[116*r-16,Math.sqrt(o*o+s*s),a<0?a+360:a,n[3]]}function Uf(n){let t=(n[0]+16)/116,e=n[1],i=n[2]*Math.PI/180,r=Ol(t),o=Ol(t+e/500*Math.cos(i)),s=Ol(t-e/200*Math.sin(i)),a=Ll(o*3.021973625-r*1.617392459-s*.404875592),l=Ll(o*-.943766287+r*1.916279586+s*.027607165),c=Ll(o*.069407491-r*.22898585+s*1.159737864);return[at(a+.5|0,0,255),at(l+.5|0,0,255),at(c+.5|0,0,255),n[3]]}function zr(n){if(n==="none")return fs;if(Nr.hasOwnProperty(n))return Nr[n];if(Ml>=X_){let e=0;for(let i in Nr)(e++&3)===0&&(delete Nr[i],--Ml)}let t=Vf(n);t.length!==4&&Gr(n);for(let e of t)isNaN(e)&&Gr(n);return Nr[n]=t,++Ml,t}function Ve(n){return Array.isArray(n)?n:zr(n)}function Vr(n){let t=n[0];t!=(t|0)&&(t=t+.5|0);let e=n[1];e!=(e|0)&&(e=e+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);let r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+r+")"}function kl(n){return n[0]>0&&n[1]>0}function Kf(n,t,e){return e===void 0&&(e=[0,0]),e[0]=n[0]*t+.5|0,e[1]=n[1]*t+.5|0,e}function Et(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}var cn=0;var Bt=1<<cn++,rt=1<<cn++,Ht=1<<cn++,he=1<<cn++,Vi=1<<cn++,Wr=1<<cn++,ps=Math.pow(2,cn)-1,zl={[Bt]:"boolean",[rt]:"number",[Ht]:"string",[he]:"color",[Vi]:"number[]",[Wr]:"size"},U_=Object.keys(zl).map(Number).sort(Jt);function K_(n){return n in zl}function Xr(n){let t=[];for(let e of U_)Ur(n,e)&&t.push(zl[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Ur(n,t){return(n&t)===t}function zi(n,t){return n===t}var Ct=class{constructor(t,e){if(!K_(t))throw new Error(`literal expressions must have a specific type, got ${Xr(t)}`);this.type=t,this.value=e}},Gl=class{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}};function Vl(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Nt(n,t,e){switch(typeof n){case"boolean":{if(zi(t,Ht))return new Ct(Ht,n?"true":"false");if(!Ur(t,Bt))throw new Error(`got a boolean, but expected ${Xr(t)}`);return new Ct(Bt,n)}case"number":{if(zi(t,Wr))return new Ct(Wr,Et(n));if(zi(t,Bt))return new Ct(Bt,!!n);if(zi(t,Ht))return new Ct(Ht,n.toString());if(!Ur(t,rt))throw new Error(`got a number, but expected ${Xr(t)}`);return new Ct(rt,n)}case"string":{if(zi(t,he))return new Ct(he,zr(n));if(zi(t,Bt))return new Ct(Bt,!!n);if(!Ur(t,Ht))throw new Error(`got a string, but expected ${Xr(t)}`);return new Ct(Ht,n)}default:}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return e0(n,t,e);for(let i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(zi(t,Wr)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Ct(Wr,n)}if(zi(t,he)){if(n.length===3)return new Ct(he,[...n,1]);if(n.length===4)return new Ct(he,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Ur(t,Vi))throw new Error(`got an array of numbers, but expected ${Xr(t)}`);return new Ct(Vi,n)}var w={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},B_={[w.Get]:U($(1,1/0),Bf),[w.Var]:U($(1,1),Y_),[w.Has]:U($(1,1/0),Bf),[w.Id]:U(j_,Qn),[w.Concat]:U($(2,1/0),ct(Ht)),[w.GeometryType]:U(Z_,Qn),[w.LineMetric]:U(Qn),[w.Resolution]:U(Nl,Qn),[w.Zoom]:U(Nl,Qn),[w.Time]:U(Nl,Qn),[w.Any]:U($(2,1/0),ct(Bt)),[w.All]:U($(2,1/0),ct(Bt)),[w.Not]:U($(1,1),ct(Bt)),[w.Equal]:U($(2,2),ct(ps)),[w.NotEqual]:U($(2,2),ct(ps)),[w.GreaterThan]:U($(2,2),ct(rt)),[w.GreaterThanOrEqualTo]:U($(2,2),ct(rt)),[w.LessThan]:U($(2,2),ct(rt)),[w.LessThanOrEqualTo]:U($(2,2),ct(rt)),[w.Multiply]:U($(2,1/0),Yf),[w.Coalesce]:U($(2,1/0),Yf),[w.Divide]:U($(2,2),ct(rt)),[w.Add]:U($(2,1/0),ct(rt)),[w.Subtract]:U($(2,2),ct(rt)),[w.Clamp]:U($(3,3),ct(rt)),[w.Mod]:U($(2,2),ct(rt)),[w.Pow]:U($(2,2),ct(rt)),[w.Abs]:U($(1,1),ct(rt)),[w.Floor]:U($(1,1),ct(rt)),[w.Ceil]:U($(1,1),ct(rt)),[w.Round]:U($(1,1),ct(rt)),[w.Sin]:U($(1,1),ct(rt)),[w.Cos]:U($(1,1),ct(rt)),[w.Atan]:U($(1,2),ct(rt)),[w.Sqrt]:U($(1,1),ct(rt)),[w.Match]:U($(4,1/0),jf,H_),[w.Between]:U($(3,3),ct(rt)),[w.Interpolate]:U($(6,1/0),jf,$_),[w.Case]:U($(3,1/0),q_,J_),[w.In]:U($(2,2),Q_),[w.Number]:U($(1,1/0),ct(ps)),[w.String]:U($(1,1/0),ct(ps)),[w.Array]:U($(1,1/0),ct(rt)),[w.Color]:U($(1,4),ct(rt)),[w.Band]:U($(1,3),ct(rt)),[w.Palette]:U($(2,2),t0),[w.ToString]:U($(1,1),ct(Bt|rt|Ht|he))};function Bf(n,t,e){let i=n.length-1,r=new Array(i);for(let o=0;o<i;++o){let s=n[o+1];switch(typeof s){case"number":{r[o]=new Ct(rt,s);break}case"string":{r[o]=new Ct(Ht,s);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${s}`)}o===0&&e.properties.add(String(s))}return r}function Y_(n,t,e){let i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new Ct(Ht,i)]}function j_(n,t,e){e.featureId=!0}function Z_(n,t,e){e.geometryType=!0}function Nl(n,t,e){e.mapState=!0}function Qn(n,t,e){let i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function $(n,t){return function(e,i,r){let o=e[0],s=e.length-1;if(n===t){if(s!==n){let a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${o}, got ${s}`)}}else if(s<n||s>t){let a=t===1/0?`${n} or more`:`${n} to ${t}`;throw new Error(`expected ${a} arguments for ${o}, got ${s}`)}}}function Yf(n,t,e){let i=n.length-1,r=new Array(i);for(let o=0;o<i;++o){let s=Nt(n[o+1],t,e);r[o]=s}return r}function ct(n){return function(t,e,i){let r=t.length-1,o=new Array(r);for(let s=0;s<r;++s){let a=Nt(t[s+1],n,i);o[s]=a}return o}}function q_(n,t,e){let i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function jf(n,t,e){let i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function H_(n,t,e){let i=n.length-1,r=Ht|rt|Bt,o=Nt(n[1],r,e),s=Nt(n[n.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{let c=Nt(n[l+2],o.type,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{let c=Nt(n[l+3],s.type,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[o,...a,s]}function $_(n,t,e){let i=n[1],r;switch(i[0]){case"linear":r=1;break;case"exponential":let l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}let o=new Ct(rt,r),s;try{s=Nt(n[2],rt,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}let a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{let c=Nt(n[l+3],rt,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{let c=Nt(n[l+4],t,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[o,s,...a]}function J_(n,t,e){let i=Nt(n[n.length-1],t,e),r=new Array(n.length-1);for(let o=0;o<r.length-1;o+=2){try{let s=Nt(n[o+1],Bt,e);r[o]=s}catch(s){throw new Error(`failed to parse argument ${o} of case expression: ${s.message}`)}try{let s=Nt(n[o+2],i.type,e);r[o+1]=s}catch(s){throw new Error(`failed to parse argument ${o+1} of case expression: ${s.message}`)}}return r[r.length-1]=i,r}function Q_(n,t,e){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Ht}else r=rt;let o=new Array(i.length);for(let a=0;a<o.length;a++)try{let l=Nt(i[a],r,e);o[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Nt(n[1],r,e),...o]}function t0(n,t,e){let i;try{i=Nt(n[1],rt,e)}catch(s){throw new Error(`failed to parse first argument in palette expression: ${s.message}`)}let r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");let o=new Array(r.length);for(let s=0;s<o.length;s++){let a;try{a=Nt(r[s],he,e)}catch(l){throw new Error(`failed to parse color at index ${s} in palette expression: ${l.message}`)}if(!(a instanceof Ct))throw new Error(`the palette color at index ${s} must be a literal value`);o[s]=a}return[i,...o]}function U(...n){return function(t,e,i){let r=t[0],o;for(let s=0;s<n.length;s++){let a=n[s](t,e,i);if(s==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");o=a}}return new Gl(e,r,...o)}}function e0(n,t,e){let i=n[0],r=B_[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,t,e)}function Wl(n){if(!n)return"";let t=n.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Wl(n.getGeometries()[0]);default:return""}}function Xl(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Je(n,t,e){let i=Nt(n,t,e);return We(i,e)}function We(n,t){if(n instanceof Ct){if(n.type===he&&typeof n.value=="string"){let i=zr(n.value);return function(){return i}}return function(){return n.value}}let e=n.operator;switch(e){case w.Number:case w.String:case w.Coalesce:return i0(n,t);case w.Get:case w.Var:case w.Has:return n0(n,t);case w.Id:return i=>i.featureId;case w.GeometryType:return i=>i.geometryType;case w.Concat:{let i=n.args.map(r=>We(r,t));return r=>"".concat(...i.map(o=>o(r).toString()))}case w.Resolution:return i=>i.resolution;case w.Any:case w.All:case w.Between:case w.In:case w.Not:return o0(n,t);case w.Equal:case w.NotEqual:case w.LessThan:case w.LessThanOrEqualTo:case w.GreaterThan:case w.GreaterThanOrEqualTo:return r0(n,t);case w.Multiply:case w.Divide:case w.Add:case w.Subtract:case w.Clamp:case w.Mod:case w.Pow:case w.Abs:case w.Floor:case w.Ceil:case w.Round:case w.Sin:case w.Cos:case w.Atan:case w.Sqrt:return s0(n,t);case w.Case:return a0(n,t);case w.Match:return l0(n,t);case w.Interpolate:return c0(n,t);case w.ToString:return u0(n,t);default:throw new Error(`Unsupported operator ${e}`)}}function i0(n,t){let e=n.operator,i=n.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=We(n.args[o],t);switch(e){case w.Coalesce:return o=>{for(let s=0;s<i;++s){let a=r[s](o);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case w.Number:case w.String:return o=>{for(let s=0;s<i;++s){let a=r[s](o);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function n0(n,t){let i=n.args[0].value;switch(n.operator){case w.Get:return r=>{let o=n.args,s=r.properties[i];for(let a=1,l=o.length;a<l;++a){let u=o[a].value;s=s[u]}return s};case w.Var:return r=>r.variables[i];case w.Has:return r=>{let o=n.args;if(!(i in r.properties))return!1;let s=r.properties[i];for(let a=1,l=o.length;a<l;++a){let u=o[a].value;if(!s||!Object.hasOwn(s,u))return!1;s=s[u]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function r0(n,t){let e=n.operator,i=We(n.args[0],t),r=We(n.args[1],t);switch(e){case w.Equal:return o=>i(o)===r(o);case w.NotEqual:return o=>i(o)!==r(o);case w.LessThan:return o=>i(o)<r(o);case w.LessThanOrEqualTo:return o=>i(o)<=r(o);case w.GreaterThan:return o=>i(o)>r(o);case w.GreaterThanOrEqualTo:return o=>i(o)>=r(o);default:throw new Error(`Unsupported comparison operator ${e}`)}}function o0(n,t){let e=n.operator,i=n.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=We(n.args[o],t);switch(e){case w.Any:return o=>{for(let s=0;s<i;++s)if(r[s](o))return!0;return!1};case w.All:return o=>{for(let s=0;s<i;++s)if(!r[s](o))return!1;return!0};case w.Between:return o=>{let s=r[0](o),a=r[1](o),l=r[2](o);return s>=a&&s<=l};case w.In:return o=>{let s=r[0](o);for(let a=1;a<i;++a)if(s===r[a](o))return!0;return!1};case w.Not:return o=>!r[0](o);default:throw new Error(`Unsupported logical operator ${e}`)}}function s0(n,t){let e=n.operator,i=n.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=We(n.args[o],t);switch(e){case w.Multiply:return o=>{let s=1;for(let a=0;a<i;++a)s*=r[a](o);return s};case w.Divide:return o=>r[0](o)/r[1](o);case w.Add:return o=>{let s=0;for(let a=0;a<i;++a)s+=r[a](o);return s};case w.Subtract:return o=>r[0](o)-r[1](o);case w.Clamp:return o=>{let s=r[0](o),a=r[1](o);if(s<a)return a;let l=r[2](o);return s>l?l:s};case w.Mod:return o=>r[0](o)%r[1](o);case w.Pow:return o=>Math.pow(r[0](o),r[1](o));case w.Abs:return o=>Math.abs(r[0](o));case w.Floor:return o=>Math.floor(r[0](o));case w.Ceil:return o=>Math.ceil(r[0](o));case w.Round:return o=>Math.round(r[0](o));case w.Sin:return o=>Math.sin(r[0](o));case w.Cos:return o=>Math.cos(r[0](o));case w.Atan:return i===2?o=>Math.atan2(r[0](o),r[1](o)):o=>Math.atan(r[0](o));case w.Sqrt:return o=>Math.sqrt(r[0](o));default:throw new Error(`Unsupported numeric operator ${e}`)}}function a0(n,t){let e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=We(n.args[r],t);return r=>{for(let o=0;o<e-1;o+=2)if(i[o](r))return i[o+1](r);return i[e-1](r)}}function l0(n,t){let e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=We(n.args[r],t);return r=>{let o=i[0](r);for(let s=1;s<e-1;s+=2)if(o===i[s](r))return i[s+1](r);return i[e-1](r)}}function c0(n,t){let e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=We(n.args[r],t);return r=>{let o=i[0](r),s=i[1](r),a,l;for(let c=2;c<e;c+=2){let u=i[c](r),h=i[c+1](r),d=Array.isArray(h);if(d&&(h=Xf(h)),u>=s)return c===2?h:d?h0(o,s,a,l,u,h):Kr(o,s,a,l,u,h);a=u,l=h}return l}}function u0(n,t){let e=n.operator,i=n.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=We(n.args[o],t);switch(e){case w.ToString:return o=>{let s=r[0](o);return n.args[0].type===he?Vr(s):s.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Kr(n,t,e,i,r,o){let s=r-e;if(s===0)return i;let a=t-e,l=n===1?a/s:(Math.pow(n,a)-1)/(Math.pow(n,s)-1);return i+l*(o-i)}function h0(n,t,e,i,r,o){if(r-e===0)return i;let a=Fl(i),l=Fl(o),c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);let u=[Kr(n,t,e,a[0],r,l[0]),Kr(n,t,e,a[1],r,l[1]),a[2]+Kr(n,t,e,0,r,c),Kr(n,t,e,i[3],r,o[3])];return Uf(u)}var X={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Zf(n,t,e){let i=n,r=!0,o=!1,s=!1,a=[In(i,P.LOAD,function(){s=!0,o||t()})];return i.src&&ua?(o=!0,i.decode().then(function(){r&&t()}).catch(function(l){r&&(s?t():e())})):a.push(In(i,P.ERROR,e)),function(){r=!1,a.forEach(st)}}function d0(n,t){return new Promise((e,i)=>{function r(){s(),e(n)}function o(){s(),i(new Error("Image load error"))}function s(){n.removeEventListener("load",r),n.removeEventListener("error",o)}n.addEventListener("load",r),n.addEventListener("error",o),t&&(n.src=t)})}function qf(n,t){return t&&(n.src=t),n.src&&ua?new Promise((e,i)=>n.decode().then(()=>e(n)).catch(r=>n.complete&&n.width?e(n):i(r))):d0(n)}var Kl=class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(let e in this.cache_){let i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){let r=Ul(t,e,i);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,i){let r=Ul(t,e,i);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,i,r,o){let s=Ul(t,e,i),a=s in this.cache_;this.cache_[s]=r,o&&(r.getImageState()===X.IDLE&&r.load(),r.getImageState()===X.LOADING?r.ready().then(()=>{this.patternCache_[s]=Bn().createPattern(r.getImage(1),"repeat")}):this.patternCache_[s]=Bn().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};function Ul(n,t,e){let i=e?Ve(e):"null";return t+":"+n+":"+i}var Yt=new Kl;var Br=null,ms=class extends Ri{constructor(t,e,i,r,o){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=o,this.imageState_=r===void 0?X.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===X.LOADED){Br||(Br=ut(1,1,void 0,{willReadFrequently:!0})),Br.drawImage(this.image_,0,0);try{Br.getImageData(0,0,1,1),this.tainted_=!1}catch{Br=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(P.CHANGE)}handleImageError_(){this.imageState_=X.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=X.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){let t=this.size_[0],e=this.size_[1],i=ut(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===X.IDLE){this.image_||this.initializeImage_(),this.imageState_=X.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&qf(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==X.LOADED)return;let e=this.image_,i=ut(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=Wf(this.color_),i.fillRect(0,0,r.width/t,r.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===X.LOADED||this.imageState_===X.ERROR)t();else{let e=()=>{(this.imageState_===X.LOADED||this.imageState_===X.ERROR)&&(this.removeEventListener(P.CHANGE,e),t())};this.addEventListener(P.CHANGE,e)}})),this.ready_}};function tr(n,t,e,i,r,o){let s=t===void 0?void 0:Yt.get(t,e,r);return s||(s=new ms(n,n&&"src"in n?n.src||void 0:t,e,i,r),Yt.set(t,e,r,s,o)),o&&s&&!Yt.getPattern(t,e,r)&&Yt.set(t,e,r,s,o),s}var Hf=ms;function ee(n){return n?Array.isArray(n)?Vr(n):typeof n=="object"&&"src"in n?f0(n):n:null}function f0(n){if(!n.offset||!n.size)return Yt.getPattern(n.src,"anonymous",n.color);let t=n.src+":"+n.offset,e=Yt.getPattern(t,void 0,n.color);if(e)return e;let i=Yt.get(n.src,"anonymous",null);if(i.getImageState()!==X.LOADED)return null;let r=ut(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),tr(r.canvas,t,void 0,X.LOADED,n.color,!0),Yt.getPattern(t,void 0,n.color)}var _s="10px sans-serif",Dt="#000",ti="round",ie=[],ne=0,ei="round",_i=10,xi="#000",Wi="center",un="middle",yi=[0,0,0,0],Ei=1,Qe=new At,er=null,Bl,Yl={},$f=function(){let t="32px ",e=["monospace","serif"],i=e.length,r="wmytzilWMYTZIL@#/&?$%10\uF013",o,s;function a(c,u,h){let d=!0;for(let f=0;f<i;++f){let p=e[f];if(s=gs(c+" "+u+" "+t+p,r),h!=p){let g=gs(c+" "+u+" "+t+h+","+p,r);d=d&&g!=s}}return!!d}function l(){let c=!0,u=Qe.getKeys();for(let h=0,d=u.length;h<d;++h){let f=u[h];if(Qe.get(f)<100){let[p,g,m]=f.split(`
`);a(p,g,m)?(je(Yl),er=null,Bl=void 0,Qe.set(f,100)):(Qe.set(f,Qe.get(f)+1,!0),c=!1)}}c&&(clearInterval(o),o=void 0)}return function(c){let u=il(c);if(!u)return;let h=u.families;for(let d=0,f=h.length;d<f;++d){let p=h[d],g=u.style+`
`+u.weight+`
`+p;Qe.get(g)===void 0&&(Qe.set(g,100,!0),a(u.style,u.weight,p)||(Qe.set(g,0,!0),o===void 0&&(o=setInterval(l,32))))}}}(),p0=function(){let n;return function(t){let e=Yl[t];if(e==null){if(Ao){let i=il(t),r=Jf(t,"\u017Dg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);Yl[t]=e}return e}}();function Jf(n,t){return er||(er=ut(1,1)),n!=Bl&&(er.font=n,Bl=er.font),er.measureText(t)}function gs(n,t){return Jf(n,t).width}function jl(n,t,e){if(t in e)return e[t];let i=t.split(`
`).reduce((r,o)=>Math.max(r,gs(n,o)),0);return e[t]=i,i}function Qf(n,t){let e=[],i=[],r=[],o=0,s=0,a=0,l=0;for(let c=0,u=t.length;c<=u;c+=2){let h=t[c];if(h===`
`||c===u){o=Math.max(o,s),r.push(s),s=0,a+=l,l=0;continue}let d=t[c+1]||n.font,f=gs(d,h);e.push(f),s+=f;let p=p0(d);i.push(p),l=Math.max(l,p)}return{width:o,height:a,widths:e,heights:i,lineWidths:r}}function tp(n,t,e,i,r,o,s,a,l,c,u){n.save(),e!==1&&(n.globalAlpha===void 0?n.globalAlpha=h=>h.globalAlpha*=e:n.globalAlpha*=e),t&&n.transform.apply(n,t),i.contextInstructions?(n.translate(l,c),n.scale(u[0],u[1]),m0(i,n)):u[0]<0||u[1]<0?(n.translate(l,c),n.scale(u[0],u[1]),n.drawImage(i,r,o,s,a,0,0,s,a)):n.drawImage(i,r,o,s,a,l,c,s*u[0],a*u[1]),n.restore()}function m0(n,t){let e=n.contextInstructions;for(let i=0,r=e.length;i<r;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}var Zl=class n{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Et(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){let t=this.getScale();return new n({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return J()}getImage(t){return J()}getHitDetectionImage(){return J()}getPixelRatio(t){return 1}getImageState(){return J()}getImageSize(){return J()}getOrigin(){return J()}getSize(){return J()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Et(t)}listenImageChange(t){J()}load(){J()}unlistenImageChange(t){J()}ready(){return Promise.resolve()}},xs=Zl;var ql=class n extends xs{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?X.LOADING:X.LOADED,this.imageState_===X.LOADING&&this.ready().then(()=>this.imageState_=X.LOADED),this.render()}clone(){let t=this.getScale(),e=new n({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){let t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.fill_?.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(","),r=Yt.get(i,null,null)?.getImage(1);if(!r){let o=this.renderOptions_,s=Math.ceil(o.size*t),a=ut(s,s);this.draw_(o,a,t),r=a.canvas,Yt.set(i,null,null,new Hf(r,void 0,null,X.LOADED,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius,o=this.radius2_===void 0?r:this.radius2_;if(r<o){let v=r;r=o,o=v}let s=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/s,l=o*Math.sin(a),c=Math.sqrt(o*o-l*l),u=r-c,h=Math.sqrt(l*l+u*u),d=h/l;if(t==="miter"&&d<=i)return d*e;let f=e/2/d,p=e/2*(u/h),m=Math.sqrt((r+f)*(r+f)+p*p)-r;if(this.radius2_===void 0||t==="bevel")return m*2;let _=r*Math.sin(a),x=Math.sqrt(r*r-_*_),C=o-x,E=Math.sqrt(_*_+C*C)/_;if(E<=i){let v=E*e/2-o-r;return 2*Math.max(m,v)}return m*2}createRenderOptions(){let t=ti,e=ei,i=0,r=null,o=0,s,a=0;this.stroke_&&(s=ee(this.stroke_.getColor()??xi),a=this.stroke_.getWidth()??Ei,r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??ei,t=this.stroke_.getLineCap()??ti,i=this.stroke_.getMiterLimit()??_i);let l=this.calculateLineJoinSize_(e,a,i),c=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*c+l);return{strokeStyle:s,strokeWidth:a,size:u,lineCap:t,lineDash:r,lineDashOffset:o,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();let t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=Dt),e.fillStyle=ee(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=Ve(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(e=ut(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_,i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{let r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);let o=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let a=0;a<e;a++){let l=o+a*s,c=a%2===0?i:r;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Dt,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}},ys=ql;var Hl=class n extends ys{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){let t=this.getScale(),e=new n({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}},Es=Hl;var $l=class n{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){let t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){let e=tr(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===X.IDLE&&e.load(),e.getImageState()===X.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){let t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?B(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:Ve(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}},ir=$l;function ep(n,t,e,i){return e!==void 0&&i!==void 0?[e/n,i/t]:e!==void 0?e/n:i!==void 0?i/t:1}var Jl=class n extends xs{constructor(t){t=t||{};let e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,o=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:o,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;let s=t.img!==void 0?t.img:null,a=t.src;j(!(a!==void 0&&s),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&s&&(a=s.src||B(s)),j(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),j(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=X.IDLE:s!==void 0&&("complete"in s?s.complete?l=s.src?X.LOADED:X.IDLE:l=X.LOADING:l=X.LOADED),this.color_=t.color!==void 0?Ve(t.color):null,this.iconImage_=tr(s,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,u;if(t.size)[c,u]=t.size;else{let h=this.getImage(1);if(h.width&&h.height)c=h.width,u=h.height;else if(h instanceof HTMLImageElement){this.initialOptions_=t;let d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;let f=this.iconImage_.getSize();this.setScale(ep(f[0],f[1],t.width,t.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(ep(c,u,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new n({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;let r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}let e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){let e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){let t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==X.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){let t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==X.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(P.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(P.CHANGE,t)}ready(){return this.iconImage_.ready()}},hn=Jl;var Ql=class n{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){let t=this.getColor();return new n({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}},Cs=Ql;var ws=class n{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=ip,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new n({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=ip,this.geometry_=t}setZIndex(t){this.zIndex_=t}};function np(n){let t;if(typeof n=="function")t=n;else{let e;Array.isArray(n)?e=n:(j(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[n]),t=function(){return e}}return t}var tc=null;function ec(n,t){if(!tc){let e=new ir({color:"rgba(255,255,255,0.4)"}),i=new Cs({color:"#3399CC",width:1.25});tc=[new ws({image:new Es({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return tc}function ip(n){return n.getGeometry()}var Ci=ws;var g0="#333",ic=class n{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Et(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ir({color:g0}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){let t=this.getScale();return new n({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Et(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}},rp=ic;function _0(n){return!0}function lp(n){let t=Vl(),e=x0(n,t),i=Xl();return function(r,o){if(i.properties=r.getPropertiesInternal(),i.resolution=o,t.featureId){let s=r.getId();s!==void 0?i.featureId=s:i.featureId=null}return t.geometryType&&(i.geometryType=Wl(r.getGeometry())),e(i)}}function oc(n){let t=Vl(),e=n.length,i=new Array(e);for(let s=0;s<e;++s)i[s]=nc(n[s],t);let r=Xl(),o=new Array(e);return function(s,a){if(r.properties=s.getPropertiesInternal(),r.resolution=a,t.featureId){let c=s.getId();c!==void 0?r.featureId=c:r.featureId=null}let l=0;for(let c=0;c<e;++c){let u=i[c](r);u&&(o[l]=u,l+=1)}return o.length=l,o}}function x0(n,t){let e=n.length,i=new Array(e);for(let r=0;r<e;++r){let o=n[r],s="filter"in o?Je(o.filter,Bt,t):_0,a;if(Array.isArray(o.style)){let l=o.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=nc(o.style[c],t)}else a=[nc(o.style,t)];i[r]={filter:s,styles:a}}return function(r){let o=[],s=!1;for(let a=0;a<e;++a){let l=i[a].filter;if(l(r)&&!(n[a].else&&s)){s=!0;for(let c of i[a].styles){let u=c(r);u&&o.push(u)}}}return o}}function nc(n,t){let e=Yr(n,"",t),i=jr(n,"",t),r=y0(n,t),o=E0(n,t),s=re(n,"z-index",t);if(!e&&!i&&!r&&!o&&!Pe(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));let a=new Ci;return function(l){let c=!0;if(e){let u=e(l);u&&(c=!1),a.setFill(u)}if(i){let u=i(l);u&&(c=!1),a.setStroke(u)}if(r){let u=r(l);u&&(c=!1),a.setText(u)}if(o){let u=o(l);u&&(c=!1),a.setImage(u)}return s&&a.setZIndex(s(l)),c?null:a}}function Yr(n,t,e){let i;if(t+"fill-pattern-src"in n)i=S0(n,t+"fill-",e);else{if(n[t+"fill-color"]==="none")return o=>null;i=sc(n,t+"fill-color",e)}if(!i)return null;let r=new ir;return function(o){let s=i(o);return s===fs?null:(r.setColor(s),r)}}function jr(n,t,e){let i=re(n,t+"stroke-width",e),r=sc(n,t+"stroke-color",e);if(!i&&!r)return null;let o=wi(n,t+"stroke-line-cap",e),s=wi(n,t+"stroke-line-join",e),a=cp(n,t+"stroke-line-dash",e),l=re(n,t+"stroke-line-dash-offset",e),c=re(n,t+"stroke-miter-limit",e),u=new Cs;return function(h){if(r){let d=r(h);if(d===fs)return null;u.setColor(d)}if(i&&u.setWidth(i(h)),o){let d=o(h);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(d)}if(s){let d=s(h);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(d)}return a&&u.setLineDash(a(h)),l&&u.setLineDashOffset(l(h)),c&&u.setMiterLimit(c(h)),u}}function y0(n,t){let e="text-",i=wi(n,e+"value",t);if(!i)return null;let r=Yr(n,e,t),o=Yr(n,e+"background-",t),s=jr(n,e,t),a=jr(n,e+"background-",t),l=wi(n,e+"font",t),c=re(n,e+"max-angle",t),u=re(n,e+"offset-x",t),h=re(n,e+"offset-y",t),d=nr(n,e+"overflow",t),f=wi(n,e+"placement",t),p=re(n,e+"repeat",t),g=Ts(n,e+"scale",t),m=nr(n,e+"rotate-with-view",t),_=re(n,e+"rotation",t),x=wi(n,e+"align",t),C=wi(n,e+"justify",t),y=wi(n,e+"baseline",t),E=nr(n,e+"keep-upright",t),v=cp(n,e+"padding",t),T=Is(n,e+"declutter-mode"),S=new rp({declutterMode:T});return function(I){if(S.setText(i(I)),r&&S.setFill(r(I)),o&&S.setBackgroundFill(o(I)),s&&S.setStroke(s(I)),a&&S.setBackgroundStroke(a(I)),l&&S.setFont(l(I)),c&&S.setMaxAngle(c(I)),u&&S.setOffsetX(u(I)),h&&S.setOffsetY(h(I)),d&&S.setOverflow(d(I)),f){let D=f(I);if(D!=="point"&&D!=="line")throw new Error("Expected point or line for text-placement");S.setPlacement(D)}if(p&&S.setRepeat(p(I)),g&&S.setScale(g(I)),m&&S.setRotateWithView(m(I)),_&&S.setRotation(_(I)),x){let D=x(I);if(D!=="left"&&D!=="center"&&D!=="right"&&D!=="end"&&D!=="start")throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(D)}if(C){let D=C(I);if(D!=="left"&&D!=="right"&&D!=="center")throw new Error("Expected left, right, or center for text-justify");S.setJustify(D)}if(y){let D=y(I);if(D!=="bottom"&&D!=="top"&&D!=="middle"&&D!=="alphabetic"&&D!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(D)}return v&&S.setPadding(v(I)),E&&S.setKeepUpright(E(I)),S}}function E0(n,t){return"icon-src"in n?C0(n,t):"shape-points"in n?w0(n,t):"circle-radius"in n?v0(n,t):null}function C0(n,t){let e="icon-",i=e+"src",r=up(n[i],i),o=vs(n,e+"anchor",t),s=Ts(n,e+"scale",t),a=re(n,e+"opacity",t),l=vs(n,e+"displacement",t),c=re(n,e+"rotation",t),u=nr(n,e+"rotate-with-view",t),h=sp(n,e+"anchor-origin"),d=ap(n,e+"anchor-x-units"),f=ap(n,e+"anchor-y-units"),p=R0(n,e+"color"),g=I0(n,e+"cross-origin"),m=b0(n,e+"offset"),_=sp(n,e+"offset-origin"),x=Ss(n,e+"width"),C=Ss(n,e+"height"),y=T0(n,e+"size"),E=Is(n,e+"declutter-mode"),v=new hn({src:r,anchorOrigin:h,anchorXUnits:d,anchorYUnits:f,color:p,crossOrigin:g,offset:m,offsetOrigin:_,height:C,width:x,size:y,declutterMode:E});return function(T){return a&&v.setOpacity(a(T)),l&&v.setDisplacement(l(T)),c&&v.setRotation(c(T)),u&&v.setRotateWithView(u(T)),s&&v.setScale(s(T)),o&&v.setAnchor(o(T)),v}}function w0(n,t){let e="shape-",i=e+"points",r=e+"radius",o=rc(n[i],i),s=rc(n[r],r),a=Yr(n,e,t),l=jr(n,e,t),c=Ts(n,e+"scale",t),u=vs(n,e+"displacement",t),h=re(n,e+"rotation",t),d=nr(n,e+"rotate-with-view",t),f=Ss(n,e+"radius2"),p=Ss(n,e+"angle"),g=Is(n,e+"declutter-mode"),m=new ys({points:o,radius:s,radius2:f,angle:p,declutterMode:g});return function(_){return a&&m.setFill(a(_)),l&&m.setStroke(l(_)),u&&m.setDisplacement(u(_)),h&&m.setRotation(h(_)),d&&m.setRotateWithView(d(_)),c&&m.setScale(c(_)),m}}function v0(n,t){let e="circle-",i=Yr(n,e,t),r=jr(n,e,t),o=re(n,e+"radius",t),s=Ts(n,e+"scale",t),a=vs(n,e+"displacement",t),l=re(n,e+"rotation",t),c=nr(n,e+"rotate-with-view",t),u=Is(n,e+"declutter-mode"),h=new Es({radius:5,declutterMode:u});return function(d){return o&&h.setRadius(o(d)),i&&h.setFill(i(d)),r&&h.setStroke(r(d)),a&&h.setDisplacement(a(d)),l&&h.setRotation(l(d)),c&&h.setRotateWithView(c(d)),s&&h.setScale(s(d)),h}}function re(n,t,e){if(!(t in n))return;let i=Je(n[t],rt,e);return function(r){return rc(i(r),t)}}function wi(n,t,e){if(!(t in n))return null;let i=Je(n[t],Ht,e);return function(r){return up(i(r),t)}}function S0(n,t,e){let i=wi(n,t+"pattern-src",e),r=op(n,t+"pattern-offset",e),o=op(n,t+"pattern-size",e),s=sc(n,t+"color",e);return function(a){return{src:i(a),offset:r&&r(a),size:o&&o(a),color:s&&s(a)}}}function nr(n,t,e){if(!(t in n))return null;let i=Je(n[t],Bt,e);return function(r){let o=i(r);if(typeof o!="boolean")throw new Error(`Expected a boolean for ${t}`);return o}}function sc(n,t,e){if(!(t in n))return null;let i=Je(n[t],he,e);return function(r){return hp(i(r),t)}}function cp(n,t,e){if(!(t in n))return null;let i=Je(n[t],Vi,e);return function(r){return Zr(i(r),t)}}function vs(n,t,e){if(!(t in n))return null;let i=Je(n[t],Vi,e);return function(r){let o=Zr(i(r),t);if(o.length!==2)throw new Error(`Expected two numbers for ${t}`);return o}}function op(n,t,e){if(!(t in n))return null;let i=Je(n[t],Vi,e);return function(r){return dp(i(r),t)}}function Ts(n,t,e){if(!(t in n))return null;let i=Je(n[t],Vi|rt,e);return function(r){return A0(i(r),t)}}function Ss(n,t){let e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function T0(n,t){let e=n[t];if(e!==void 0){if(typeof e=="number")return Et(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function I0(n,t){let e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function sp(n,t){let e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function ap(n,t){let e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function b0(n,t){let e=n[t];if(e!==void 0)return Zr(e,t)}function Is(n,t){let e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function R0(n,t){let e=n[t];if(e!==void 0)return hp(e,t)}function Zr(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);let e=n.length;for(let i=0;i<e;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function up(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function rc(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function hp(n,t){if(typeof n=="string")return n;let e=Zr(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function dp(n,t){let e=Zr(n,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function A0(n,t){return typeof n=="number"?n:dp(n,t)}var fp={RENDER_ORDER:"renderOrder"},ac=class extends ln{constructor(t){t=t||{};let e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(fp.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){let i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new Jn(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(fp.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?ec:t;let e=M0(t);this.styleFunction_=t===null?void 0:np(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}};function M0(n){if(n===void 0)return ec;if(!n)return null;if(typeof n=="function"||n instanceof Ci)return n;if(!Array.isArray(n))return oc([n]);if(n.length===0)return[];let t=n.length,e=n[0];if(e instanceof Ci){let r=new Array(t);for(let o=0;o<t;++o){let s=n[o];if(!(s instanceof Ci))throw new Error("Expected a list of style instances");r[o]=s}return r}if("style"in e){let r=new Array(t);for(let o=0;o<t;++o){let s=n[o];if(!("style"in s))throw new Error("Expected a list of rules with a style property");r[o]=s}return lp(r)}return oc(n)}var bs=ac;var lc=class extends Rt{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}},Rs=lc;var cc=class extends bi{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){J()}calculateMatrices2D(t){let e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;zt(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Ho(r,i)}forEachFeatureAtCoordinate(t,e,i,r,o,s,a,l){let c,u=e.viewState;function h(y,E,v,T){return o.call(s,E,y?v:null,T)}let d=u.projection,f=zo(t.slice(),d),p=[[0,0]];if(d.canWrapX()&&r){let y=d.getExtent(),E=H(y);p.push([-E,0],[E,0])}let g=e.layerStatesArray,m=g.length,_=[],x=[];for(let y=0;y<p.length;y++)for(let E=m-1;E>=0;--E){let v=g[E],T=v.layer;if(T.hasRenderer()&&Dr(v,u)&&a.call(l,T)){let S=T.getRenderer(),I=T.getSource();if(S&&I){let D=I.getWrapX()?f:t,K=h.bind(null,v.managed);x[0]=D[0]+p[y][0],x[1]=D[1]+p[y][1],c=S.forEachFeatureAtCoordinate(x,e,i,K,_)}if(c)return c}}if(_.length===0)return;let C=1/_.length;return _.forEach((y,E)=>y.distanceSq+=E*C),_.sort((y,E)=>y.distanceSq-E.distanceSq),_.some(y=>c=y.callback(y.feature,y.layer,y.geometry)),c}hasFeatureAtCoordinate(t,e,i,r,o,s){return this.forEachFeatureAtCoordinate(t,e,i,r,Ce,this,o,s)!==void 0}getMap(){return this.map_}renderFrame(t){J()}scheduleExpireIconCache(t){Yt.canExpireCache()&&t.postRenderFunctions.push(L0)}};function L0(n,t){Yt.expire()}var pp=cc;var uc=class extends pp{constructor(t){super(t),this.fontChangeListenerKey_=Z(Qe,De.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");let e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Ni+" ol-layers";let i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){let i=this.getMap();if(i.hasListener(t)){let r=new Rs(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){st(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Vt.PRECOMPOSE,t);let e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof bs&&a.layer.getDeclutter())&&(t.declutter={});let r=t.viewState;this.children_.length=0;let o=[],s=null;for(let a=0,l=e.length;a<l;++a){let c=e[a];t.layerIndex=a;let u=c.layer,h=u.getSourceState();if(!Dr(c,r)||h!="ready"&&h!="undefined"){u.unrender();continue}let d=u.render(t,s);d&&(d!==s&&(this.children_.push(d),s=d),o.push(c))}this.declutter(t,o),gf(this.element_,this.children_),this.dispatchRenderEvent(Vt.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){let r=e[i],o=r.layer;o.getDeclutter()&&o.renderDeclutter(t,r)}e.forEach(i=>i.layer.renderDeferred(t))}}},mp=uc;function gp(n){if(n instanceof ln){n.setMapInternal(null);return}n instanceof Or&&n.getLayers().forEach(gp)}function _p(n,t){if(n instanceof ln){n.setMapInternal(t);return}if(n instanceof Or){let e=n.getLayers().getArray();for(let i=0,r=e.length;i<r;++i)_p(e[i],t)}}var hc=class extends At{constructor(t){super(),t=t||{},this.on,this.once,this.un;let e=O0(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Hh,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=kt(),this.pixelToCoordinateTransform_=kt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||Ef(),this.interactions=e.interactions||Gf({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Qh(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Gt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Gt.VIEW,this.handleViewChanged_),this.addChangeListener(Gt.SIZE,this.handleSizeChanged_),this.addChangeListener(Gt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);let i=this;t.view&&!(t.view instanceof ue)&&t.view.then(function(r){i.setView(new ue(r))}),this.controls.addEventListener(Ft.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Ft.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Ft.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Ft.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Ft.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Ft.REMOVE,r=>{let o=r.element.getId();o!==void 0&&delete this.overlayIdIndex_[o.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){_p(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){let e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;let r=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};let o=i.hitTolerance!==void 0?i.hitTolerance:0,s=i.layerFilter!==void 0?i.layerFilter:Ce,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,o,a,e,null,s,null)}getFeaturesAtPixel(t,e){let i=[];return this.forEachFeatureAtPixel(t,function(r){i.push(r)},e),i}getAllLayers(){let t=[];function e(i){i.forEach(function(r){r instanceof Or?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;let i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};let r=e.layerFilter!==void 0?e.layerFilter:Ce,o=e.hitTolerance!==void 0?e.hitTolerance:0,s=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,o,s,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){let i=this.viewport_.getBoundingClientRect(),r=this.getSize(),o=i.width/r[0],s=i.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-i.left)/o,(a.clientY-i.top)/s]}getTarget(){return this.get(Gt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Tr(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){let e=this.frameState_;return e?xt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){let e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Gt.LAYERGROUP)}setLayers(t){let e=this.getLayerGroup();if(t instanceof Tt){e.setLayers(t);return}let i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){let t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){let r=t[e];if(!r.visible)continue;let o=r.layer.getRenderer();if(o&&!o.ready)return!0;let s=r.layer.getSource();if(s&&s.loading)return!0}return!1}getPixelFromCoordinate(t){let e=Qt(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){let e=this.frameState_;return e?xt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Gt.SIZE)}getView(){return this.get(Gt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){let t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return td(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){e=e||t.type;let i=new Ze(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;let e=t.originalEvent,i=e.type;if(i===xr.POINTERDOWN||i===P.WHEEL||i===P.KEYDOWN){let r=this.getOwnerDocument(),o=this.viewport_.getRootNode?this.viewport_.getRootNode():r,s=e.target,a=o instanceof ShadowRoot?o.host===s?o.host.ownerDocument:o:o===r?r.documentElement:o;if(this.overlayContainerStopEvent_.contains(s)||!a.contains(s))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){let r=this.getInteractions().getArray().slice();for(let o=r.length-1;o>=0;o--){let s=r[o];if(s.getMap()!==this||!s.getActive()||!this.getTargetElement())continue;if(!s.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){let t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,o=r;if(t){let s=t.viewHints;if(s[Ot.ANIMATING]||s[Ot.INTERACTING]){let a=Date.now()-t.time>8;r=a?0:8,o=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,o))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(Vt.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Vt.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ai(qe.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ai(qe.LOADSTART,this,t))));let i=this.postRenderFunctions_;if(t)for(let r=0,o=i.length;r<o;++r)i[r](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)st(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(P.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(P.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);let i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}let t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new mp(this)),this.mapBrowserEventHandler_=new $h(this,this.moveTolerance_);for(let o in dt)this.mapBrowserEventHandler_.addEventListener(dt[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(P.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(P.WHEEL,this.boundHandleBrowserEvent_,Mo?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{let o=e.getRootNode();i=o instanceof ShadowRoot?o.host:e}this.targetChangeHandlerKeys_=[Z(i,P.KEYDOWN,this.handleBrowserEvent,this),Z(i,P.KEYPRESS,this.handleBrowserEvent,this)];let r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(st(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(st(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);let t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Z(t,De.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Z(t,P.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(st),this.layerGroupPropertyListenerKeys_=null);let t=this.getLayerGroup();t&&(this.handleLayerAdd_(new ze("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Z(t,De.PROPERTYCHANGE,this.render,this),Z(t,P.CHANGE,this.render,this),Z(t,"addlayer",this.handleLayerAdd_,this),Z(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){let t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){let r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){gp(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){let e=this.getSize(),i=this.getView(),r=this.frameState_,o=null;if(e!==void 0&&kl(e)&&i&&i.isDef()){let s=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:vr(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:s,wantedTiles:{},mapId:B(this),renderTargets:{}},a.nextCenter&&a.nextResolution){let l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;o.nextExtent=vr(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=o,this.renderer_.renderFrame(o),o&&(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),r&&(!this.previousExtent_||!Mi(this.previousExtent_)&&!fi(o.extent,this.previousExtent_))&&(this.dispatchEvent(new Ai(qe.MOVESTART,this,r)),this.previousExtent_=Qi(this.previousExtent_)),this.previousExtent_&&!o.viewHints[Ot.ANIMATING]&&!o.viewHints[Ot.INTERACTING]&&!fi(o.extent,this.previousExtent_)&&(this.dispatchEvent(new Ai(qe.MOVEEND,this,o)),Po(o.extent,this.previousExtent_))),this.dispatchEvent(new Ai(qe.POSTRENDER,this,o)),this.renderComplete_=(this.hasListener(qe.LOADSTART)||this.hasListener(qe.LOADEND)||this.hasListener(Vt.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){let e=this.getLayerGroup();e&&this.handleLayerRemove_(new ze("removelayer",e)),this.set(Gt.LAYERGROUP,t)}setSize(t){this.set(Gt.SIZE,t)}setTarget(t){this.set(Gt.TARGET,t)}setView(t){if(!t||t instanceof ue){this.set(Gt.VIEW,t);return}this.set(Gt.VIEW,new ue);let e=this;t.then(function(i){e.setView(new ue(i))})}updateSize(){let t=this.getTargetElement(),e;if(t){let r=getComputedStyle(t),o=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),s=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(o)&&!isNaN(s)&&(e=[Math.max(0,o),Math.max(0,s)],!kl(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Vo("No map visible because the map container's width or height are 0."))}let i=this.getSize();e&&(!i||!Ut(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){let e=this.getView();e&&e.setViewportSize(t)}};function O0(n){let t=null;n.keyboardEventTarget!==void 0&&(t=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);let e={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Or({layers:n.layers});e[Gt.LAYERGROUP]=i,e[Gt.TARGET]=n.target,e[Gt.VIEW]=n.view instanceof ue?n.view:new ue;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Tt(n.controls.slice()):(j(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let o;n.interactions!==void 0&&(Array.isArray(n.interactions)?o=new Tt(n.interactions.slice()):(j(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),o=n.interactions));let s;return n.overlays!==void 0?Array.isArray(n.overlays)?s=new Tt(n.overlays.slice()):(j(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),s=n.overlays):s=new Tt,{controls:r,interactions:o,keyboardEventTarget:t,overlays:s,values:e}}var xp=hc;var dc=class extends Ri{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(P.CHANGE)}release(){this.setState(k.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==k.EMPTY){if(this.state!==k.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){J()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;let r=e-i+1e3/60;return r>=this.transition_?1:Ea(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},rr=dc;function As(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}var D0=new Error("disposed");var P0=[256,256],fc=class extends rr{constructor(t){let e=k.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;let t=As(this.data_);return t?[t.width,t.height]:P0}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==k.IDLE&&this.state!==k.ERROR)return;this.state=k.LOADING,this.changed();let t=this;this.loader_().then(function(e){t.data_=e,t.state=k.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=k.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(D0),this.controller_=null),super.disposeInternal()}},pc=fc;var mc=class extends rr{constructor(t,e,i,r,o,s){super(t,e,s),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=o}getImage(){return this.image_}setImage(t){this.image_=t,this.state=k.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=k.ERROR,this.unlistenImage_(),this.image_=F0(),this.changed()}handleImageLoad_(){let t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=k.LOADED:this.state=k.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==k.ERROR&&(this.state=k.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==k.IDLE&&(this.state=k.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Zf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};function F0(){let n=ut(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}var Ms=mc;var Ls=class{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}};function dn(n,t,e,i,r){return r!==void 0?(r.minX=n,r.maxX=t,r.minY=e,r.maxY=i,r):new Ls(n,t,e,i)}var Os=Ls;var gc,fn=[];function yp(n,t,e,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,r)),n.restore()}function _c(n,t){return Math.abs(n[t*4]-210)>2||Math.abs(n[t*4+3]-.75*255)>2}function k0(){if(gc===void 0){let n=ut(6,6,fn);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",yp(n,4,5,4,0),yp(n,4,5,0,5);let t=n.getImageData(0,0,3,3).data;gc=_c(t,0)||_c(t,4)||_c(t,8),sn(n),fn.push(n.canvas)}return gc}function Ep(n,t,e,i){let r=Oi(e,t,n),o=Da(t,i,e),s=t.getMetersPerUnit();s!==void 0&&(o*=s);let a=n.getMetersPerUnit();a!==void 0&&(o/=a);let l=n.getExtent();if(!l||Ne(l,r)){let c=Da(n,o,r)/o;isFinite(c)&&c>0&&(o/=c)}return o}function Cp(n,t,e,i){let r=ve(e),o=Ep(n,t,r,i);return(!isFinite(o)||o<=0)&&No(e,function(s){return o=Ep(n,t,s,i),isFinite(o)&&o>0}),o}function wp(n,t,e,i,r,o,s,a,l,c,u,h,d,f){let p=ut(Math.round(e*n),Math.round(e*t),fn);if(h||(p.imageSmoothingEnabled=!1),l.length===0)return p.canvas;p.scale(e,e);function g(E){return Math.round(E*e)/e}p.globalCompositeOperation="lighter";let m=It();l.forEach(function(E,v,T){rd(m,E.extent)});let _,x=e/i,C=(h?1:1+Math.pow(2,-24))/x;if(!d||l.length!==1||c!==0){if(_=ut(Math.round(H(m)*x),Math.round(mt(m)*x),fn),h||(_.imageSmoothingEnabled=!1),r&&f){let E=(r[0]-m[0])*x,v=-(r[3]-m[3])*x,T=H(r)*x,S=mt(r)*x;_.rect(E,v,T,S),_.clip()}l.forEach(function(E,v,T){if(E.image.width>0&&E.image.height>0){if(E.clipExtent){_.save();let G=(E.clipExtent[0]-m[0])*x,F=-(E.clipExtent[3]-m[3])*x,tt=H(E.clipExtent)*x,W=mt(E.clipExtent)*x;_.rect(h?G:Math.round(G),h?F:Math.round(F),h?tt:Math.round(G+tt)-Math.round(G),h?W:Math.round(F+W)-Math.round(F)),_.clip()}let S=(E.extent[0]-m[0])*x,I=-(E.extent[3]-m[3])*x,D=H(E.extent)*x,K=mt(E.extent)*x;_.drawImage(E.image,c,c,E.image.width-2*c,E.image.height-2*c,h?S:Math.round(S),h?I:Math.round(I),h?D:Math.round(S+D)-Math.round(S),h?K:Math.round(I+K)-Math.round(I)),E.clipExtent&&_.restore()}})}let y=Se(s);return a.getTriangles().forEach(function(E,v,T){let S=E.source,I=E.target,D=S[0][0],K=S[0][1],G=S[1][0],F=S[1][1],tt=S[2][0],W=S[2][1],Y=g((I[0][0]-y[0])/o),N=g(-(I[0][1]-y[1])/o),V=g((I[1][0]-y[0])/o),q=g(-(I[1][1]-y[1])/o),ot=g((I[2][0]-y[0])/o),ht=g(-(I[2][1]-y[1])/o),b=D,Wt=K;D=0,K=0,G-=b,F-=Wt,tt-=b,W-=Wt;let jt=[[G,F,0,0,V-Y],[tt,W,0,0,ot-Y],[0,0,G,F,q-N],[0,0,tt,W,ht-N]],wt=id(jt);if(!wt)return;if(p.save(),p.beginPath(),k0()||!h){p.moveTo(V,q);let Xt=4,Ue=Y-V,Ae=N-q;for(let se=0;se<Xt;se++)p.lineTo(V+g((se+1)*Ue/Xt),q+g(se*Ae/(Xt-1))),se!=Xt-1&&p.lineTo(V+g((se+1)*Ue/Xt),q+g((se+1)*Ae/(Xt-1)));p.lineTo(ot,ht)}else p.moveTo(V,q),p.lineTo(Y,N),p.lineTo(ot,ht);p.clip(),p.transform(wt[0],wt[2],wt[1],wt[3],Y,N),p.translate(m[0]-b,m[3]-Wt);let oe;if(_)oe=_.canvas,p.scale(C,-C);else{let Xt=l[0],Ue=Xt.extent;oe=Xt.image,p.scale(H(Ue)/oe.width,-mt(Ue)/oe.height)}p.drawImage(oe,0,0),p.restore()}),_&&(sn(_),fn.push(_.canvas)),u&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach(function(E,v,T){let S=E.target,I=(S[0][0]-y[0])/o,D=-(S[0][1]-y[1])/o,K=(S[1][0]-y[0])/o,G=-(S[1][1]-y[1])/o,F=(S[2][0]-y[0])/o,tt=-(S[2][1]-y[1])/o;p.beginPath(),p.moveTo(K,G),p.lineTo(I,D),p.lineTo(F,tt),p.closePath(),p.stroke()}),p.restore()),p.canvas}var N0=10,vp=.25,xc=class{constructor(t,e,i,r,o,s,a){this.sourceProj_=t,this.targetProj_=e;let l={},c=a?Od(C=>xt(a,Oi(C,this.targetProj_,this.sourceProj_))):on(this.targetProj_,this.sourceProj_);this.transformInv_=function(C){let y=C[0]+"/"+C[1];return l[y]||(l[y]=c(C)),l[y]},this.maxSourceExtent_=r,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&H(r)>=H(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?H(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?H(this.targetProj_.getExtent()):null;let u=Se(i),h=Pn(i),d=Dn(i),f=On(i),p=this.transformInv_(u),g=this.transformInv_(h),m=this.transformInv_(d),_=this.transformInv_(f),x=N0+(s?Math.max(0,Math.ceil(Math.log2(wr(i)/(s*s*256*256)))):0);if(this.addQuad_(u,h,d,f,p,g,m,_,x),this.wrapsXInSource_){let C=1/0;this.triangles_.forEach(function(y,E,v){C=Math.min(C,y.source[0][0],y.source[1][0],y.source[2][0])}),this.triangles_.forEach(y=>{if(Math.max(y.source[0][0],y.source[1][0],y.source[2][0])-C>this.sourceWorldWidth_/2){let E=[[y.source[0][0],y.source[0][1]],[y.source[1][0],y.source[1][1]],[y.source[2][0],y.source[2][1]]];E[0][0]-C>this.sourceWorldWidth_/2&&(E[0][0]-=this.sourceWorldWidth_),E[1][0]-C>this.sourceWorldWidth_/2&&(E[1][0]-=this.sourceWorldWidth_),E[2][0]-C>this.sourceWorldWidth_/2&&(E[2][0]-=this.sourceWorldWidth_);let v=Math.min(E[0][0],E[1][0],E[2][0]);Math.max(E[0][0],E[1][0],E[2][0])-v<this.sourceWorldWidth_/2&&(y.source=E)}})}l={}}addTriangle_(t,e,i,r,o,s){this.triangles_.push({source:[r,o,s],target:[t,e,i]})}addQuad_(t,e,i,r,o,s,a,l,c){let u=ma([o,s,a,l]),h=this.sourceWorldWidth_?H(u)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&h>.5&&h<1,p=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){let m=ma([t,e,i,r]);p=H(m)/this.targetWorldWidth_>vp||p}!f&&this.sourceProj_.isGlobal()&&h&&(p=h>vp||p)}if(!p&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!_t(u,this.maxSourceExtent_))return;let g=0;if(!p&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)p=!0;else if(g=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(s[0])||!isFinite(s[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),g!=1&&g!=2&&g!=4&&g!=8)return}if(c>0){if(!p){let m=[(t[0]+i[0])/2,(t[1]+i[1])/2],_=this.transformInv_(m),x;f?x=(ke(o[0],d)+ke(a[0],d))/2-ke(_[0],d):x=(o[0]+a[0])/2-_[0];let C=(o[1]+a[1])/2-_[1];p=x*x+C*C>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){let m=[(e[0]+i[0])/2,(e[1]+i[1])/2],_=this.transformInv_(m),x=[(r[0]+t[0])/2,(r[1]+t[1])/2],C=this.transformInv_(x);this.addQuad_(t,e,m,x,o,s,_,C,c-1),this.addQuad_(x,m,i,r,C,_,a,l,c-1)}else{let m=[(t[0]+e[0])/2,(t[1]+e[1])/2],_=this.transformInv_(m),x=[(i[0]+r[0])/2,(i[1]+r[1])/2],C=this.transformInv_(x);this.addQuad_(t,m,x,r,o,_,C,l,c-1),this.addQuad_(m,e,i,x,_,s,a,C,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(g&11)==0&&this.addTriangle_(t,i,r,o,a,l),(g&14)==0&&this.addTriangle_(t,i,e,o,a,s),g&&((g&13)==0&&this.addTriangle_(e,r,t,s,l,o),(g&7)==0&&this.addTriangle_(e,r,i,s,l,a))}calculateSourceExtent(){let t=It();return this.triangles_.forEach(function(e,i,r){let o=e.source;tn(t,o[0]),tn(t,o[1]),tn(t,o[2])}),t}getTriangles(){return this.triangles_}},Sp=xc;var yc=class extends rr{constructor(t,e,i,r,o,s,a,l,c,u,h,d){super(o,k.IDLE,d),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;let f=r.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent(),g=this.sourceTileGrid_.getExtent(),m=p?He(f,p):f;if(wr(m)===0){this.state=k.EMPTY;return}let _=t.getExtent();_&&(g?g=He(g,_):g=_);let x=r.getResolution(this.wrappedTileCoord_[0]),C=Cp(t,i,m,x);if(!isFinite(C)||C<=0){this.state=k.EMPTY;return}let y=u!==void 0?u:.5;if(this.triangulation_=new Sp(t,i,m,g,C*y,x),this.triangulation_.getTriangles().length===0){this.state=k.EMPTY;return}this.sourceZ_=e.getZForResolution(C);let E=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(E[1]=at(E[1],g[1],g[3]),E[3]=at(E[3],g[1],g[3])):E=He(E,g)),!wr(E))this.state=k.EMPTY;else{let v=0,T=0;t.canWrapX()&&(v=H(_),T=Math.floor((E[0]-_[0])/v)),Go(E.slice(),t,!0).forEach(I=>{let D=e.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let K=D.minX;K<=D.maxX;K++)for(let G=D.minY;G<=D.maxY;G++){let F=c(this.sourceZ_,K,G,a);if(F){let tt=T*v;this.sourceTiles_.push({tile:F,offset:tt})}}++T}),this.sourceTiles_.length===0&&(this.state=k.EMPTY)}}getImage(){return this.canvas_}reproject_(){let t=[];if(this.sourceTiles_.forEach(e=>{let i=e.tile;if(i&&i.getState()==k.LOADED){let r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=e.offset,r[2]+=e.offset;let o=this.clipExtent_?.slice();o&&(o[0]+=e.offset,o[2]+=e.offset),t.push({extent:r,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=k.ERROR;else{let e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r=typeof i=="number"?i:i[0],o=typeof i=="number"?i:i[1],s=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=wp(r,o,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),s,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=k.LOADED}this.changed()}load(){if(this.state==k.IDLE){this.state=k.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{let i=e.getState();if(i==k.IDLE||i==k.LOADING){t++;let r=Z(e,P.CHANGE,o=>{let s=e.getState();(s==k.LOADED||s==k.ERROR||s==k.EMPTY)&&(st(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,r){e.getState()==k.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(st),this.sourcesListenerKeys_=null}release(){this.canvas_&&(sn(this.canvas_.getContext("2d")),fn.push(this.canvas_),this.canvas_=null),super.release()}},Ds=yc;var Ec=class{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){let t=this.pop();t instanceof bi&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){let i=this.entries_[t];return j(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){let e=this.entries_[t];return j(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){let t=new Array(this.count_),e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){let t=new Array(this.count_),e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){let t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){j(!(t in this.entries_),"Tried to set a value for a key that is used already");let i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}},Tp=Ec;function or(n,t,e,i){return i!==void 0?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function Ip(n,t,e){return n+"/"+t+"/"+e}function bp(n){return G0(n[0],n[1],n[2])}function G0(n,t,e){return(t<<n)+e}function Rp(n,t){let e=n[0],i=n[1],r=n[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;let o=t.getFullTileRange(e);return o?o.containsXY(i,r):!0}var Cc=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Bn(),{get:(t,e)=>{if(typeof Bn()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){let e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,r=e.length;i<r;++i){let o=e[i];if(typeof o=="function"){o(t);continue}let s=e[++i];if(typeof t[o]=="function")t[o](...s);else{if(typeof s=="function"){t[o]=s(t);continue}t[o]=s}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},Ps=Cc;var z0=5,wc=class extends bo{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=z0}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return J()}getData(t){return null}prepareFrame(t){return J()}renderFrame(t,e){return J()}forEachFeatureAtCoordinate(t,e,i,r,o){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){let e=t.target;(e.getState()===X.LOADED||e.getState()===X.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=X.LOADED&&e!=X.ERROR&&t.addEventListener(P.CHANGE,this.boundHandleImageChange_),e==X.IDLE&&(t.load(),e=t.getState()),e==X.LOADED}renderIfReadyAndVisible(){let t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},Ap=wc;var Sc=[],sr=null;function V0(){sr=ut(1,1,void 0,{willReadFrequently:!0})}var vc=class extends Ap{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=kt(),this.pixelTransform=kt(),this.inversePixelTransform=kt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){sr||V0(),sr.clearRect(0,0,1,1);let r;try{sr.drawImage(t,e,i,1,1,0,0,1,1),r=sr.getImageData(0,0,1,1).data}catch{return sr=null,null}return r}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){let r=this.getLayer().getClassName(),o,s;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&Ut(Ve(t.style.backgroundColor),Ve(i)))){let a=t.firstElementChild;a instanceof HTMLCanvasElement&&(s=a.getContext("2d"))}if(s&&zd(s.canvas.style.transform,e)?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){o=document.createElement("div"),o.className=r;let a=o.style;a.position="absolute",a.width="100%",a.height="100%",s=ut();let l=s.canvas;o.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=o,this.context=s}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){let r=Se(i),o=Pn(i),s=Dn(i),a=On(i);xt(e.coordinateToPixelTransform,r),xt(e.coordinateToPixelTransform,o),xt(e.coordinateToPixelTransform,s),xt(e.coordinateToPixelTransform,a);let l=this.inversePixelTransform;xt(l,r),xt(l,o),xt(l,s),xt(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){let i=t.extent,r=t.viewState.resolution,o=t.viewState.rotation,s=t.pixelRatio,a=Math.round(H(i)/r*s),l=Math.round(mt(i)/r*s);zt(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,o,-a/2,-l/2),Ho(this.inversePixelTransform,this.pixelTransform);let c=Gd(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){let u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),c!==u.style.transform&&(u.style.transform=c)}}dispatchRenderEvent_(t,e,i){let r=this.getLayer();if(r.hasListener(t)){let o=new Rs(t,this.inversePixelTransform,i,e);r.dispatchEvent(o)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Vt.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Vt.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Ps),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Vt.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Vt.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,r,o,s,a){let l=o/2,c=s/2,u=r/e,h=-u,d=-t[0]+a,f=-t[1];return zt(this.tempTransform,l,c,u,h,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}},Fs=vc;function Tc(n,t,e,i){return`${n},${Ip(t,e,i)}`}function Ic(n,t,e){if(!(e in n))return n[e]=new Set([t]),!0;let i=n[e],r=i.has(t);return r||i.add(t),!r}function W0(n,t,e){let i=n[e];return i?i.delete(t):!1}function Mp(n,t){let e=n.layerStatesArray[n.layerIndex];e.extent&&(t=He(t,be(e.extent,n.viewState.projection)));let i=e.layer.getRenderSource();if(!i.getWrapX()){let r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(t=He(t,r))}return t}var bc=class extends Fs{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=It(),this.tempTileRange_=new Os(0,0,0,0),this.tempTileCoord_=or(0,0,0);let i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new Tp(i),this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,i,r){let o=this.tileCache_,a=this.getLayer().getSource(),l=Tc(a.getKey(),t,e,i),c;if(o.containsKey(l))c=o.get(l);else{if(c=a.getTile(t,e,i,r.pixelRatio,r.viewState.projection),!c)return null;o.set(l,c)}return c}getTile(t,e,i,r){let o=this.getOrCreateTile(t,e,i,r);return o||null}getData(t){let e=this.frameState;if(!e)return null;let i=this.getLayer(),r=xt(e.pixelToCoordinateTransform,t.slice()),o=i.getExtent();if(o&&!Ne(o,r))return null;let s=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(s.projection),c=a.getTilePixelRatio(e.pixelRatio);for(let u=l.getZForResolution(s.resolution);u>=l.getMinZoom();--u){let h=l.getTileCoordForCoordAndZ(r,u),d=this.getTile(u,h[1],h[2],e);if(!d||d.getState()!==k.LOADED)continue;let f=l.getOrigin(u),p=Et(l.getTileSize(u)),g=l.getResolution(u),m;if(d instanceof Ms||d instanceof Ds)m=d.getImage();else if(d instanceof pc){if(m=As(d.getData()),!m)continue}else continue;let _=Math.floor(c*((r[0]-f[0])/g-h[1]*p[0])),x=Math.floor(c*((f[1]-r[1])/g-h[2]*p[1])),C=Math.round(c*a.getGutterForProjection(s.projection));return this.getImageData(m,_+C,x+C)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;let e=this.getLayer().getSource();if(!e)return!1;let i=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0}enqueueTiles(t,e,i,r,o){let s=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(s.projection),u=B(l);u in t.wantedTiles||(t.wantedTiles[u]={});let h=t.wantedTiles[u],d=a.getMapInternal(),f=Math.max(i-o,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),p=s.rotation,g=p?xa(s.center,s.resolution,p,t.size):void 0;for(let m=i;m>=f;--m){let _=c.getTileRangeForExtentAndZ(e,m,this.tempTileRange_),x=c.getResolution(m);for(let C=_.minX;C<=_.maxX;++C)for(let y=_.minY;y<=_.maxY;++y){if(p&&!c.tileCoordIntersectsViewport([m,C,y],g))continue;let E=this.getTile(m,C,y,t);if(!E||!Ic(r,E,m))continue;let T=E.getKey();if(h[T]=!0,E.getState()===k.IDLE&&!t.tileQueue.isKeyQueued(T)){let S=or(m,C,y,this.tempTileCoord_);t.tileQueue.enqueue([E,u,c.getTileCoordCenter(S),x])}}}}findStaleTile_(t,e){let i=this.tileCache_,r=t[0],o=t[1],s=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){let c=Tc(a[l],r,o,s);if(i.containsKey(c)){let u=i.peek(c);if(u.getState()===k.LOADED)return u.endTransition(B(this)),Ic(e,u,r),!0}}return!1}findAltTiles_(t,e,i,r){let o=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!o)return!1;let s=!0,a=this.tileCache_,c=this.getLayer().getRenderSource().getKey();for(let u=o.minX;u<=o.maxX;++u)for(let h=o.minY;h<=o.maxY;++h){let d=Tc(c,i,u,h),f=!1;if(a.containsKey(d)){let p=a.peek(d);p.getState()===k.LOADED&&(Ic(r,p,i),f=!0)}f||(s=!1)}return s}renderFrame(t,e){this.renderComplete=!0;let i=t.layerStatesArray[t.layerIndex],r=t.viewState,o=r.projection,s=r.resolution,a=r.center,l=t.pixelRatio,c=this.getLayer(),u=c.getSource(),h=u.getTileGridForProjection(o),d=h.getZForResolution(s,u.zDirection),f=h.getResolution(d),p=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let g=t.extent,m=u.getTilePixelRatio(l);this.prepareContainer(t,e);let _=this.context.canvas.width,x=this.context.canvas.height,C=i.extent&&be(i.extent,o);C&&(g=He(g,be(i.extent,o)));let y=f*_/2/m,E=f*x/2/m,v=[a[0]-y,a[1]-E,a[0]+y,a[1]+E],T={};this.renderedTiles.length=0;let S=c.getPreload();if(t.nextExtent){let V=h.getZForResolution(r.nextResolution,u.zDirection),q=Mp(t,t.nextExtent);this.enqueueTiles(t,q,V,T,S)}let I=Mp(t,g);if(this.enqueueTiles(t,I,d,T,0),S>0&&setTimeout(()=>{this.enqueueTiles(t,I,d-1,T,S-1)},0),!(d in T))return this.container;let D=B(this),K=t.time;for(let V of T[d]){let q=V.getState();if(q===k.EMPTY)continue;let ot=V.tileCoord;if(q===k.LOADED&&V.getAlpha(D,K)===1){V.endTransition(D);continue}if(q!==k.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ot,T)){W0(T,V,d),t.animate=!0;continue}if(this.findAltTiles_(h,ot,d+1,T))continue;let Wt=h.getMinZoom();for(let jt=d-1;jt>=Wt&&!this.findAltTiles_(h,ot,jt,T);--jt);}let G=f/s*l/m,F=this.getRenderContext(t);zt(this.tempTransform,_/2,x/2,G,G,0,-_/2,-x/2),i.extent&&this.clipUnrotated(F,t,C),u.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,t);let tt=Object.keys(T).map(Number);tt.sort(Jt);let W,Y=[],N=[];for(let V=tt.length-1;V>=0;--V){let q=tt[V],ot=u.getTilePixelSize(q,l,o),b=h.getResolution(q)/f,Wt=ot[0]*b*G,jt=ot[1]*b*G,wt=h.getTileCoordForCoordAndZ(Se(v),q),oe=h.getTileCoordExtent(wt),Xt=xt(this.tempTransform,[m*(oe[0]-v[0])/f,m*(v[3]-oe[3])/f]),Ue=m*u.getGutterForProjection(o);for(let Ae of T[q]){if(Ae.getState()!==k.LOADED)continue;let se=Ae.tileCoord,no=wt[1]-se[1],Us=Math.round(Xt[0]-(no-1)*Wt),cr=wt[2]-se[2],Bi=Math.round(Xt[1]-(cr-1)*jt),fe=Math.round(Xt[0]-no*Wt),Ke=Math.round(Xt[1]-cr*jt),gn=Us-fe,_n=Bi-Ke,ur=tt.length===1,Yi=!1;W=[fe,Ke,fe+gn,Ke,fe+gn,Ke+_n,fe,Ke+_n];for(let xn=0,yn=Y.length;xn<yn;++xn)if(!ur&&q<N[xn]){let Pt=Y[xn];_t([fe,Ke,fe+gn,Ke+_n],[Pt[0],Pt[3],Pt[4],Pt[7]])&&(Yi||(F.save(),Yi=!0),F.beginPath(),F.moveTo(W[0],W[1]),F.lineTo(W[2],W[3]),F.lineTo(W[4],W[5]),F.lineTo(W[6],W[7]),F.moveTo(Pt[6],Pt[7]),F.lineTo(Pt[4],Pt[5]),F.lineTo(Pt[2],Pt[3]),F.lineTo(Pt[0],Pt[1]),F.clip())}Y.push(W),N.push(q),this.drawTile(Ae,t,fe,Ke,gn,_n,Ue,ur),Yi&&F.restore(),this.renderedTiles.unshift(Ae),this.updateUsedTiles(t.usedTiles,u,Ae)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!fi(this.renderedExtent_,v),this.renderedExtent_=v,this.renderedPixelRatio=l,this.postRender(this.context,t),i.extent&&F.restore(),F.imageSmoothingEnabled=!0,this.renderComplete){let V=(q,ot)=>{let ht=B(u),b=ot.wantedTiles[ht],Wt=b?Object.keys(b).length:0;this.updateCacheSize(Wt),this.tileCache_.expireCache()};t.postRenderFunctions.push(V)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,r,o,s,a,l){let c;if(t instanceof pc){if(c=As(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;let u=this.getRenderContext(e),h=B(this),d=e.layerStatesArray[e.layerIndex],f=d.opacity*(l?t.getAlpha(h,e.time):1),p=f!==u.globalAlpha;p&&(u.save(),u.globalAlpha=f),u.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,r,o,s),p&&u.restore(),f!==d.opacity?e.animate=!0:l&&t.endTransition(h)}getImage(){let t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){let r=B(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}},Lp=bc;var qr={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var Rc=class extends ln{constructor(t){t=t||{};let e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(qr.PRELOAD)}setPreload(t){this.set(qr.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(qr.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(qr.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}},Op=Rc;var Ac=class extends Op{constructor(t){super(t)}createRenderer(){return new Lp(this,{cacheSize:this.getCacheSize()})}},Dp=Ac;var ar=[0,0,0],Xi=5,Mc=class{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,j(Yh(this.resolutions_,(r,o)=>o-r,!0),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,o=this.resolutions_.length-1;r<o;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,j(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));let i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Se(i)),j(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,j(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:256,j(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,o)=>{let s=new Os(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){let a=this.getTileRangeForExtentAndZ(i,o);s.minX=Math.max(a.minX,s.minX),s.maxX=Math.min(a.maxX,s.maxX),s.minY=Math.max(a.minY,s.minY),s.maxY=Math.min(a.maxY,s.maxY)}return s}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){let r=this.getTileRangeForExtentAndZ(t,e);for(let o=r.minX,s=r.maxX;o<=s;++o)for(let a=r.minY,l=r.maxY;a<=l;++a)i([e,o,a])}forEachTileCoordParentTileRange(t,e,i,r){let o,s,a,l=null,c=t[0]-1;for(this.zoomFactor_===2?(s=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);c>=this.minZoom;){if(s!==void 0&&a!==void 0?(s=Math.floor(s/2),a=Math.floor(a/2),o=dn(s,s,a,a,i)):o=this.getTileRangeForExtentAndZ(l,c,i),e(c,o))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){let o=t[1]*2,s=t[2]*2;return dn(o,o+1,s,s+1,e)}let r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;let r=t[0],o=t[1],s=t[2];if(e===r)return dn(o,s,o,s,i);if(this.zoomFactor_){let l=Math.pow(this.zoomFactor_,e-r),c=Math.floor(o*l),u=Math.floor(s*l);if(e<r)return dn(c,c,u,u,i);let h=Math.floor(l*(o+1))-1,d=Math.floor(l*(s+1))-1;return dn(c,h,u,d,i)}let a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,ar);let r=ar[1],o=ar[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,ar);let s=ar[1],a=ar[2];return dn(r,s,o,a,i)}getTileCoordCenter(t){let e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=Et(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){let i=this.getOrigin(t[0]),r=this.getResolution(t[0]),o=Et(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*o[0]*r,a=i[1]-(t[2]+1)*o[1]*r,l=s+o[0]*r,c=a+o[1]*r;return ce(s,a,l,c,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,o){let s=this.getZForResolution(i),a=i/this.getResolution(s),l=this.getOrigin(s),c=Et(this.getTileSize(s),this.tmpSize_),u=a*(t-l[0])/i/c[0],h=a*(l[1]-e)/i/c[1];return r?(u=Cr(u,Xi)-1,h=Cr(h,Xi)-1):(u=Er(u,Xi),h=Er(h,Xi)),or(s,u,h,o)}getTileCoordForXYAndZ_(t,e,i,r,o){let s=this.getOrigin(i),a=this.getResolution(i),l=Et(this.getTileSize(i),this.tmpSize_),c=(t-s[0])/a/l[0],u=(s[1]-e)/a/l[1];return r?(c=Cr(c,Xi)-1,u=Cr(u,Xi)-1):(c=Er(c,Xi),u=Er(u,Xi)),or(i,c,u,o)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){let i=Sn(this.resolutions_,t,e||0);return at(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Ka(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){let e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}},Lc=Mc;function ks(n){let t=n.getDefaultTileGrid();return t||(t=U0(n),n.setDefaultTileGrid(t)),t}function Pp(n,t,e){let i=t[0],r=n.getTileCoordCenter(t),o=Ns(e);if(!Ne(o,r)){let s=H(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,n.getTileCoordForCoordAndZ(r,i)}return t}function X0(n,t,e,i){i=i!==void 0?i:"top-left";let r=kp(n,t,e);return new Lc({extent:n,origin:od(n,i),resolutions:r,tileSize:e})}function Fp(n){let t=n||{},e=t.extent||Lt("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:kp(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Lc(i)}function kp(n,t,e,i){t=t!==void 0?t:42,e=Et(e!==void 0?e:256);let r=mt(n),o=H(n);i=i>0?i:Math.max(o/e[0],r/e[1]);let s=t+1,a=new Array(s);for(let l=0;l<s;++l)a[l]=i/Math.pow(2,l);return a}function U0(n,t,e,i){let r=Ns(n);return X0(r,t,e,i)}function Ns(n){n=Lt(n);let t=n.getExtent();if(!t){let e=180*pi.degrees/n.getMetersPerUnit();t=ce(-e,-e,e,e)}return t}var K0=/\{z\}/g,B0=/\{x\}/g,Y0=/\{y\}/g,j0=/\{-y\}/g;function Np(n,t,e,i,r){return n.replace(K0,t.toString()).replace(B0,e.toString()).replace(Y0,i.toString()).replace(j0,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function Gp(n){let t=[],e=/\{([a-z])-([a-z])\}/.exec(n);if(e){let i=e[1].charCodeAt(0),r=e[2].charCodeAt(0),o;for(o=i;o<=r;++o)t.push(n.replace(e[0],String.fromCharCode(o)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){let i=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=i;r++)t.push(n.replace(e[0],r.toString()));return t}return t.push(n),t}function Z0(n,t){return function(e,i,r){if(!e)return;let o,s=e[0];if(t){let a=t.getFullTileRange(s);a&&(o=a.getHeight()-1)}return Np(n,s,e[1],e[2],o)}}function zp(n,t){let e=n.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Z0(n[r],t);return q0(i)}function q0(n){return n.length===1?n[0]:function(t,e,i){if(!t)return;let r=bp(t),o=ke(r,n.length);return n[o](t,e,i)}}var Oc=class extends At{constructor(t){super(),this.projection=Lt(t.projection),this.attributions_=Vp(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;let e=this;this.viewPromise_=new Promise(function(i,r){e.viewResolver=i,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Vp(t),this.changed()}setState(t){this.state_=t,this.changed()}};function Vp(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),t=>n):null}var Gs=Oc;var Dc=class extends Gs{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;let e=[256,256];this.tileGrid&&Et(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||B(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){let e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,o){return J()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:ks(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){let r=this.getTileGridForProjection(i),o=this.getTilePixelRatio(e),s=Et(r.getTileSize(t),this.tmpSize);return o==1?s:Kf(s,o,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){let i=e!==void 0?e:this.getProjection(),r=e!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=Pp(r,t,i)),Rp(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}},zs=class extends Rt{constructor(t,e){super(t),this.tile=e}},Wp=Dc;var Vs={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var Pc=class n extends Wp{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===n.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){let e=t.target,i=B(e),r=e.getState(),o;r==k.LOADING?(this.tileLoadingKeys_[i]=!0,o=Vs.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],o=r==k.ERROR?Vs.TILELOADERROR:r==k.LOADED?Vs.TILELOADEND:void 0),o!=null&&this.dispatchEvent(new zs(o,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){let e=Gp(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;let e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(zp(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}},Xp=Pc;var Fc=class extends Xp{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:H0,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:Ms,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!qo(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){let e=this.getProjection();if(this.tileGrid&&(!e||qo(e,t)))return this.tileGrid;let i=B(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=ks(t)),this.tileGridForProjection[i]}createTile_(t,e,i,r,o,s){let a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,o),c=l?this.tileUrlFunction(l,r,o):void 0,u=new this.tileClass(a,c!==void 0?k.IDLE:k.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=s,u.addEventListener(P.CHANGE,this.handleTileChange.bind(this)),u}getTile(t,e,i,r,o){let s=this.getProjection();if(!s||!o||qo(s,o))return this.getTileInternal(t,e,i,r,s||o);let a=[t,e,i],l=this.getKey(),c=this.getTileGridForProjection(s),u=this.getTileGridForProjection(o),h=this.getTileCoordForTileUrlFunction(a,o),d=new Ds(s,c,o,u,a,h,this.getTilePixelRatio(r),this.getGutter(),(f,p,g,m)=>this.getTileInternal(f,p,g,m,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(t,e,i,r,o){let s=this.getKey();return this.createTile_(t,e,i,r,o,s)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){let i=Lt(t);if(i){let r=B(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}};function H0(n,t){n.getImage().src=t}var Up=Fc;var kc=class extends Up{constructor(t){t=t||{};let e=t.projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:Fp({extent:Ns(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}},Kp=kc;var $0='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',Nc=class extends Kp{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[$0];let i=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}},Bp=Nc;var Gc=class n extends At{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){let e=t;this.setGeometry(e)}else{let e=t;this.setProperties(e)}}clone(){let t=new n(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());let e=this.getGeometry();e&&t.setGeometry(e.clone());let i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(st(this.geometryChangeKey_),this.geometryChangeKey_=null);let t=this.getGeometry();t&&(this.geometryChangeKey_=Z(t,P.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?J0(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function J0(n){if(typeof n=="function")return n;let t;return Array.isArray(n)?t=n:(j(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[n]),function(){return t}}var Hr=Gc;function zc(n,t,e,i,r,o,s){let a,l,c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=r;else if(c!==0){let u=n[t],h=n[t+1],d=0,f=[0];for(let m=t+i;m<e;m+=i){let _=n[m],x=n[m+1];d+=Math.sqrt((_-u)*(_-u)+(x-h)*(x-h)),f.push(d),u=_,h=x}let p=r*d,g=Uh(f,p);g<0?(l=(p-f[-g-2])/(f[-g-1]-f[-g-2]),a=t+(-g-2)*i):a=t+g*i}s=s>1?s:2,o=o||new Array(s);for(let u=0;u<s;++u)o[u]=a===void 0?NaN:l===void 0?n[a+u]:Kt(n[a+u],n[a+i+u],l);return o}function Yp(n,t,e,i){let r=n[t],o=n[t+1],s=0;for(let a=t+i;a<e;a+=i){let l=n[a],c=n[a+1];s+=Math.sqrt((l-r)*(l-r)+(c-o)*(c-o)),r=l,o=c}return s}var Vc=class{drawCustom(t,e,i,r,o){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},Ws=Vc;var Wc=class extends Ws{constructor(t,e,i,r,o,s,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=r,this.transformRotation_=r?An(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=o,this.squaredTolerance_=s,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=kt()}drawImages_(t,e,i,r){if(!this.image_)return;let o=te(t,e,i,r,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.tmpLocalTransform_,l=s.globalAlpha;this.imageOpacity_!=1&&(s.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,h=o.length;u<h;u+=2){let d=o[u]-this.imageAnchorX_,f=o[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){let p=d+this.imageAnchorX_,g=f+this.imageAnchorY_;zt(a,p,g,1,1,c,-p,-g),s.save(),s.transform.apply(s,a),s.translate(p,g),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(s.globalAlpha=l)}drawText_(t,e,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);let o=te(t,e,i,r,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=r){let l=o[e]+this.textOffsetX_,c=o[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(s.save(),s.translate(l-this.textOffsetX_,c-this.textOffsetY_),s.rotate(a),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,l,c),this.textFillState_&&s.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,r,o){let s=this.context_,a=te(t,e,i,r,this.transform_,this.pixelCoordinates_);s.moveTo(a[0],a[1]);let l=a.length;o&&(l-=2);for(let c=2;c<l;c+=2)s.lineTo(a[c],a[c+1]);return o&&s.closePath(),i}drawRings_(t,e,i,r){for(let o=0,s=i.length;o<s;++o)e=this.moveToLineTo_(t,e,i[o],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_t(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let e=Bd(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],o=Math.sqrt(i*i+r*r),s=this.context_;s.beginPath(),s.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break;default:}}drawFeature(t,e){let i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){let e=t.getGeometriesArray();for(let i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_t(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){let e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let e=t.getExtent();if(_t(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let i=this.context_,r=t.getFlatCoordinates(),o=0,s=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=s.length;l<c;++l)o=this.moveToLineTo_(r,o,s[l],a,!1);i.stroke()}if(this.text_!==""){let i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_t(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){let e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!_t(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let e=this.context_,i=t.getOrientedFlatCoordinates(),r=0,o=t.getEndss(),s=t.getStride();e.beginPath();for(let a=0,l=o.length;a<l;++a){let c=o[a];r=this.drawRings_(i,r,c,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){let e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){let e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){let e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),Ut(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){let e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:Wi;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=r&&(i.textAlign=r,e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{let i=t.getColor();this.fillState_={fillStyle:ee(i||Dt)}}if(!e)this.strokeState_=null;else{let i=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),u=o||ie;this.strokeState_={lineCap:r!==void 0?r:ti,lineDash:this.pixelRatio_===1?u:u.map(h=>h*this.pixelRatio_),lineDashOffset:(s||ne)*this.pixelRatio_,lineJoin:a!==void 0?a:ei,lineWidth:(l!==void 0?l:Ei)*this.pixelRatio_,miterLimit:c!==void 0?c:_i,strokeStyle:ee(i||xi)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}let i=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),o=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();let s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{let e=t.getFill();if(!e)this.textFillState_=null;else{let f=e.getColor();this.textFillState_={fillStyle:ee(f||Dt)}}let i=t.getStroke();if(!i)this.textStrokeState_=null;else{let f=i.getColor(),p=i.getLineCap(),g=i.getLineDash(),m=i.getLineDashOffset(),_=i.getLineJoin(),x=i.getWidth(),C=i.getMiterLimit();this.textStrokeState_={lineCap:p!==void 0?p:ti,lineDash:g||ie,lineDashOffset:m||ne,lineJoin:_!==void 0?_:ei,lineWidth:x!==void 0?x:Ei,miterLimit:C!==void 0?C:_i,strokeStyle:ee(f||xi)}}let r=t.getFont(),o=t.getOffsetX(),s=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),u=t.getText(),h=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:r!==void 0?r:_s,textAlign:h!==void 0?h:Wi,textBaseline:d!==void 0?d:un},this.text_=u!==void 0?Array.isArray(u)?u.reduce((f,p,g)=>f+=g%2?" ":p,""):u:"",this.textOffsetX_=o!==void 0?this.pixelRatio_*o:0,this.textOffsetY_=s!==void 0?this.pixelRatio_*s:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}},jp=Wc;var Q0=.5,Zp={Point:sx,LineString:nx,Polygon:lx,MultiPoint:ax,MultiLineString:rx,MultiPolygon:ox,GeometryCollection:ix,Circle:tx};function qp(n,t){return parseInt(B(n),10)-parseInt(B(t),10)}function Xc(n,t){let e=Uc(n,t);return e*e}function Uc(n,t){return Q0*n/t}function tx(n,t,e,i,r){let o=e.getFill(),s=e.getStroke();if(o||s){let l=n.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(o,s),l.drawCircle(t,i,r)}let a=e.getText();if(a&&a.getText()){let l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function Kc(n,t,e,i,r,o,s,a){let l=[],c=e.getImage();if(c){let d=!0,f=c.getImageState();f==X.LOADED||f==X.ERROR?d=!1:f==X.IDLE&&c.load(),d&&l.push(c.ready())}let u=e.getFill();u&&u.loading()&&l.push(u.ready());let h=l.length>0;return h&&Promise.all(l).then(()=>r(null)),ex(n,t,e,i,o,s,a),h}function ex(n,t,e,i,r,o,s){let a=e.getGeometryFunction()(t);if(!a)return;let l=a.simplifyTransformed(i,r);if(e.getRenderer())Hp(n,l,e,t,s);else{let u=Zp[l.getType()];u(n,l,e,t,s,o)}}function Hp(n,t,e,i,r){if(t.getType()=="GeometryCollection"){let s=t.getGeometries();for(let a=0,l=s.length;a<l;++a)Hp(n,s[a],e,i,r);return}n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),r)}function ix(n,t,e,i,r,o){let s=t.getGeometriesArray(),a,l;for(a=0,l=s.length;a<l;++a){let c=Zp[s[a].getType()];c(n,s[a],e,i,r,o)}}function nx(n,t,e,i,r){let o=e.getStroke();if(o){let a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawLineString(t,i,r)}let s=e.getText();if(s&&s.getText()){let a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(s),a.drawText(t,i,r)}}function rx(n,t,e,i,r){let o=e.getStroke();if(o){let a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawMultiLineString(t,i,r)}let s=e.getText();if(s&&s.getText()){let a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(s),a.drawText(t,i,r)}}function ox(n,t,e,i,r){let o=e.getFill(),s=e.getStroke();if(s||o){let l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(o,s),l.drawMultiPolygon(t,i,r)}let a=e.getText();if(a&&a.getText()){let l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}function sx(n,t,e,i,r,o){let s=e.getImage(),a=e.getText(),l=a&&a.getText(),c=o&&s&&l?{}:void 0;if(s){if(s.getImageState()!=X.LOADED)return;let u=n.getBuilder(e.getZIndex(),"Image");u.setImageStyle(s,c),u.drawPoint(t,i,r)}if(l){let u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(t,i,r)}}function ax(n,t,e,i,r,o){let s=e.getImage(),a=s&&s.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),u=o&&a&&c?{}:void 0;if(a){if(s.getImageState()!=X.LOADED)return;let h=n.getBuilder(e.getZIndex(),"Image");h.setImageStyle(s,u),h.drawMultiPoint(t,i,r)}if(c){let h=n.getBuilder(e.getZIndex(),"Text");h.setTextStyle(l,u),h.drawText(t,i,r)}}function lx(n,t,e,i,r){let o=e.getFill(),s=e.getStroke();if(o||s){let l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(o,s),l.drawPolygon(t,i,r)}let a=e.getText();if(a&&a.getText()){let l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}var cx=!1;function ux(n,t,e,i,r,o,s){let a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(e,i,r):n,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=cx,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){let c=t.getType();try{let u;c=="text"||c=="json"?u=a.responseText:c=="xml"?u=a.responseXML||a.responseText:c=="arraybuffer"&&(u=a.response),u?o(t.readFeatures(u,{extent:e,featureProjection:r}),t.readProjection(u)):s()}catch{s()}}else s()},a.onerror=s,a.send()}function Bc(n,t){return function(e,i,r,o,s){ux(n,t,e,i,r,(a,l)=>{this.addFeatures(a),o!==void 0&&o(a)},()=>{this.changed(),s!==void 0&&s()})}}function $p(n,t){return[[-1/0,-1/0,1/0,1/0]]}function Jp(n,t,e,i){let r=[],o=It();for(let s=0,a=e.length;s<a;++s){let l=e[s];o=Ln(n,t,l[0],i),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),t=l[l.length-1]}return r}var Qp=kt(),$r=class n{constructor(t,e,i,r,o,s){this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=o,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?ko(this.flatCoordinates_):Ln(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){let t=ve(this.getExtent());this.flatInteriorPoints_=Rr(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){let t=af(this.flatCoordinates_,this.ends_),e=Jp(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=tf(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=zc(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];let t=this.flatCoordinates_,e=0,i=this.ends_;for(let r=0,o=i.length;r<o;++r){let s=i[r],a=zc(t,e,s,2,.5);Tn(this.flatMidpoints_,a),e=s}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=Lt(t);let e=t.getExtent(),i=t.getWorldExtent();if(e&&i){let r=mt(i)/mt(e);zt(Qp,i[0],i[3],r,-r,0,0,0),te(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Qp,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new n(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Io((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);let i=this.simplifiedGeometry_.getFlatCoordinates(),r;switch(this.type_){case"LineString":i.length=Ir(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Jd(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,r);break;case"Polygon":r=[],i.length=Jo(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,r);break;default:}return r&&(this.simplifiedGeometry_=new n(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}};$r.prototype.getFlatCoordinates=$r.prototype.getOrientedFlatCoordinates;var pn=$r;var Yc=class{constructor(t){this.rbush_=new Jn(t),this.items_={}}insert(t,e){let i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[B(e)]=i}load(t,e){let i=new Array(e.length);for(let r=0,o=e.length;r<o;r++){let s=t[r],a=e[r],l={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:a};i[r]=l,this.items_[B(a)]=l}this.rbush_.load(i)}remove(t){let e=B(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){let i=this.items_[B(e)],r=[i.minX,i.minY,i.maxX,i.maxY];fi(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){let e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let r=0,o=t.length;r<o;r++)if(i=e(t[r]),i)return i;return i}isEmpty(){return Pe(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){let e=this.rbush_.toJSON();return ce(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(let e in t.items_)this.items_[e]=t.items_[e]}},jc=Yc;var de={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};var ii=class extends Rt{constructor(t,e,i){super(t),this.feature=e,this.features=i}},Zc=class extends Gs{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=hi,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(j(this.format_,"`format` must be set when `url` is set"),this.loader_=Bc(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:$p;let e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new jc:null,this.loadedExtentsRtree_=new jc,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(t.features)?r=t.features:t.features&&(i=t.features,r=i.getArray()),!e&&i===void 0&&(i=new Tt(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){let e=B(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);let i=t.getGeometry();if(i){let r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new ii(de.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof pn||(this.featureChangeKeys_[t]=[Z(e,P.CHANGE,this.handleFeatureChange_,this),Z(e,De.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){let r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof pn){let o=this.idIndex_[r];o instanceof pn?Array.isArray(o)?o.push(e):this.idIndex_[r]=[o,e]:i=!1}else i=!1}return i&&(j(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){let e=[],i=[],r=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=B(a);this.addToIndex_(l,a)&&i.push(a)}for(let o=0,s=i.length;o<s;o++){let a=i[o],l=B(a);this.setupChangeEvents_(l,a);let c=a.getGeometry();if(c){let u=c.getExtent();e.push(u),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(de.ADDFEATURE))for(let o=0,s=i.length;o<s;o++)this.dispatchEvent(new ii(de.ADDFEATURE,i[o]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(de.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(de.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Ft.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Ft.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(let i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(st);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(let i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};let e=new ii(de.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){let i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(r){let o=r.getGeometry();if(o instanceof pn||o.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){let r=i.getGeometry();if(r instanceof pn||r.intersectsExtent(t)){let o=e(i);if(o)return o}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Pe(this.nullGeometryFeatures_)||Tn(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){let e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);let r=Go(t,e);return[].concat(...r.map(o=>this.featuresRtree_.getInExtent(o)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){let i=t[0],r=t[1],o=null,s=[NaN,NaN],a=1/0,l=[-1/0,-1/0,1/0,1/0];return e=e||Ce,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){let u=c.getGeometry(),h=a;if(a=u instanceof pn?0:u.closestPointXY(i,r,s,a),a<h){o=c;let d=Math.sqrt(a);l[0]=i-d,l[1]=r-d,l[2]=i+d,l[3]=r+d}}}),o}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){let e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){let e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){let e=t.target,i=B(e),r=e.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{let s=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(s,e)):this.featuresRtree_&&this.featuresRtree_.update(s,e)}let o=e.getId();if(o!==void 0){let s=o.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new ii(de.CHANGEFEATURE,e))}hasFeature(t){let e=t.getId();return e!==void 0?e in this.idIndex_:B(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Pe(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){let r=this.loadedExtentsRtree_,o=this.strategy_(t,e,i);for(let s=0,a=o.length;s<a;++s){let l=o[s];r.forEachInExtent(l,function(u){return Ji(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ii(de.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new ii(de.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ii(de.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){let e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(r){if(fi(r.extent,t))return r});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,r=t.length;i<r;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){let e=B(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(st),delete this.featureChangeKeys_[e];let r=t.getId();if(r!==void 0){let o=r.toString(),s=this.idIndex_[o];s===t?delete this.idIndex_[o]:Array.isArray(s)&&(s.splice(s.indexOf(t),1),s.length===1&&(this.idIndex_[o]=s[0]))}return delete this.uidIndex_[e],this.hasListener(de.REMOVEFEATURE)&&this.dispatchEvent(new ii(de.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(let e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){j(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Bc(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}},qc=Zc;var Jr={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Qr=[Jr.FILL],ni=[Jr.STROKE],vi=[Jr.BEGIN_PATH],Hc=[Jr.CLOSE_PATH],z=Jr;var $c=class extends Ws{constructor(t,e,i,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){let e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){let i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,o=this.coordinates,s=o.length;for(let a=0,l=t.length;a<l;a+=e)r[0]=t[a],r[1]=t[a+1],Ne(i,r)&&(o[s++]=r[0],o[s++]=r[1]);return s}appendFlatLineCoordinates(t,e,i,r,o,s){let a=this.coordinates,l=a.length,c=this.getBufferedMaxExtent();s&&(e+=r);let u=t[e],h=t[e+1],d=this.tmpCoordinate_,f=!0,p,g,m;for(p=e+r;p<i;p+=r)d[0]=t[p],d[1]=t[p+1],m=Do(c,d),m!==g?(f&&(a[l++]=u,a[l++]=h,f=!1),a[l++]=d[0],a[l++]=d[1]):m===Mt.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,u=d[0],h=d[1],g=m;return(o&&f||p===e+r)&&(a[l++]=u,a[l++]=h),l}drawCustomCoordinates_(t,e,i,r,o){for(let s=0,a=i.length;s<a;++s){let l=i[s],c=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);o.push(c),e=l}return e}drawCustom(t,e,i,r,o){this.beginGeometry(t,e,o);let s=t.getType(),a=t.getStride(),l=this.coordinates.length,c,u,h,d,f;switch(s){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),d=[];let p=t.getEndss();f=0;for(let g=0,m=p.length;g<m;++g){let _=[];f=this.drawCustomCoordinates_(c,f,p[g],a,_),d.push(_)}this.instructions.push([z.CUSTOM,l,d,t,i,Va,o]),this.hitDetectionInstructions.push([z.CUSTOM,l,d,t,r||i,Va,o]);break;case"Polygon":case"MultiLineString":h=[],c=s=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(c,0,t.getEnds(),a,h),this.instructions.push([z.CUSTOM,l,h,t,i,Xn,o]),this.hitDetectionInstructions.push([z.CUSTOM,l,h,t,r||i,Xn,o]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),u=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([z.CUSTOM,l,u,t,i,Pi,o]),this.hitDetectionInstructions.push([z.CUSTOM,l,u,t,r||i,Pi,o]);break;case"MultiPoint":c=t.getFlatCoordinates(),u=this.appendFlatPointCoordinates(c,a),u>l&&(this.instructions.push([z.CUSTOM,l,u,t,i,Pi,o]),this.hitDetectionInstructions.push([z.CUSTOM,l,u,t,r||i,Pi,o]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),u=this.coordinates.length,this.instructions.push([z.CUSTOM,l,u,t,i,void 0,o]),this.hitDetectionInstructions.push([z.CUSTOM,l,u,t,r||i,void 0,o]);break;default:}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[z.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[z.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){let t=this.hitDetectionInstructions;t.reverse();let e,i=t.length,r,o,s=-1;for(e=0;e<i;++e)r=t[e],o=r[0],o==z.END_GEOMETRY?s=e:o==z.BEGIN_GEOMETRY&&(r[2]=e,Bh(this.hitDetectionInstructions,s,e),s=-1)}fillStyleToState(t,e={}){if(t){let i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=ee(i||Dt)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){let i=t.getColor();e.strokeStyle=ee(i||xi);let r=t.getLineCap();e.lineCap=r!==void 0?r:ti;let o=t.getLineDash();e.lineDash=o?o.slice():ie;let s=t.getLineDashOffset();e.lineDashOffset=s||ne;let a=t.getLineJoin();e.lineJoin=a!==void 0?a:ei;let l=t.getWidth();e.lineWidth=l!==void 0?l:Ei;let c=t.getMiterLimit();e.miterLimit=c!==void 0?c:_i,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){let i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){let e=t.fillStyle,i=[z.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[z.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){let i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){let i=t.strokeStyle,r=t.lineCap,o=t.lineDash,s=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||o!=t.currentLineDash&&!Ut(t.currentLineDash,o)||t.currentLineDashOffset!=s||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=o,t.currentLineDashOffset=s,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;let e=[z.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Po(this.maxExtent),this.maxLineWidth>0)){let t=this.resolution*(this.maxLineWidth+1)/2;Mn(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},ri=$c;var Jc=class extends ri{constructor(t,e,i,r){super(t,e,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Ne(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);let r=t.getFlatCoordinates(),o=t.getStride(),s=this.coordinates.length,a=this.appendFlatPointCoordinates(r,o);this.instructions.push([z.DRAW_IMAGE,s,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([z.DRAW_IMAGE,s,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);let r=t.getFlatCoordinates(),o=[];for(let l=0,c=r.length;l<c;l+=t.getStride())(!this.maxExtent||Ne(this.maxExtent,r.slice(l,l+2)))&&o.push(r[l],r[l+1]);let s=this.coordinates.length,a=this.appendFlatPointCoordinates(o,2);this.instructions.push([z.DRAW_IMAGE,s,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([z.DRAW_IMAGE,s,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){let i=t.getAnchor(),r=t.getSize(),o=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=o[0],this.originY_=o[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},tm=Jc;var Qc=class extends ri{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinates_(t,e,i,r){let o=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,r,!1,!1),a=[z.MOVE_TO_LINE_TO,o,s];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){let r=this.state,o=r.strokeStyle,s=r.lineWidth;if(o===void 0||s===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ie,ne],vi);let a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(ni),this.endGeometry(e)}drawMultiLineString(t,e,i){let r=this.state,o=r.strokeStyle,s=r.lineWidth;if(o===void 0||s===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ie,ne],vi);let a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride(),u=0;for(let h=0,d=a.length;h<d;++h)u=this.drawFlatCoordinates_(l,u,a[h],c);this.hitDetectionInstructions.push(ni),this.endGeometry(e)}finish(){let t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ni),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ni),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(vi)}},em=Qc;var tu=class extends ri{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinatess_(t,e,i,r){let o=this.state,s=o.fillStyle!==void 0,a=o.strokeStyle!==void 0,l=i.length;this.instructions.push(vi),this.hitDetectionInstructions.push(vi);for(let c=0;c<l;++c){let u=i[c],h=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,u,r,!0,!a),f=[z.MOVE_TO_LINE_TO,h,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(Hc),this.hitDetectionInstructions.push(Hc)),e=u}return s&&(this.instructions.push(Qr),this.hitDetectionInstructions.push(Qr)),a&&(this.instructions.push(ni),this.hitDetectionInstructions.push(ni)),e}drawCircle(t,e,i){let r=this.state,o=r.fillStyle,s=r.strokeStyle;if(o===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([z.SET_FILL_STYLE,Dt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ie,ne]);let a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);let u=[z.CIRCLE,c];this.instructions.push(vi,u),this.hitDetectionInstructions.push(vi,u),r.fillStyle!==void 0&&(this.instructions.push(Qr),this.hitDetectionInstructions.push(Qr)),r.strokeStyle!==void 0&&(this.instructions.push(ni),this.hitDetectionInstructions.push(ni)),this.endGeometry(e)}drawPolygon(t,e,i){let r=this.state,o=r.fillStyle,s=r.strokeStyle;if(o===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([z.SET_FILL_STYLE,Dt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ie,ne]);let a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,i){let r=this.state,o=r.fillStyle,s=r.strokeStyle;if(o===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([z.SET_FILL_STYLE,Dt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ie,ne]);let a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride(),u=0;for(let h=0,d=a.length;h<d;++h)u=this.drawFlatCoordinatess_(l,u,a[h],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;let t=this.tolerance;if(t!==0){let e=this.coordinates;for(let i=0,r=e.length;i<r;++i)e[i]=Fi(e[i],t)}return super.finish()}setFillStrokeStyles_(){let t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}},eu=tu;function im(n,t,e,i,r){let o=[],s=e,a=0,l=t.slice(e,2);for(;a<n&&s+r<i;){let[c,u]=l.slice(-2),h=t[s+r],d=t[s+r+1],f=Math.sqrt((h-c)*(h-c)+(d-u)*(d-u));if(a+=f,a>=n){let p=(n-a+f)/f,g=Kt(c,h,p),m=Kt(u,d,p);l.push(g,m),o.push(l),l=[g,m],a==n&&(s+=r),a=0}else if(a<n)l.push(t[s+r],t[s+r+1]),s+=r;else{let p=f-a,g=Kt(c,h,p/f),m=Kt(u,d,p/f);l.push(g,m),o.push(l),l=[g,m],a=0,s+=r}}return a>0&&o.push(l),o}function nm(n,t,e,i,r){let o=e,s=e,a=0,l=0,c=e,u,h,d,f,p,g,m,_,x,C;for(h=e;h<i;h+=r){let y=t[h],E=t[h+1];p!==void 0&&(x=y-p,C=E-g,f=Math.sqrt(x*x+C*C),m!==void 0&&(l+=d,u=Math.acos((m*x+_*C)/(d*f)),u>n&&(l>a&&(a=l,o=c,s=h),l=0,c=h-r)),d=f,m=x,_=C),p=y,g=E}return l+=f,l>a?[c,h]:[o,s]}var to={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},iu=class extends ri{constructor(t,e,i,r){super(t,e,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Dt]={fillStyle:Dt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){let t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){let r=this.textFillState_,o=this.textStrokeState_,s=this.textState_;if(this.text_===""||!s||!r&&!o)return;let a=this.coordinates,l=a.length,c=t.getType(),u=null,h=t.getStride();if(s.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!_t(this.maxExtent,t.getExtent()))return;let d;if(u=t.getFlatCoordinates(),c=="LineString")d=[u.length];else if(c=="MultiLineString")d=t.getEnds();else if(c=="Polygon")d=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){let m=t.getEndss();d=[];for(let _=0,x=m.length;_<x;++_)d.push(m[_][0])}this.beginGeometry(t,e,i);let f=s.repeat,p=f?void 0:s.textAlign,g=0;for(let m=0,_=d.length;m<_;++m){let x;f?x=im(f*this.resolution,u,g,d[m],h):x=[u.slice(g,d[m])];for(let C=0,y=x.length;C<y;++C){let E=x[C],v=0,T=E.length;if(p==null){let I=nm(s.maxAngle,E,0,E.length,2);v=I[0],T=I[1]}for(let I=v;I<T;I+=h)a.push(E[I],E[I+1]);let S=a.length;g=d[m],this.drawChars_(l,S),l=S}}this.endGeometry(e)}else{let d=s.overflow?null:[];switch(c){case"Point":case"MultiPoint":u=t.getFlatCoordinates();break;case"LineString":u=t.getFlatMidpoint();break;case"Circle":u=t.getCenter();break;case"MultiLineString":u=t.getFlatMidpoints(),h=2;break;case"Polygon":u=t.getFlatInteriorPoint(),s.overflow||d.push(u[2]/this.resolution),h=3;break;case"MultiPolygon":let y=t.getFlatInteriorPoints();u=[];for(let E=0,v=y.length;E<v;E+=3)s.overflow||d.push(y[E+2]/this.resolution),u.push(y[E],y[E+1]);if(u.length===0)return;h=2;break;default:}let f=this.appendFlatPointCoordinates(u,h);if(f===l)return;if(d&&(f-l)/2!==u.length/h){let y=l/2;d=d.filter((E,v)=>{let T=a[(y+v)*2]===u[v*h]&&a[(y+v)*2+1]===u[v*h+1];return T||--y,T})}this.saveTextStates_();let p=s.backgroundFill?this.createFill(this.fillStyleToState(s.backgroundFill)):null,g=s.backgroundStroke?this.createStroke(this.strokeStyleToState(s.backgroundStroke)):null;this.beginGeometry(t,e,i);let m=s.padding;if(m!=yi&&(s.scale[0]<0||s.scale[1]<0)){let y=s.padding[0],E=s.padding[1],v=s.padding[2],T=s.padding[3];s.scale[0]<0&&(E=-E,T=-T),s.scale[1]<0&&(y=-y,v=-v),m=[y,E,v,T]}let _=this.pixelRatio;this.instructions.push([z.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==yi?yi:m.map(function(y){return y*_}),p,g,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);let x=1/_,C=p?p.slice(0):null;C&&(C[1]=Dt),this.hitDetectionInstructions.push([z.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[x,x],NaN,this.declutterMode_,this.declutterImageWithText_,m,C,g,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Dt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(e)}}saveTextStates_(){let t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));let o=this.textKey_;o in this.textStates||(this.textStates[o]={font:e.font,textAlign:e.textAlign||Wi,justify:e.justify,textBaseline:e.textBaseline||un,scale:e.scale});let s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){let i=this.textStrokeState_,r=this.textState_,o=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();let l=this.pixelRatio,c=to[r.textBaseline],u=this.textOffsetY_*l,h=this.text_,d=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([z.DRAW_CHARS,t,e,c,r.overflow,a,r.maxAngle,l,u,o,d*l,h,s,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([z.DRAW_CHARS,t,e,c,r.overflow,a&&Dt,r.maxAngle,l,u,o,d*l,h,s,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,r,o;if(!t)this.text_="";else{let s=t.getFill();s?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=ee(s.getColor()||Dt)):(r=null,this.textFillState_=r);let a=t.getStroke();if(!a)o=null,this.textStrokeState_=o;else{o=this.textStrokeState_,o||(o={},this.textStrokeState_=o);let g=a.getLineDash(),m=a.getLineDashOffset(),_=a.getWidth(),x=a.getMiterLimit();o.lineCap=a.getLineCap()||ti,o.lineDash=g?g.slice():ie,o.lineDashOffset=m===void 0?ne:m,o.lineJoin=a.getLineJoin()||ei,o.lineWidth=_===void 0?Ei:_,o.miterLimit=x===void 0?_i:x,o.strokeStyle=ee(a.getColor()||xi)}i=this.textState_;let l=t.getFont()||_s;$f(l);let c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||un,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||yi,i.scale=c===void 0?[1,1]:c;let u=t.getOffsetX(),h=t.getOffsetY(),d=t.getRotateWithView(),f=t.getKeepUpright(),p=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=p===void 0?0:p,this.strokeKey_=o?(typeof o.strokeStyle=="string"?o.strokeStyle:B(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+B(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},rm=iu;var hx={Circle:eu,Default:ri,Image:tm,LineString:em,Polygon:eu,Text:rm},nu=class{constructor(t,e,i,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){let t={};for(let e in this.buildersByZIndex_){t[e]=t[e]||{};let i=this.buildersByZIndex_[e];for(let r in i){let o=i[r].finish();t[e][r]=o}}return t}getBuilder(t,e){let i=t!==void 0?t.toString():"0",r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let o=r[e];if(o===void 0){let s=hx[e];o=new s(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=o}return o}},om=nu;function sm(n,t,e,i,r,o,s,a,l,c,u,h,d=!0){let f=n[t],p=n[t+1],g=0,m=0,_=0,x=0;function C(){g=f,m=p,t+=i,f=n[t],p=n[t+1],x+=_,_=Math.sqrt((f-g)*(f-g)+(p-m)*(p-m))}do C();while(t<e-i&&x+_<o);let y=_===0?0:(o-x)/_,E=Kt(g,f,y),v=Kt(m,p,y),T=t-i,S=x,I=o+a*l(c,r,u);for(;t<e-i&&x+_<I;)C();y=_===0?0:(I-x)/_;let D=Kt(g,f,y),K=Kt(m,p,y),G=!1;if(d)if(h){let N=[E,v,D,K];$o(N,0,4,2,h,N,N),G=N[0]>N[2]}else G=E>D;let F=Math.PI,tt=[],W=T+i===t;t=T,_=0,x=S,f=n[t],p=n[t+1];let Y;if(W){C(),Y=Math.atan2(p-m,f-g),G&&(Y+=Y>0?-F:F);let N=(D+E)/2,V=(K+v)/2;return tt[0]=[N,V,(I-o)/2,Y,r],tt}r=r.replace(/\n/g," ");for(let N=0,V=r.length;N<V;){C();let q=Math.atan2(p-m,f-g);if(G&&(q+=q>0?-F:F),Y!==void 0){let wt=q-Y;if(wt+=wt>F?-2*F:wt<-F?2*F:0,Math.abs(wt)>s)return null}Y=q;let ot=N,ht=0;for(;N<V;++N){let wt=G?V-N-1:N,oe=a*l(c,r[wt],u);if(t+i<e&&x+_<o+ht+oe/2)break;ht+=oe}if(N===ot)continue;let b=G?r.substring(V-ot,V-N):r.substring(ot,N);y=_===0?0:(o+ht/2-x)/_;let Wt=Kt(g,f,y),jt=Kt(m,p,y);tt.push([Wt,jt,ht/2,q,b]),o+=ht}return tt}var lr=It(),Ui=[],Si=[],Ti=[],Ki=[];function am(n){return n[3].declutterBox}var lm=new RegExp("[\u0591-\u08FF\uFB1D-\uFDFF\uFE70-\uFEFC\u0800-\u0FFF\uE800-\uEFFF]");function ru(n,t){return t==="start"?t=lm.test(n)?"right":"left":t==="end"&&(t=lm.test(n)?"left":"right"),to[t]}function dx(n,t,e){return e>0&&n.push(`
`,""),n.push(t,""),n}function fx(n,t,e){return e%2===0&&(n+=t),n}var ou=class{constructor(t,e,i,r,o){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=kt(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=o?new Ps:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,r){let o=t+e+i+r;if(this.labels_[o])return this.labels_[o];let s=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],h=l.justify?to[l.justify]:ru(Array.isArray(t)?t[0]:t,l.textAlign||Wi),d=r&&s.lineWidth?s.lineWidth:0,f=Array.isArray(t)?t:String(t).split(`
`).reduce(dx,[]),{width:p,height:g,widths:m,heights:_,lineWidths:x}=Qf(l,f),C=p+d,y=[],E=(C+2)*u[0],v=(g+d)*u[1],T={width:E<0?Math.floor(E):Math.ceil(E),height:v<0?Math.floor(v):Math.ceil(v),contextInstructions:y};(u[0]!=1||u[1]!=1)&&y.push("scale",u),r&&(y.push("strokeStyle",s.strokeStyle),y.push("lineWidth",d),y.push("lineCap",s.lineCap),y.push("lineJoin",s.lineJoin),y.push("miterLimit",s.miterLimit),y.push("setLineDash",[s.lineDash]),y.push("lineDashOffset",s.lineDashOffset)),i&&y.push("fillStyle",a.fillStyle),y.push("textBaseline","middle"),y.push("textAlign","center");let S=.5-h,I=h*C+S*d,D=[],K=[],G=0,F=0,tt=0,W=0,Y;for(let N=0,V=f.length;N<V;N+=2){let q=f[N];if(q===`
`){F+=G,G=0,I=h*C+S*d,++W;continue}let ot=f[N+1]||l.font;ot!==Y&&(r&&D.push("font",ot),i&&K.push("font",ot),Y=ot),G=Math.max(G,_[tt]);let ht=[q,I+S*m[tt]+h*(m[tt]-x[W]),.5*(d+G)+F];I+=m[tt],r&&D.push("strokeText",ht),i&&K.push("fillText",ht),++tt}return Array.prototype.push.apply(y,D),Array.prototype.push.apply(y,K),this.labels_[o]=T,T}replayTextBackground_(t,e,i,r,o,s,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,o),t.lineTo.apply(t,e),s&&(this.alignAndScaleFill_=s[2],t.fillStyle=s[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,r,o,s,a,l,c,u,h,d,f,p,g,m){a*=d[0],l*=d[1];let _=i-a,x=r-l,C=o+c>t?t-c:o,y=s+u>e?e-u:s,E=p[3]+C*d[0]+p[1],v=p[0]+y*d[1]+p[2],T=_-p[3],S=x-p[0];(g||h!==0)&&(Ui[0]=T,Ki[0]=T,Ui[1]=S,Si[1]=S,Si[0]=T+E,Ti[0]=Si[0],Ti[1]=S+v,Ki[1]=Ti[1]);let I;return h!==0?(I=zt(kt(),i,r,1,1,h,-i,-r),xt(I,Ui),xt(I,Si),xt(I,Ti),xt(I,Ki),ce(Math.min(Ui[0],Si[0],Ti[0],Ki[0]),Math.min(Ui[1],Si[1],Ti[1],Ki[1]),Math.max(Ui[0],Si[0],Ti[0],Ki[0]),Math.max(Ui[1],Si[1],Ti[1],Ki[1]),lr)):ce(Math.min(T,T+E),Math.min(S,S+v),Math.max(T,T+E),Math.max(S,S+v),lr),f&&(_=Math.round(_),x=Math.round(x)),{drawImageX:_,drawImageY:x,drawImageW:C,drawImageH:y,originX:c,originY:u,declutterBox:{minX:lr[0],minY:lr[1],maxX:lr[2],maxY:lr[3],value:m},canvasTransform:I,scale:d}}replayImageOrLabel_(t,e,i,r,o,s,a){let l=!!(s||a),c=r.declutterBox,u=a?a[2]*r.scale[0]/2:0;return c.minX-u<=e[0]&&c.maxX+u>=0&&c.minY-u<=e[1]&&c.maxY+u>=0&&(l&&this.replayTextBackground_(t,Ui,Si,Ti,Ki,s,a),tp(t,r.canvasTransform,o,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){let e=this.alignAndScaleFill_;if(e){let i=xt(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,r){let o=this.textStates[e],s=this.createLabel(t,e,r,i),a=this.strokeStates[i],l=this.pixelRatio,c=ru(Array.isArray(t)?t[0]:t,o.textAlign||Wi),u=to[o.textBaseline||un],h=a&&a.lineWidth?a.lineWidth:0,d=s.width/l-2*o.scale[0],f=c*d+2*(.5-c)*h,p=u*s.height/l+2*(.5-u)*h;return{label:s,anchorX:f,anchorY:p}}execute_(t,e,i,r,o,s,a,l){let c=this.zIndexContext_,u;this.pixelCoordinates_&&Ut(i,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=te(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Nd(this.renderedTransform_,i));let h=0,d=r.length,f=0,p,g,m,_,x,C,y,E,v,T,S,I,D,K=0,G=0,F=this.coordinateCache_,tt=this.viewRotation_,W=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,Y={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:tt},N=this.instructions!=r||this.overlaps?0:200,V,q,ot,ht;for(;h<d;){let b=r[h];switch(b[0]){case z.BEGIN_GEOMETRY:V=b[1],ht=b[3],V.getGeometry()?a!==void 0&&!_t(a,ht.getExtent())?h=b[2]+1:++h:h=b[2],c&&(c.zIndex=b[4]);break;case z.BEGIN_PATH:K>N&&(this.fill_(t),K=0),G>N&&(t.stroke(),G=0),!K&&!G&&(t.beginPath(),x=NaN,C=NaN),++h;break;case z.CIRCLE:f=b[1];let jt=u[f],wt=u[f+1],oe=u[f+2],Xt=u[f+3],Ue=oe-jt,Ae=Xt-wt,se=Math.sqrt(Ue*Ue+Ae*Ae);t.moveTo(jt+se,wt),t.arc(jt,wt,se,0,2*Math.PI,!0),++h;break;case z.CLOSE_PATH:t.closePath(),++h;break;case z.CUSTOM:f=b[1],p=b[2];let no=b[3],Us=b[4],cr=b[5];Y.geometry=no,Y.feature=V,h in F||(F[h]=[]);let Bi=F[h];cr?cr(u,f,p,2,Bi):(Bi[0]=u[f],Bi[1]=u[f+1],Bi.length=2),c&&(c.zIndex=b[6]),Us(Bi,Y),++h;break;case z.DRAW_IMAGE:f=b[1],p=b[2],v=b[3],g=b[4],m=b[5];let fe=b[6],Ke=b[7],gn=b[8],_n=b[9],ur=b[10],Yi=b[11],xn=b[12],yn=b[13];_=b[14]||"declutter";let Pt=b[15];if(!v&&b.length>=20){T=b[19],S=b[20],I=b[21],D=b[22];let pe=this.drawLabelWithPointPlacement_(T,S,I,D);v=pe.label,b[3]=v;let ji=b[23];g=(pe.anchorX-ji)*this.pixelRatio,b[4]=g;let me=b[24];m=(pe.anchorY-me)*this.pixelRatio,b[5]=m,fe=v.height,b[6]=fe,yn=v.width,b[13]=yn}let Ks;b.length>25&&(Ks=b[25]);let Bs,ro,oo;b.length>17?(Bs=b[16],ro=b[17],oo=b[18]):(Bs=yi,ro=null,oo=null),ur&&W?Yi+=tt:!ur&&!W&&(Yi-=tt);let _m=0;for(;f<p;f+=2){if(Ks&&Ks[_m++]<yn/this.pixelRatio)continue;let pe=this.calculateImageOrLabelDimensions_(v.width,v.height,u[f],u[f+1],yn,fe,g,m,gn,_n,Yi,xn,o,Bs,!!ro||!!oo,V),ji=[t,e,v,pe,Ke,ro,oo];if(l){let me,Be,ge;if(Pt){let yt=p-f;if(!Pt[yt]){Pt[yt]={args:ji,declutterMode:_};continue}let Zt=Pt[yt];me=Zt.args,Be=Zt.declutterMode,delete Pt[yt],ge=am(me)}let oi,si;if(me&&(Be!=="declutter"||!l.collides(ge))&&(oi=!0),(_!=="declutter"||!l.collides(pe.declutterBox))&&(si=!0),Be==="declutter"&&_==="declutter"){let yt=oi&&si;oi=yt,si=yt}oi&&(Be!=="none"&&l.insert(ge),this.replayImageOrLabel_.apply(this,me)),si&&(_!=="none"&&l.insert(pe.declutterBox),this.replayImageOrLabel_.apply(this,ji))}else this.replayImageOrLabel_.apply(this,ji)}++h;break;case z.DRAW_CHARS:let pu=b[1],mu=b[2],Ys=b[3],xm=b[4];D=b[5];let ym=b[6],gu=b[7],_u=b[8];I=b[9];let js=b[10];T=b[11],Array.isArray(T)&&(T=T.reduce(fx,"")),S=b[12];let xu=[b[13],b[13]];_=b[14]||"declutter";let Em=b[15],Zs=this.textStates[S],hr=Zs.font,dr=[Zs.scale[0]*gu,Zs.scale[1]*gu],fr;hr in this.widths_?fr=this.widths_[hr]:(fr={},this.widths_[hr]=fr);let yu=Yp(u,pu,mu,2),Eu=Math.abs(dr[0])*jl(hr,T,fr);if(xm||Eu<=yu){let pe=this.textStates[S].textAlign,ji=(yu-Eu)*ru(T,pe),me=sm(u,pu,mu,2,T,ji,ym,Math.abs(dr[0]),jl,hr,fr,W?0:this.viewRotation_,Em);t:if(me){let Be=[],ge,oi,si,yt,Zt;if(I)for(ge=0,oi=me.length;ge<oi;++ge){Zt=me[ge],si=Zt[4],yt=this.createLabel(si,S,"",I),g=Zt[2]+(dr[0]<0?-js:js),m=Ys*yt.height+(.5-Ys)*2*js*dr[1]/dr[0]-_u;let ai=this.calculateImageOrLabelDimensions_(yt.width,yt.height,Zt[0],Zt[1],yt.width,yt.height,g,m,0,0,Zt[3],xu,!1,yi,!1,V);if(l&&_==="declutter"&&l.collides(ai.declutterBox))break t;Be.push([t,e,yt,ai,1,null,null])}if(D)for(ge=0,oi=me.length;ge<oi;++ge){Zt=me[ge],si=Zt[4],yt=this.createLabel(si,S,D,""),g=Zt[2],m=Ys*yt.height-_u;let ai=this.calculateImageOrLabelDimensions_(yt.width,yt.height,Zt[0],Zt[1],yt.width,yt.height,g,m,0,0,Zt[3],xu,!1,yi,!1,V);if(l&&_==="declutter"&&l.collides(ai.declutterBox))break t;Be.push([t,e,yt,ai,1,null,null])}l&&_!=="none"&&l.load(Be.map(am));for(let ai=0,Cm=Be.length;ai<Cm;++ai)this.replayImageOrLabel_.apply(this,Be[ai])}}++h;break;case z.END_GEOMETRY:if(s!==void 0){V=b[1];let pe=s(V,ht,_);if(pe)return pe}++h;break;case z.FILL:N?K++:this.fill_(t),++h;break;case z.MOVE_TO_LINE_TO:for(f=b[1],p=b[2],q=u[f],ot=u[f+1],t.moveTo(q,ot),x=q+.5|0,C=ot+.5|0,f+=2;f<p;f+=2)q=u[f],ot=u[f+1],y=q+.5|0,E=ot+.5|0,(f==p-2||y!==x||E!==C)&&(t.lineTo(q,ot),x=y,C=E);++h;break;case z.SET_FILL_STYLE:this.alignAndScaleFill_=b[2],K&&(this.fill_(t),K=0,G&&(t.stroke(),G=0)),t.fillStyle=b[1],++h;break;case z.SET_STROKE_STYLE:G&&(t.stroke(),G=0),this.setStrokeStyle_(t,b),++h;break;case z.STROKE:N?G++:t.stroke(),++h;break;default:++h;break}}K&&this.fill_(t),G&&t.stroke()}execute(t,e,i,r,o,s){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,o,void 0,void 0,s)}executeHitDetection(t,e,i,r,o){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,o)}},cm=ou;var mn=["Polygon","Circle","LineString","Image","Text","Default"],lu=["Image","Text"],um=mn.filter(n=>!lu.includes(n)),au=class{constructor(t,e,i,r,o,s,a){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=kt(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(o,a)}clip(t,e){let i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(let i in t){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);let o=t[i];for(let s in o){let a=o[s];r[s]=new cm(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(let e in this.executorsByZIndex_){let i=this.executorsByZIndex_[e];for(let r=0,o=t.length;r<o;++r)if(t[r]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,o,s){r=Math.round(r);let a=r*2+1,l=zt(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ut(a,a));let u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=It(),tn(h,t),Mn(h,e*(this.renderBuffer_+r),h));let d=px(r),f;function p(E,v,T){let S=u.getImageData(0,0,a,a).data;for(let I=0,D=d.length;I<D;I++)if(S[d[I]]>0){if(!s||T==="none"||f!=="Image"&&f!=="Text"||s.includes(E)){let K=(d[I]-3)/4,G=r-K%a,F=r-(K/a|0),tt=o(E,v,G*G+F*F);if(tt)return tt}u.clearRect(0,0,a,a);break}}let g=Object.keys(this.executorsByZIndex_).map(Number);g.sort(Jt);let m,_,x,C,y;for(m=g.length-1;m>=0;--m){let E=g[m].toString();for(x=this.executorsByZIndex_[E],_=mn.length-1;_>=0;--_)if(f=mn[_],C=x[f],C!==void 0&&(y=C.executeHitDetection(u,l,i,p,h),y))return y}}getClipCoords(t){let e=this.maxExtent_;if(!e)return null;let i=e[0],r=e[1],o=e[2],s=e[3],a=[i,r,i,s,o,s,o,r];return te(a,0,8,2,t,a),a}isEmpty(){return Pe(this.executorsByZIndex_)}execute(t,e,i,r,o,s,a){let l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?Kh:Jt),s=s||mn;let c=mn.length;for(let u=0,h=l.length;u<h;++u){let d=l[u].toString(),f=this.executorsByZIndex_[d];for(let p=0,g=s.length;p<g;++p){let m=s[p],_=f[m];if(_!==void 0){let x=a===null?void 0:_.getZIndexContext(),C=x?x.getContext():t,y=this.maxExtent_&&m!=="Image"&&m!=="Text";if(y&&(C.save(),this.clip(C,i)),!x||m==="Text"||m==="Image"?_.execute(C,e,i,r,o,a):x.pushFunction(E=>_.execute(E,e,i,r,o,a)),y&&C.restore(),x){x.offset();let E=l[u]*c+p;this.deferredZIndexContexts_[E]||(this.deferredZIndexContexts_[E]=[]),this.deferredZIndexContexts_[E].push(x)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){let t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(Jt);for(let i=0,r=e.length;i<r;++i)t[e[i]].forEach(o=>{o.draw(this.renderedContext_),o.clear()}),t[e[i]].length=0}},su={};function px(n){if(su[n]!==void 0)return su[n];let t=n*2+1,e=n*n,i=new Array(e+1);for(let o=0;o<=n;++o)for(let s=0;s<=n;++s){let a=o*o+s*s;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+o)*t+(n+s))*4+3),o>0&&l.push(((n-o)*t+(n+s))*4+3),s>0&&(l.push(((n+o)*t+(n-s))*4+3),o>0&&l.push(((n-o)*t+(n-s))*4+3))}let r=[];for(let o=0,s=i.length;o<s;++o)i[o]&&r.push(...i[o]);return su[n]=r,r}var hm=au;var Xe=.5;function dm(n,t,e,i,r,o,s,a,l){let c=l?Di(r,l):r,u=n[0]*Xe,h=n[1]*Xe,d=ut(u,h);d.imageSmoothingEnabled=!1;let f=d.canvas,p=new jp(d,Xe,r,null,s,a,l?rn(gi(),l):null),g=e.length,m=Math.floor((256*256*256-1)/g),_={};for(let C=1;C<=g;++C){let y=e[C-1],E=y.getStyleFunction()||i;if(!E)continue;let v=E(y,o);if(!v)continue;Array.isArray(v)||(v=[v]);let S=(C*m).toString(16).padStart(7,"#00000");for(let I=0,D=v.length;I<D;++I){let K=v[I],G=K.getGeometryFunction()(y);if(!G||!_t(c,G.getExtent()))continue;let F=K.clone(),tt=F.getFill();tt&&tt.setColor(S);let W=F.getStroke();W&&(W.setColor(S),W.setLineDash(null)),F.setText(void 0);let Y=K.getImage();if(Y){let ot=Y.getImageSize();if(!ot)continue;let ht=ut(ot[0],ot[1],void 0,{alpha:!1}),b=ht.canvas;ht.fillStyle=S,ht.fillRect(0,0,b.width,b.height),F.setImage(new hn({img:b,anchor:Y.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Y.getOrigin(),opacity:1,size:Y.getSize(),scale:Y.getScale(),rotation:Y.getRotation(),rotateWithView:Y.getRotateWithView()}))}let N=F.getZIndex()||0,V=_[N];V||(V={},_[N]=V,V.Polygon=[],V.Circle=[],V.LineString=[],V.Point=[]);let q=G.getType();if(q==="GeometryCollection"){let ot=G.getGeometriesArrayRecursive();for(let ht=0,b=ot.length;ht<b;++ht){let Wt=ot[ht];V[Wt.getType().replace("Multi","")].push(Wt,F)}}else V[q.replace("Multi","")].push(G,F)}}let x=Object.keys(_).map(Number).sort(Jt);for(let C=0,y=x.length;C<y;++C){let E=_[x[C]];for(let v in E){let T=E[v];for(let S=0,I=T.length;S<I;S+=2){p.setStyle(T[S+1]);for(let D=0,K=t.length;D<K;++D)p.setTransform(t[D]),p.drawGeometry(T[S])}}}return d.getImageData(0,0,f.width,f.height)}function fm(n,t,e){let i=[];if(e){let r=Math.floor(Math.round(n[0])*Xe),o=Math.floor(Math.round(n[1])*Xe),s=(at(r,0,e.width-1)+at(o,0,e.height-1)*e.width)*4,a=e.data[s],l=e.data[s+1],u=e.data[s+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/t.length);u&&u%h===0&&i.push(t[u/h-1])}return i}var cu=class extends Fs{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=It(),this.wrappedRenderedExtent_=It(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){let r=e.extent,o=e.viewState,s=o.center,a=o.resolution,l=o.projection,c=o.rotation,u=l.getExtent(),h=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=e.pixelRatio,p=e.viewHints,g=!(p[Ot.ANIMATING]||p[Ot.INTERACTING]),m=this.context,_=Math.round(H(r)/a*f),x=Math.round(mt(r)/a*f),C=h.getWrapX()&&l.canWrapX(),y=C?H(u):null,E=C?Math.ceil((r[2]-u[2])/y)+1:1,v=C?Math.floor((r[0]-u[0])/y):0;do{let T=this.getRenderTransform(s,a,0,f,_,x,v*y);e.declutter&&(T=T.slice(0)),t.execute(m,[m.canvas.width,m.canvas.height],T,c,g,i===void 0?mn:i?lu:um,i?d&&e.declutter[d]:void 0)}while(++v<E)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ut(this.context.canvas.width,this.context.canvas.height,Sc))}resetDrawContext_(){if(this.opacity_!==1){let t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,sn(this.context),Sc.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){let i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;let r=t.viewState;this.prepareContainer(t,e);let o=this.context,s=this.replayGroup_,a=s&&!s.isEmpty();if(!a&&!(this.getLayer().hasListener(Vt.PRERENDER)||this.getLayer().hasListener(Vt.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(o,t);let l=r.projection;if(this.clipped_=!1,a&&i.extent&&this.clipping){let c=be(i.extent,l);a=_t(c,t.extent),this.clipped_=a&&!Ji(c,t.extent),this.clipped_&&this.clipUnrotated(o,t,c)}return a&&this.renderWorlds(s,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&o.restore(),this.postRender(o,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){let i=this.frameState.size.slice(),r=this.renderedCenter_,o=this.renderedResolution_,s=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],h=i[0]*Xe,d=i[1]*Xe;u.push(this.getRenderTransform(r,o,s,Xe,h,d,0).slice());let f=c.getSource(),p=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!Ji(p,l)){let m=l[0],_=H(p),x=0,C;for(;m<p[0];)--x,C=_*x,u.push(this.getRenderTransform(r,o,s,Xe,h,d,C).slice()),m+=_;for(x=0,m=l[2];m>p[2];)++x,C=_*x,u.push(this.getRenderTransform(r,o,s,Xe,h,d,C).slice()),m-=_}let g=gi();this.hitDetectionImageData_=dm(i,u,this.renderedFeatures_,c.getStyleFunction(),l,o,s,Xc(o,this.renderedPixelRatio_),g?a:null)}e(fm(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,r,o){if(!this.replayGroup_)return;let s=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},u=function(d,f,p){let g=B(d),m=c[g];if(m){if(m!==!0&&p<m.distanceSq){if(p===0)return c[g]=!0,o.splice(o.lastIndexOf(m),1),r(d,l,f);m.geometry=f,m.distanceSq=p}}else{if(p===0)return c[g]=!0,r(d,l,f);o.push(c[g]={feature:d,layer:l,geometry:f,distanceSq:p,callback:r})}},h=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,s,a,i,u,h?e.declutter?.[h]?.all().map(d=>d.value):null)}handleFontsChanged(){let t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){let e=this.getLayer(),i=e.getSource();if(!i)return!1;let r=t.viewHints[Ot.ANIMATING],o=t.viewHints[Ot.INTERACTING],s=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!s&&r||!a&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;let l=t.extent,c=t.viewState,u=c.projection,h=c.resolution,d=t.pixelRatio,f=e.getRevision(),p=e.getRenderBuffer(),g=e.getRenderOrder();g===void 0&&(g=qp);let m=c.center.slice(),_=Mn(l,p*h),x=_.slice(),C=[_.slice()],y=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!Ji(y,t.extent)){let W=H(y),Y=Math.max(H(_)/2,W);_[0]=y[0]-Y,_[2]=y[2]+Y,zo(m,u);let N=ya(C[0],u);N[0]<y[0]&&N[2]<y[2]?C.push([N[0]+W,N[1],N[2]+W,N[3]]):N[0]>y[0]&&N[2]>y[2]&&C.push([N[0]-W,N[1],N[2]-W,N[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&this.renderedFrameDeclutter_===!!t.declutter&&Ji(this.wrappedRenderedExtent_,_))return Ut(this.renderedExtent_,x)||(this.hitDetectionImageData_=null,this.renderedExtent_=x),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;let E=new om(Uc(h,d),_,h,d),v=gi(),T;if(v){for(let W=0,Y=C.length;W<Y;++W){let N=C[W],V=Di(N,u);i.loadFeatures(V,Fd(h,u),v)}T=rn(v,u)}else for(let W=0,Y=C.length;W<Y;++W)i.loadFeatures(C[W],h,u);let S=Xc(h,d),I=!0,D=(W,Y)=>{let N,V=W.getStyleFunction()||e.getStyleFunction();if(V&&(N=V(W,h)),N){let q=this.renderFeature(W,S,N,E,T,this.getLayer().getDeclutter(),Y);I=I&&!q}},K=Di(_,u),G=i.getFeaturesInExtent(K);g&&G.sort(g);for(let W=0,Y=G.length;W<Y;++W)D(G[W],W);this.renderedFeatures_=G,this.ready=I;let F=E.finish(),tt=new hm(_,h,d,i.getOverlaps(),F,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=h,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=x,this.wrappedRenderedExtent_=_,this.renderedCenter_=m,this.renderedProjection_=u,this.renderedPixelRatio_=d,this.replayGroup_=tt,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,r,o,s,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,u=i.length;c<u;++c)l=Kc(r,t,i[c],e,this.boundHandleStyleImageChange_,o,s,a)||l;else l=Kc(r,t,i,e,this.boundHandleStyleImageChange_,o,s,a);return l}},pm=cu;var uu=class extends bs{constructor(t){super(t)}createRenderer(){return new pm(this)}},hu=uu;var du={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},eo=class extends Rt{constructor(t,e,i,r,o){super(t),this.features=e,this.coordinate=i,this.startCoordinate=r,this.mapBrowserEvent=o}},fu=class extends Re{constructor(t){t=t||{},super(t),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=t.features!==void 0?t.features:null;let e;if(t.layers&&!this.features_)if(typeof t.layers=="function")e=t.layers;else{let i=t.layers;e=function(r){return i.includes(r)}}else e=Ce;this.layerFilter_=e,this.filter_=t.filter&&!this.features_?t.filter:Ce,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.condition_=t.condition?t.condition:ns,this.lastFeature_=null,this.addChangeListener(Mr.ACTIVE,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);let e=this.features_||new Tt([this.lastFeature_]);return this.dispatchEvent(new eo(du.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);let e=this.features_||new Tt([this.lastFeature_]);return this.dispatchEvent(new eo(du.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){let e=t.coordinate,i=t.map.getView().getProjection(),r=Qt(e,i),o=Qt(this.lastCoordinate_,i),s=r[0]-o[0],a=r[1]-o[1],l=this.features_||new Tt([this.lastFeature_]),c=gi();l.forEach(function(u){let h=u.getGeometry();c?(h.transform(c,i),h.translate(s,a),h.transform(i,c)):h.translate(s,a),u.setGeometry(h)}),this.lastCoordinate_=e,this.dispatchEvent(new eo(du.TRANSLATING,l,e,this.startCoordinate_,t))}}handleMoveEvent(t){let e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,(i,r)=>{if(!(!(i instanceof Hr)||!this.filter_(i,r))&&!(this.features_&&!this.features_.getArray().includes(i)))return i},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){let e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap(),i=this.getActive();(!e||!i)&&(e=e||t,e&&e.getViewport().classList.remove("ol-grab","ol-grabbing"))}},mm=fu;var Xs=class n{http=qt(zu);searchByDirection(t){let e=`https://nominatim.openstreetmap.org/search?format=json&accept-language=es&countrycodes=pe&layer=address&q=${t}`;return this.http.get(e).pipe(Tu(i=>i.filter(r=>!["state","region"].includes(r.addresstype))))}getAddressFromCoords(t,e){let i=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${t}&lon=${e}`;return this.http.get(i)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=lo({token:n,factory:n.\u0275fac,providedIn:"root"})};var xx=()=>({standalone:!0}),io=class n{ref=qt(wh);dialogService=qt(_r);openStreetService=qt(Xs);nacionalidadService=qt(Sh);sedeService=qt(vo);direccionItems=[];map;marker;querySearch;formData=new Qu({nombre:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),ruc:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),razonSocial:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),idState:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),idProvince:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),idCity:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),direccion:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),latitud:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),longitud:new Oe(void 0,{nonNullable:!0,validators:[Le.required]}),isActive:new Oe(!0,{nonNullable:!0,validators:[Le.required]})});paisDefault;listaPaises=[];listaDepartamentos=[];listaProvincias=[];listaCiudades=[];id;ngOnInit(){let t=this.dialogService.getInstance(this.ref);if(this.cargarPais(),t.data){let e=t.data;this.id=e.id,this.precargar()}}ngAfterViewInit(){this.initMap()}initMap(){this.marker=new Hr({geometry:new br(Zo([-77.0428,-12.0464]))}),this.marker.setStyle(new Ci({image:new hn({anchor:[.5,1],src:"https://cdn-icons-png.flaticon.com/512/684/684908.png",scale:.075})}));let t=new qc({features:[this.marker]}),e=new hu({source:t});this.map=new xp({target:"map",layers:[new Dp({source:new Bp}),e],view:new ue({center:Zo([-77.0428,-12.0464]),zoom:10})});let i=new mm({features:new Tt([this.marker])});this.map.addInteraction(i),i.on("translateend",r=>{let s=this.marker.getGeometry().getCoordinates(),a=Dd(s),l=a[0].toFixed(8),c=a[1].toFixed(8);this.getAddressFromCoords(c,l)})}get isActive(){return this.formData.get("isActive")?.value}precargar(){if(this.id){let t,e;this.sedeService.findOne(this.id).pipe(ao(i=>(e=i.city?.idProvince,t=i.city?.province?.idState,this.formData.get("nombre")?.setValue(i.nombre),this.formData.get("direccion")?.setValue(i.direccion),this.formData.get("ruc")?.setValue(i.ruc),this.formData.get("razonSocial")?.setValue(i.razonSocial),this.formData.get("latitud")?.setValue(i.latitud),this.formData.get("longitud")?.setValue(i.longitud),this.formData.get("idCity")?.setValue(i.idCity),this.formData.get("idProvince")?.setValue(e),this.formData.get("idState")?.setValue(t),this.formData.get("isActive")?.setValue(i.isActive),t?this.nacionalidadService.getProvinces(t):so([]))),ao(i=>(this.listaProvincias=i,e?this.nacionalidadService.getCiudades(e):so([])))).subscribe({next:i=>{this.listaCiudades=i;let{latitud:r,longitud:o}=this.formData.value;r&&o&&this.moverMapa(parseFloat(r),parseFloat(o))}})}}cargarPais(){this.nacionalidadService.getCountries().pipe(ao(t=>(this.listaPaises=t,this.paisDefault=this.listaPaises.find(e=>e.iso3==="PER"),this.paisDefault?.id?this.nacionalidadService.getStates(this.paisDefault.id):so([])))).subscribe({next:t=>{this.listaDepartamentos=t}})}cargarDepartamentos(){this.listaProvincias=[],this.listaCiudades=[],this.paisDefault?.id&&this.nacionalidadService.getStates(this.paisDefault.id).subscribe({next:t=>{this.listaDepartamentos=t}})}cargarProvincias(t){this.listaCiudades=[],this.nacionalidadService.getProvinces(t).subscribe({next:e=>{this.listaProvincias=e}})}cargarCiudades(t){this.nacionalidadService.getCiudades(t).subscribe({next:e=>{this.listaCiudades=e}})}onSelect(t){let{label:e,lat:i,lon:r}=t.value;this.formData.get("direccion")?.setValue(e),this.formData.get("latitud")?.setValue(parseFloat(i).toFixed(8)),this.formData.get("longitud")?.setValue(parseFloat(r).toFixed(8)),this.moverMapa(parseFloat(i),parseFloat(r))}buscarDireccion(t){let e="";this.querySearch===t.query?e=t.query:e=this.querySearch?.label??"",e.length>=2?this.openStreetService.searchByDirection(e).subscribe(i=>{this.direccionItems=i.map(r=>({label:r.display_name,lat:r.lat,lon:r.lon}))}):this.direccionItems=[]}buscarCoordenadas(t,e){this.moverMapa(t,e)}moverMapa(t,e){let i=Zo([e,t]);this.map.getView().setCenter(i),this.map.getView().setZoom(18),this.marker.getGeometry()?.setCoordinates(i)}getAddressFromCoords(t,e){this.openStreetService.getAddressFromCoords(t,e).subscribe(i=>{this.formData.get("direccion")?.setValue(i.display_name),this.formData.get("latitud")?.setValue(t),this.formData.get("longitud")?.setValue(e)})}guardar(){let r=this.formData.value,{idState:t,idProvince:e}=r,i=vu(r,["idState","idProvince"]);this.id?this.sedeService.update(this.id,wu(Cu({},i),{id:this.id})).subscribe({next:o=>{this.ref.close(o)}}):this.sedeService.create(i).subscribe({next:o=>{this.ref.close(o)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=En({type:n,selectors:[["app-form-sedes"]],decls:73,vars:15,consts:[[1,"grid","grid-cols-1","gap-6",3,"formGroup"],[1,"grid","grid-cols-3","gap-6"],[1,"flex","flex-col","gap-2"],["for","nombreSede",1,"text-sm","font-medium"],[1,"text-xs"],["id","nombreSede","pInputText","","formControlName","nombre"],["for","rucSede",1,"text-sm","font-medium"],["id","rucSede","pInputText","","formControlName","ruc"],["for","razonSocialSede",1,"text-sm","font-medium"],["id","razonSocialSede","pInputText","","formControlName","razonSocial"],["for","idStateSede",1,"text-sm","font-medium"],["id","idStateSede","optionLabel","name","optionValue","id","formControlName","idState","placeholder","Seleccione...","emptyFilterMessage","No se encontr\xF3 ning\xFAn resultado","emptyMessage","No se encontr\xF3 ning\xFAn resultado","appendTo","body",3,"ngModelChange","options","filter"],["for","idProvinceSede",1,"text-sm","font-medium"],["id","idProvinceSede","optionLabel","name","optionValue","id","formControlName","idProvince","placeholder","Seleccione...","emptyFilterMessage","No se encontr\xF3 ning\xFAn resultado","emptyMessage","No se encontr\xF3 ning\xFAn resultado","appendTo","body",3,"ngModelChange","options","filter"],["for","idCitySede",1,"text-sm","font-medium"],["id","idCitySede","optionLabel","name","optionValue","id","formControlName","idCity","placeholder","Seleccione...","emptyFilterMessage","No se encontr\xF3 ning\xFAn resultado","emptyMessage","No se encontr\xF3 ning\xFAn resultado","appendTo","body",3,"options","filter"],["for","direccionSede",1,"text-sm","font-medium"],["id","direccionSede","rows","3","cols","30","pTextarea","","formControlName","direccion"],[1,"col-span-2"],[1,"flex","flex-col","gap-3","mt-7"],[1,"flex","justify-end"],[1,"w-2/3"],["appendTo","body","styleClass","w-full","inputStyleClass","w-full","panelStyleClass","w-full","placeholder","Buscar direcci\xF3n","optionLabel","label",1,"w-full",3,"ngModelChange","completeMethod","onSelect","ngModel","suggestions","dropdown","ngModelOptions"],[1,"w-full","border","border-slate-300","rounded-md","overflow-hidden"],["id","map",1,"h-105","min-h-105"],[1,"flex","items-end"],["for","coordenadaSede",1,"text-sm","font-medium"],[1,"grid","grid-cols-2","gap-6"],["styleClass","text-xs"],["id","latitudSede","pInputText","","formControlName","latitud"],["id","longitudSede","pInputText","","formControlName","longitud"],[1,"flex","justify-between","gap-4"],[1,"flex","items-center","gap-2","py-1"],["formControlName","isActive","inputId","isActiveSede"],["for","isActiveSede",1,"text-sm","font-medium","pb-1.5"],["severity","info","size","small",3,"onClick","label","disabled"]],template:function(e,i){e&1&&(R(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",2)(4,"label",3),Q(5," Nombre "),R(6,"span",4),Q(7,"*"),O()(),ft(8,"input",5),O(),R(9,"div",2)(10,"label",6),Q(11," RUC "),R(12,"span",4),Q(13,"*"),O()(),ft(14,"input",7),O(),R(15,"div",2)(16,"label",8),Q(17," Raz\xF3n social "),R(18,"span",4),Q(19,"*"),O()(),ft(20,"input",9),O(),R(21,"div",2)(22,"label",10),Q(23," Departamento "),R(24,"span",4),Q(25,"*"),O()(),R(26,"p-select",11),pt("ngModelChange",function(o){return i.cargarProvincias(o)}),O()(),R(27,"div",2)(28,"label",12),Q(29," Provincia "),R(30,"span",4),Q(31,"*"),O()(),R(32,"p-select",13),pt("ngModelChange",function(o){return i.cargarCiudades(o)}),O()(),R(33,"div",2)(34,"label",14),Q(35," Cuidad "),R(36,"span",4),Q(37,"*"),O()(),ft(38,"p-select",15),O(),R(39,"div",2)(40,"label",16),Q(41," Direcci\xF3n "),R(42,"span",4),Q(43,"*"),O()(),ft(44,"textarea",17),O()(),R(45,"div",18)(46,"div",19)(47,"div",20)(48,"div",21)(49,"p-autocomplete",22),ho("ngModelChange",function(o){return uo(i.querySearch,o)||(i.querySearch=o),o}),pt("completeMethod",function(o){return i.buscarDireccion(o)})("onSelect",function(o){return i.onSelect(o)}),O()()(),R(50,"div",23),ft(51,"div",24),O(),R(52,"div",25)(53,"div",2)(54,"label",26),Q(55," Coordenadas "),R(56,"span",4),Q(57,"*"),O()(),R(58,"div",27)(59,"p-inputgroup")(60,"p-inputgroup-addon",28),Q(61,"Lat"),O(),ft(62,"input",29),O(),R(63,"p-inputgroup")(64,"p-inputgroup-addon",28),Q(65,"Lon"),O(),ft(66,"input",30),O()()()()()()(),R(67,"div",31)(68,"div",32),ft(69,"p-toggleswitch",33),R(70,"label",34),Q(71),O()(),R(72,"p-button",35),pt("onClick",function(){return i.guardar()}),O()()()),e&2&&(M("formGroup",i.formData),A(26),M("options",i.listaDepartamentos)("filter",!0),A(6),M("options",i.listaProvincias)("filter",!0),A(6),M("options",i.listaCiudades)("filter",!0),A(11),co("ngModel",i.querySearch),M("suggestions",i.direccionItems)("dropdown",!0)("ngModelOptions",Ii(14,xx)),A(22),$t(i.isActive?"Activo":"Inactivo"),A(),M("label",i.id?"Actualizar":"Guardar")("disabled",i.formData.invalid))},dependencies:[Cn,yo,eh,Hu,$u,Ju,th,rh,ih,nh,Th,Eo,vn,kh,Fh,Gh,Nh,wo,Co,yh,xh,Xh,To,Mh,Ah,bh,Ih],encapsulation:2})};var yx=()=>["nombre","direccion"],Ex=n=>[n],Cx=n=>["text-xs uppercase",n],wx=()=>[];function vx(n,t){if(n&1&&(R(0,"th",24)(1,"div",24),Q(2),O()()),n&2){let e=t.$implicit;M("ngClass",Ee(3,Ex,e.widthClass?e.widthClass:"")),A(),M("ngClass",Ee(5,Cx,e.align?"text-"+e.align:"text-start")),A(),gr(" ",e.header," ")}}function Sx(n,t){if(n&1&&(R(0,"tr"),nt(1,vx,3,7,"th",23),O()),n&2){let e=t.$implicit;A(),M("ngForOf",e)}}function Tx(n,t){if(n&1){let e=ae();R(0,"tr")(1,"td")(2,"div",25),Q(3),O()(),R(4,"td")(5,"div",26),Q(6),O()(),R(7,"td")(8,"div",27),Q(9),O()(),R(10,"td")(11,"div",27),Q(12),O()(),R(13,"td")(14,"div",27),Q(15),O()(),R(16,"td")(17,"div",25),Q(18),O()(),R(19,"td")(20,"div",25),Q(21),O()(),R(22,"td")(23,"div",28)(24,"p-tag",29),pt("click",function(){let r=et(e).$implicit,o=L();return it(o.changeStatus(r))}),O()()(),R(25,"td")(26,"div",30)(27,"p-button",31),pt("click",function(){let r=et(e).$implicit,o=L();return it(o.editar(r.id))}),ft(28,"i",32),O(),R(29,"p-button",33),pt("click",function(){let r=et(e).$implicit,o=L();return it(o.eliminar(r))}),ft(30,"i",32),O()()()()}if(n&2){let e=t.$implicit;A(3),$t(e.orden),A(3),$t(e.nombre),A(3),$t(e.direccion),A(3),$t(e.ruc),A(3),$t(e.razonSocial),A(3),$t(e.latitud),A(3),$t(e.longitud),A(3),M("value",e.isActive?"Activo":"Inactivo")("severity",e.isActive?"success":"warn"),A(4),bt("data-icon","solar:pen-new-square-linear"),A(2),bt("data-icon","solar:trash-bin-trash-broken")}}function Ix(n,t){n&1&&(R(0,"td"),ft(1,"p-skeleton"),O())}function bx(n,t){if(n&1&&(R(0,"tr",35),nt(1,Ix,2,0,"td",36),O()),n&2){let e=L(3);A(),M("ngForOf",e.cols)}}function Rx(n,t){n&1&&(xe(0),Pu(1,bx,2,1,"tr",35,Du),ye()),n&2&&(A(),Fu(Ii(0,wx).constructor(4)))}function Ax(n,t){n&1&&(R(0,"tr")(1,"td",37)(2,"div",38),Q(3," No se encontraron registros. "),O()()())}function Mx(n,t){if(n&1&&nt(0,Rx,3,1,"ng-container",34)(1,Ax,4,0,"ng-template",null,4,Me),n&2){let e=Zi(2),i=L();M("ngIf",i.loadingTable)("ngIfElse",e)}}var gm=class n{title="Edificios";icon="material-symbols:location-on-outline-rounded";msg=qt(Rh);dialogService=qt(_r);sedeService=qt(vo);cols;loadingTable=!1;exportColumns;dataTable=[];ngOnInit(){this.cols=[{field:"id",header:"ID",customExportHeader:"Sede ID",align:"center",widthClass:"!w-20"},{field:"nombre",header:"Nombre"},{field:"direccion",header:"Direcci\xF3n"},{field:"ruc",header:"RUC"},{field:"razonSocial",header:"Raz\xF3n social"},{field:"latitud",header:"Latitud",align:"center",widthClass:"!w-34"},{field:"longitud",header:"Longitud",align:"center",widthClass:"!w-34"},{field:"isActive",header:"Estado",align:"center",widthClass:"!w-28"},{field:"",header:"Acciones",align:"center",widthClass:"!w-36"}],this.exportColumns=this.cols.filter(t=>t.field!="").map(t=>({title:t.header,dataKey:t.field})),this.cargarSedes()}cargarSedes(){this.loadingTable=!0,this.sedeService.findAll(!1).subscribe(t=>{this.dataTable=t,this.loadingTable=!1})}addNew(){this.dialogService.open(io,{header:"Nuevo edificio",styleClass:"modal-6xl",modal:!0,dismissableMask:!0,closable:!0}).onClose.subscribe(e=>{e&&this.cargarSedes()})}editar(t){this.dialogService.open(io,{header:"Editar edificio",styleClass:"modal-6xl",data:{id:t},modal:!0,dismissableMask:!0,closable:!0}).onClose.subscribe(i=>{i&&this.cargarSedes()})}changeStatus(t){this.msg.confirm(`\xBFEst\xE1 seguro de ${t.isActive?"desactivar":"activar"} el edificio ${t.nombre}?`,()=>{this.sedeService.changeStatus(t.id,!t.isActive).subscribe({next:e=>{this.cargarSedes()}})})}eliminar(t){this.msg.confirm(`\xBFEst\xE1 seguro de eliminar el edificio ${t.nombre}? Esta acci\xF3n no se puede deshacer.`,()=>{this.sedeService.delete(t.id).subscribe({next:e=>{this.cargarSedes()}})})}filterGlobal(t,e){t.filterGlobal(e.value,"contains")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=En({type:n,selectors:[["app-sedes"]],features:[fo([_r])],decls:37,vars:9,consts:[["dt",""],["header",""],["body",""],["emptymessage",""],["elseTemplate",""],[1,"flex","flex-col","h-full"],[1,"flex","flex-col","justify-center","gap-4","px-6","py-4","h-[8.5rem]"],[1,"flex","justify-between","items-center","gap-4"],[1,"flex","items-center","gap-4"],["data-inline","false",1,"iconify","icon","font-bold","text-4xl"],[1,"text-2xl","font-semibold"],["severity","danger","size","small",3,"routerLink"],[1,"flex","justify-center","items-center","font-medium","gap-1"],["data-icon","uil:left-arrow-from-left","data-inline","false",1,"iconify","icon","text-lg"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],["styleClass","pi pi-search"],["type","text","pInputText","","placeholder","Buscar",3,"input"],["severity","info","size","small",3,"click"],["data-icon","uil:file-export","data-inline","false",1,"iconify","icon","text-lg"],["data-icon","uil:plus","data-inline","false",1,"iconify","icon","text-lg"],[1,"flex","flex-col","h-[calc(100%","-","8.5rem)]","px-6"],["dataKey","id","stripedRows","","scrollHeight","720px","styleClass","w-full","exportFilename","edificios",3,"value","scrollable","globalFilterFields","columns","exportHeader"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"text-center","text-sm"],[1,"text-start","text-sm","uppercase"],[1,"text-start","text-sm"],[1,"flex","justify-center","items-center","text-sm","capitalize"],["styleClass","uppercase !font-bold !text-xs cursor-pointer","pTooltip","Cambiar estado","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0","rounded","",3,"click","value","severity"],[1,"flex","justify-center","items-center","gap-2"],["text","","severity","success","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Editar","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],["data-inline","false",1,"iconify","icon","font-bold","text-xl"],["text","","severity","danger","size","small","rounded","","styleClass","!w-10 !p-2","pTooltip","Eliminar","tooltipPosition","top","tooltipStyleClass","!text-xs !font-normal !p-0",3,"click"],[4,"ngIf","ngIfElse"],[1,"h-12"],[4,"ngFor","ngForOf"],["colspan","100"],[1,"text-center","text-sm","font-extralight"]],template:function(e,i){if(e&1){let r=ae();R(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),ft(4,"i",9),R(5,"h2",10),Q(6),O()(),R(7,"p-button",11)(8,"div",12),ft(9,"i",13),R(10,"span"),Q(11,"Configuraci\xF3n"),O()()()(),R(12,"div",14)(13,"div",15)(14,"p-iconfield"),ft(15,"p-inputicon",16),R(16,"input",17),pt("input",function(s){et(r);let a=Zi(30);return it(i.filterGlobal(a,s.target))}),O()()(),R(17,"div",15)(18,"p-button",18),pt("click",function(){et(r);let s=Zi(30);return it(s.exportCSV())}),R(19,"div",12),ft(20,"i",19),R(21,"span"),Q(22,"Exportar"),O()()(),R(23,"p-button",18),pt("click",function(){return et(r),it(i.addNew())}),R(24,"div",12),ft(25,"i",20),R(26,"span"),Q(27,"Agregar"),O()()()()()(),R(28,"div",21)(29,"p-table",22,0),nt(31,Sx,2,1,"ng-template",null,1,Me)(33,Tx,31,11,"ng-template",null,2,Me)(35,Mx,3,2,"ng-template",null,3,Me),O()()()}e&2&&(A(4),bt("data-icon",i.icon),A(2),$t(i.title),A(),M("routerLink","/ajustes/configuracion"),A(22),M("value",i.dataTable)("scrollable",!0)("globalFilterFields",Ii(8,yx))("columns",i.cols)("exportHeader","customExportHeader"))},dependencies:[Cn,mo,go,_o,Wu,Vu,wo,Co,Ch,Eh,fh,dh,Eo,vn,yo,Ph,Dh,Oh,Lh,mh,ph],encapsulation:2})};export{gm as SedesComponent};
